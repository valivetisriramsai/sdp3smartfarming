<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
  <script src="//cdn.optimizely.com/js/3086230227.js"></script>

  <title>Saga Robotics: Investment rounds, top customers, partners and investors | i3 Connect</title>
  <meta name="description" content="This page provides investment and traction data on Saga Robotics, a Developer of farm robots">
  <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="2GGYk+91/uYIvZfiAjdfYtSUOYrTSqXzIYt/7HLRHyEs7jF+SV0tT4uzm1yFfqQosM8rTFG4OCGZqefXcMlFow==" />
  <meta name="viewport" id="viewport" content="width=320">

  <!--[if lt IE 9]>
  <script src="//ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
  <![endif]-->

  <link rel="stylesheet" media="screen" href="/assets/application-ed0d47f52986e8c8947a10d9e226f1bbb21f9a6c8b9db865fb253018a0e43b36.css" />
  
  <link rel="stylesheet" media="screen" href="/assets/owlcarousel/owl.carousel-4f51efb96383c05caf17cce2933d7b32ebadcbd9d5f622721ad90ab9baecdd80.css" />
  <link rel="stylesheet" media="screen" href="/assets/owlcarousel/owl.transitions-d6234713c8a93b6ab8f7318454c3ea4f28ecea689efcc54ff2826b296bf88ad0.css" />
  <link rel="stylesheet" media="screen" href="/assets/maini3-daf411400743fdfaf622c92af7a796afb8fca926f735cf2f879b97c59536fa7f.css" />
  <link rel="stylesheet" media="screen" href="/assets/edit_company_profile-707000b12869bbba366b22dbfe2c2586fbf9adc3338978817cced29627789ba0.css" />


 <!-- Each page has own stylesheet -->
  
  <script src="/assets/application-70a66ccec3c572a12ae23aee4559901a2f7989ceb5c321451d806ddcf9eeccbb.js"></script>
  
   <script src="/assets/company_includes-ce78f66f30e46e524939a4edc150dc5deb5b143b84486fc5517e327d76244715.js"></script>
   <script src="/assets/jquery.scrollTo.min-3fa0f7df367173018e10b270a3af5b7486dbef406dced3b11312fb8666f8ab7d.js"></script>

<script src="/assets/company_includes-ce78f66f30e46e524939a4edc150dc5deb5b143b84486fc5517e327d76244715.js"></script>


  <!-- Trackers -->
  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-963086-9']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();


</script>
 <!-- Google Analytics -->
  
  

  
  <script type="text/javascript">
  setTimeout(function(){var a=document.createElement("script");
  var b=document.getElementsByTagName("script")[0];
  a.src=document.location.protocol+"//script.crazyegg.com/pages/scripts/0037/7401.js?"+Math.floor(new Date().getTime()/3600000);
  a.async=true;a.type="text/javascript";b.parentNode.insertBefore(a,b)}, 1);
  </script>

</head>

<body class="profile">


<div id="wrapper">
  
<div id="header-wrapper">
    <!-- Not signed in header -->
      <link rel="stylesheet" media="screen" href="/assets/front_page_c-32fbbdfa4e2d3ea4c6dcc1af5cbc64b9f08eaada1faca238450d963eaab1004e.css" />
      <link rel="stylesheet" media="screen" href="/assets/maini3-daf411400743fdfaf622c92af7a796afb8fca926f735cf2f879b97c59536fa7f.css" />
      <!-- Header -->
  <div id="header-wrapper">
    <header id="header" class="section">
      <a href="/" id="logo">i3</a>
      <a href="#mobile-menu" id="mobile-menu-button">Menu</a>
      <div id="header-account-wrapper">
        
<div class="search-sectio">
<form class="search panel-target" id="search-form" action="/solr_search" accept-charset="UTF-8" method="get">
  <div class="header-search-box">
  <input type="text" name="q" id="q" class="search-input typeahead" placeholder="Search (e.g. EV charging, Lilium, Artificial Intelligence)" onfocus="displaySearchResultsFocus()" onkeyup="displaySearchResultsKeyUp()" data-provide="typeahead" autocomplete="off" />
  <input type="submit" name="commit" value="Search" class="search-submit" data-disable-with="Search" />
  </div>
</form></div>


        <div class="sign-up-section">
        <form id="header-account" action="/account/signin" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="rruTVKW4I4+f2414vjQ+1uE5uxJ+dVPJKQ80J71DEjhu8wnw3yIYwUVyZo9gwlZvNZWyEUnRnTowk4H59C+5uQ==" />
          <input type="hidden" name="ref" id="ref" />
          <input type="hidden" name="apply_to" id="apply_to" class="apply_to" />
          <!-- remote_ip: 43.225.22.9 -->
          <div class="form-block">
            <label>Email</label>
            <input class="text-input" tabindex="1" type="email" name="user[email]" id="user_email" />
          </div>

          <div class="form-block">
            <label>Password</label>
            <a class="forgot-pass-link" href="/account/forgot_password">Forgot password?</a>
            <input class="text-input" tabindex="2" type="password" name="user[password]" id="user_password" />
          </div>
          <input type="submit" name="commit" value="Sign In" class="sign-in-link" data-disable-with="Sign In" />
            <a class="sign-up-link" href="/">Sign Up</a>
</form>        </div>

      </div>
    </header>
  </div> <!-- END Header -->

</div>
<script>
  function displaySearchResultsKeyUp() {
    if($("#q").val().length > 0) {
      $('.header-search-results').hide();
    }
    else {
      $('.header-search-results').show();
    }
  }

  function displaySearchResultsFocus() {
    $('.header-search-results').show();
  }

  $(function() {
    $('body').click(function() {
      $('.header-search-results').hide();
    });
  });
</script>


  <!-- CONTENT -->
  <div id="content-wrapper">
    <div id="content" class="section">

      <!-- Flash Messages -->




      






<div id="company-content" class="content-wrapper ng-cloak" ng-app="companiesApp" ng-controller="showCtrl" data-company-id="412020" data-profile-type="company" ng-cloak>

<script type="text/javascript">
$(document).ready(function() {
  $('#toggleMenu').on("click", function(event) {
    event.stopPropagation();
    $("#nav-arrows").html(''); //fix menu autowidth issue (it's nonsense, I know...but it works)

    var e = $(this);
    var elem = $('.admin-nav-options');

    if(elem.is(":visible")) {
      elem.hide();
      $('#nav-arrows').removeClass("icon-down-arrow").addClass("icon-forward-arrow");
    }
    else {
      elem.show();
      $('#nav-arrows').removeClass("icon-forward-arrow").addClass("icon-down-arrow");
    }
  });

  $(document).click(function(event) {
    if(!$(event.target).closest('.admin-nav-options').length) {
      if($('.admin-nav-options').is(":visible")) {
        $('.admin-nav-options').hide();
      }
    }
  });
});

  var companyApp = angular.module('companiesApp', []);

companyApp.config(["$httpProvider", function($httpProvider) {
  $httpProvider.defaults.headers.common['X-CSRF-Token'] = $('meta[name=csrf-token]').attr('content');
}])

  companyApp.filter('nfcurrency', [ '$filter', '$locale', function ($filter, $locale) {
  var currency = $filter('currency'), formats = $locale.NUMBER_FORMATS;
  return function (amount, symbol) {
    var value = currency(amount, symbol)||'';
    return value.replace(new RegExp('\\' + formats.DECIMAL_SEP + '\\d{2}'), '')
  };
}]);

companyApp.filter("to_trusted", ['$sce', function($sce) {
  return function(text) {
    return $sce.trustAsHtml(text);
  };
}]);

companyApp.filter("numShort", function() {
  return function(number) {
    var abs;
    if (number == void(0) || number == 0) return "";

    abs = Math.abs(number);
    if (abs >= Math.pow(10, 12)) {
      number = (number / Math.pow(10, 12)).toFixed(1) + "T";
    } else if (abs < Math.pow(10, 12) && abs >= Math.pow(10, 9)) {
      number = (number / Math.pow(10, 9)).toFixed(1) + "B";
    } else if (abs < Math.pow(10, 9) && abs >= Math.pow(10, 6)) {
      number = (number / Math.pow(10, 6)).toFixed(0) + "M";
    } else if (abs < Math.pow(10, 6) && abs >= Math.pow(10, 3)) {
      number = (number / Math.pow(10, 3)).toFixed(0) + "K";
    }

    return "$" + number;
  };
});

companyApp.directive('recommendCarousel', function() {
  return function(scope, element, attrs) {
    if (scope.$last){
      $("#company-recommendations").owlCarousel({
        items: 4,
        navigation: true,
        pagination: false,
        paginationNumbers: false,
        scrollPerPage: true,
        singleItem: false,
        itemsDesktop: false,
        itemsDesktopSmall: [1024, 2],
        itemsTablet: [768, 2],
        itemsMobile: [479, 2]
      });
    }
  };
});

companyApp.directive('cancelma', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function() {
      $('.ma-copy').remove();
      $('.ma-table tbody tr:not(.edit-row)').show();
    });
  };
});

companyApp.directive('cancelinvestment', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function() {
      $('.investment-copy').remove();
      $('.investments-table tbody tr:not(.edit-row)').show();
    });
  };
});

companyApp.directive('editinvestment', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var row = $(this).closest('tr');
      var id = this.id.split('_')[1];

      if(id) {
        scope.investment = scope.findItem("investments", id);
        scope.investment.investment_date = scope.formatDateProper(scope.investment.investment_date);
      }
      else {
        scope.investment = {};
        row = $('.investments-table tbody tr:first-child');
		$('#inv_rel_sel_0').prop('checked', true);
      }

      $('.investment-copy').remove();
      $('.investments-table tbody tr:not(.edit-row)').show();
      var cloned = $('.investments-table tbody .edit-row').clone().addClass('investment-copy');
      cloned.prop('data-investment-id', id);
      cloned.find('.add_investment_input').prop('id','add_investment_input_copy');
      cloned.show();

      row.after($compile(cloned)(scope));
      row.hide();
      $('.investment-copy .edit-date').datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat:'mm/dd/yy',
        maxDate: new Date,
        onSelect:function (date) {
        }
      });

      scope.$apply(function() {
        angular.element($('.investment-copy .company-img')).replaceWith($compile('<div class="thumb-60 thumb"><img class="company-img" ng-src="{{(investment.ogo_url) || \'/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png\'}}" /></div>')(scope));
        angular.element($('.investment-copy .char-limiter')).replaceWith($compile('<span class="float-right char-limiter" ng-class="{\'error-message\': investment.notes.length > 400}">{{400 - investment.notes.length}}/400 <span style="font-weight:normal;">characters left</span></span>')(scope));
        investmentSelector = $('#add_investment_input_copy').tokenInput("/api/suggest/investor_name_and_id", {
          queryParam: "term",
          preventDuplicates: true,
          searchDelay: 1000,
          onAdd: function(item) {
          		var inv_list = $('.investment-copy .investors_entered');
          		
          		if (inv_list.length) 
          		{
					inv_list.append('<li id="inv_list_item_' + item.id + '"><input type="radio" id="inv_rel_sel_' + item.id + '" value="' + item.id + '" name="inv_rel_sel"' + (item.has_inc_accel_rel ? 'checked' : '') + '>' + item.name + '</li>');
				}
          },
          onDelete: function(item) {
			var inv_list = $('.investment-copy .investors_entered');
			
			if (inv_list.length) {
	          	var inv_list_item = $('#inv_list_item_' + item.id);
	          	var inv_radio_item = $('#inv_rel_sel_' + item.id);

				if (inv_radio_item.prop('checked'))
				{
        	  		$('.investment-copy #inv_rel_sel_0').prop('checked', true);
				}
          	
	          	inv_list_item.remove();
	        }
          },
        });
      });

      investmentSelector.tokenInput("clear");
      if(scope.investment && scope.investment.id) {
        scope.investment.investors.forEach(function(i) {
          var has_inc_accel_rel = (scope.investment.get_related_inc_accel_cid == i.id);
          investmentSelector.tokenInput("add", {id: i.id, name: i.name, has_inc_accel_rel: has_inc_accel_rel});
        });
        
        if (scope.investment.get_related_inc_accel_cid == -1) {
			$('.investment-copy #inv_rel_sel_0').prop('checked', true);	        	  		
	    }
      }
    });
  };
});

companyApp.directive('editma', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var row = $(this).closest('tr');
      var id = this.id.split('_')[1];

      if(id) {
        scope.acquisition = scope.findItem("ma", id);
        scope.acquisition.date_announced = scope.formatDateProper(scope.acquisition.date_announced);
        scope.acquisition.date_closed = scope.formatDateProper(scope.acquisition.date_closed);
      }
      else {
        scope.acquisition = {};
        row = $('.ma-table tbody tr:first-child');
      }

      $('.ma-copy').remove();
      $('.ma-table tbody tr:not(.edit-row)').show();
      var cloned = $('.ma-table tbody .edit-row').clone().addClass('ma-copy');
      cloned.find('.edit-direction').addClass('edit-direction-copy');
      cloned.prop('data-ma-id', id);
      cloned.find('.add_ma_input').prop('id','add_ma_input_copy');
      cloned.show();

      row.after($compile(cloned)(scope));
      row.hide();
      $('.ma-copy .edit-date').datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat:'mm/dd/yy',
        maxDate: new Date,
        onSelect:function (date) {
        }
      });

      scope.$apply(function() {
        angular.element($('.ma-copy .company-img')).replaceWith($compile('<div class="thumb-60 thumb"><img class="company-img" ng-src="{{(acquisition.acquired_logo_url) || \'/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png\'}}" /></div>')(scope));
        angular.element($('.ma-copy .char-limiter')).replaceWith($compile('<span class="float-right char-limiter" ng-class="{\'error-message\': acquisition.notes.length > 400}">{{400 - acquisition.notes.length}}/400 <span style="font-weight:normal;">characters left</span></span>')(scope));
        maSelector = $('#add_ma_input_copy').tokenInput("/api/suggest/company_all_name_and_id", {
          queryParam: "term",
          tokenLimit: 1,
          searchDelay: 1000,
          onAdd: function() {
          //  $("#token-input-add_input_input_clone").closest("ul").css("border-color", "#ddd");
          }
        });
      });

      maSelector.tokenInput("clear");
      if(scope.acquisition && scope.acquisition.acquired && scope.acquisition.acquired.id) {
        maSelector.tokenInput("add", {id: scope.acquisition.acquired.id, name: scope.acquisition.acquired.name});
      }
    });
  };
});

companyApp.directive('cancelmanagement', function($compile) {
  return function(scope, element, attrs) {
    scope.teamSelector.tokenInput("clear");
    element.bind("click", function() {
      $('#management-data').remove();
      $('.management-copy').fadeOut().remove();
      $('.management-wrapper').fadeIn();
      $('#edit-new-team').hide();
      $('#add-team-span, .team-find-edit, .show-add-team-link').show();
    });
  };
});

companyApp.directive('editmanagement', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var id = this.id.split('_')[1];
      var row = null;

      if(id) {
        scope.teammember = scope.findItem("team", id);
        scope.teammember.date_joined = scope.formatDateProper(scope.teammember.date_joined);
        scope.teammember.date_departed = scope.formatDateProper(scope.teammember.date_departed);
        row = $(this).closest('.management-wrapper');
        $('.team-find-edit, #edit-new-team').hide();
      }
      else {
        scope.teammember = {};

        if($('#management-data').length > 0) {
          scope.teammember.person = {
            first_name: $('#management-data').data('first'),
            last_name: $('#management-data').data('last')
          };
        }

        $('#edit-new-team').show();
        $('.team-find-edit').hide();
        row = $('.management-wrapper-new');
      }

      $('.management-copy').remove();
      $('.management-wrapper, .management-wrapper-new').show();
      var cloned = $('.edit-management').clone().addClass('management-copy');
      cloned.prop('data-teammember-id', id);
      cloned.find('.edit-required').prop('required', true);
      cloned.find('.edit-person').val(scope.teammember.person_id);
      cloned.fadeIn();
      row.after(cloned);
      row.hide();
      $compile(cloned)(scope);

      $('.management-copy .edit-date').datepicker({
          changeMonth: true,
          changeYear: true,
          dateFormat:'mm/dd/yy',
          onSelect:function (date) {
          }
        });
    });
  };
});

companyApp.directive('cancelboard', function($compile) {
  return function(scope, element, attrs) {
    scope.boardmemberSelector.tokenInput("clear");
    element.bind("click", function() {
      $('#board-data').remove();
      $('.board-copy').fadeOut().remove();
      $('.board-wrapper').fadeIn();
      $('#edit-new-board').hide();
      $('#add-board-span, .board-find-edit, .show-add-board-link').show();
    });
  };
});

companyApp.directive('editboard', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var id = this.id.split('_')[1];
      var row = null;

      if(id) {
        scope.boardmember = scope.findItem("board_of_directors", id);
        scope.boardmember.start_date = scope.formatDateProper(scope.boardmember.start_date);
        scope.boardmember.end_date = scope.formatDateProper(scope.boardmember.end_date);
        row = $(this).closest('.board-wrapper');
        $('.board-find-edit, #edit-new-board').hide();
      }
      else {
        scope.boardmember = {};

        if($('#board-data').length > 0) {
          scope.boardmember.person = {
            first_name: $('#board-data').data('first'),
            last_name: $('#board-data').data('last')
          };
        }

        $('#edit-new-board').show();
        $('.board-find-edit').hide();
        row = $('.board-wrapper-new');
      }

      $('.board-copy').remove();
      $('.board-wrapper, .board-wrapper-new').show();
      var cloned = $('.edit-board').clone().addClass('board-copy');
      cloned.prop('data-board-id', id);
      cloned.find('.board-edit-required').prop('required', true);
      cloned.find('.edit-person').val(scope.boardmember.person_id);
      cloned.find('.add_investor_input').prop('id','add_investor_input_copy');
      cloned.fadeIn();
      row.after(cloned);
      row.hide();
      $compile(cloned)(scope);

      $('.board-copy .edit-date').datepicker({
          changeMonth: true,
          changeYear: true,
          dateFormat:'mm/dd/yy',
          onSelect:function (date) {
          }
        });

      scope.$apply(function() {
        investorSelector = $('#add_investor_input_copy').tokenInput("/api/suggest/investor_name_and_id", {
          queryParam: "term",
          tokenLimit: 1,
          searchDelay: 1000,
          onAdd: function() {
          //  $("#token-input-add_input_input_clone").closest("ul").css("border-color", "#ddd");
          }
        });
      });

      investorSelector.tokenInput("clear");
      if(scope.boardmember && scope.boardmember.investor) {
        investorSelector.tokenInput("add", {id: scope.boardmember.investor.id, name: scope.boardmember.investor.name});
      }
    });
  };
});



companyApp.directive('cancelcustomer', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function() {
      $('.customer-copy').remove();
      $('.customers-table tbody tr:not(.edit-row)').show();
    });
  };
});

companyApp.directive('editcustomer', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var row = $(this).closest('tr');
      var id = this.id.split('_')[1];

      if(id) {
        scope.customer = scope.findItem("customers", id);
        customer = scope.customer.company1.id == scope.companyId ? scope.customer.company2 : scope.customer.company1;
        scope.customer.relationship_date = scope.formatDateProper(scope.customer.relationship_date);
      }
      else {
        scope.customer = {};
        row = $('.customers-table tbody tr:first-child');
      }

      $('.customer-copy').remove();
      $('.customers-table tbody tr:not(.edit-row)').show();
      var cloned = $('.customers-table tbody .edit-row').clone().addClass('customer-copy');
      cloned.prop('data-customer-id', id);
      cloned.find('.add_customer_input').prop('id','add_customer_input_copy');
      cloned.show();

      row.after($compile(cloned)(scope));
      row.hide();
      $('.customer-copy .edit-date').datepicker({
          changeMonth: true,
          changeYear: true,
          dateFormat:'mm/dd/yy',
          maxDate: new Date,
          onSelect:function (date) {

          }
        });

      scope.$apply(function() {
        angular.element($('.customer-copy .company-img')).replaceWith($compile('<div class="thumb-60 thumb"><img class="company-img" ng-src="{{(customer.company1.id == profile.company.id ? customer.logo_url2 : customer.logo_url1) || \'/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png\'}}" /></div>')(scope));
        angular.element($('.customer-copy .char-limiter')).replaceWith($compile('<span class="float-right char-limiter" ng-class="{\'error-message\': customer.notes.length > 400}">{{400 - customer.notes.length}}/400 <span style="font-weight:normal;">characters left</span></span>')(scope));
        customerSelector = $('#add_customer_input_copy').tokenInput("/api/suggest/company_all_name_and_id", {
          queryParam: "term",
          tokenLimit: 1,
          searchDelay: 1000,
          onAdd: function() {
          //  $("#token-input-add_input_input_clone").closest("ul").css("border-color", "#ddd");
          }
        });
      });

      customerSelector.tokenInput("clear");
      if(customer && customer.id) {
        customerSelector.tokenInput("add", {id: customer.id, name: customer.name});
      }
    });
  };
});

companyApp.directive('cancelrelationship', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function() {
      $('.relationship-copy').remove();
      $('.relationships-table tbody tr:not(.edit-row)').show();
    });
  };
});

companyApp.directive('editrelationship', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var row = $(this).closest('tr');
      var id = this.id.split('_')[1];

      if(id) {
        scope.relationship = scope.findItem("relationships", id);
        relationship = scope.relationship.company1.id == scope.companyId ? scope.relationship.company2 : scope.relationship.company1;
        scope.relationship.relationship_date = scope.formatDateProper(scope.relationship.relationship_date);
      }
      else {
        scope.relationship = {};
        row = $('.relationships-table tbody tr:first-child');
      }

      $('.relationship-copy').remove();
      $('.relationships-table tbody tr:not(.edit-row)').show();
      var cloned = $('.relationships-table tbody .edit-row').clone().addClass('relationship-copy');
      cloned.prop('data-relationship-id', id);
      cloned.find('.edit-relationship-type').prop('required', true);
      cloned.find('.add_relationship_input').prop('id','add_relationship_input_copy');
      cloned.show();

      row.after(cloned);
      row.hide();
      $('.relationship-copy .edit-date').datepicker({
          changeMonth: true,
          changeYear: true,
          dateFormat:'mm/dd/yy',
          maxDate: new Date,
          onSelect:function (date) {

          }
        });
      $compile(cloned)(scope);

      scope.$apply(function() {
        angular.element($('.relationship-copy .company-img')).replaceWith($compile('<div class="thumb-60 thumb"><img class="company-img" ng-src="{{(relationship.company1.id == profile.company.id ? relationship.logo_url2 : relationship.logo_url1) || \'/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png\'}}" /></div>')(scope));
        angular.element($('.relationship-copy .char-limiter')).replaceWith($compile('<span class="float-right char-limiter" ng-class="{\'error-message\': relationship.notes.length > 400}">{{400 - relationship.notes.length}}/400 <span style="font-weight:normal;">characters left</span></span>')(scope));
//         relationshipSelector = $('#add_relationship_input_copy').tokenInput("/api/suggest/company_all_name_and_id", {
          relationshipSelector = $('#add_relationship_input_copy').tokenInput("/api/suggest/partner_name_and_id", {
          queryParam: "term",
          tokenLimit: 1,
          searchDelay: 1000,
          onAdd: function() {
          //  $("#token-input-add_input_input_clone").closest("ul").css("border-color", "#ddd");
          }
        });
      });

      relationshipSelector.tokenInput("clear");
      if(scope.relationship.id) {
        relationshipSelector.tokenInput("add", {id: relationship.id, name: relationship.name});
      }
    });
  };
});


companyApp.directive('cancelproduct', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function() {
      $('.product-copy').remove();
      $('.products-table tbody tr:not(.edit-row)').show();
    });
  };
});

companyApp.directive('editproduct', function($compile) {
  return function(scope, element, attrs) {
    element.bind("click", function(){
      var row = $(this).closest('tr');
      var id = this.id.split('_')[1];

      if(id) {
        scope.product = scope.findItem("products", id);
      }
      else {
        scope.product = {};
        row = $('.products-table tbody tr:first-child');
      }

      $('.product-copy').remove();
      $('.products-table tbody tr:not(.edit-row)').show();
      var cloned = $('.products-table tbody .edit-row').clone().addClass('product-copy');
      cloned.prop('data-product-id', id);
      cloned.find('.edit-name').prop('required', true);
      cloned.find('#product_image_preview').prop('id', 'product_image_preview-copy');

      if(scope.product.product_image_url) {
        cloned.find('.upload-image-icon').hide();
        cloned.find('#product_image_preview-copy').prop('src', scope.product.product_image_url);
      }
      cloned.show();
      row.after(cloned);
      row.hide();
      $compile(cloned)(scope);

      scope.$apply(function() {
        angular.element($('.product-copy .char-limiter')).replaceWith($compile('<span class="float-right char-limiter" ng-class="{\'error-message\': product.description.length > 400}">{{400 - product.description.length}}/400 <span style="font-weight:normal;">characters left</span></span>')(scope));
      });
    });
  };
});

companyApp.directive('pdfElem', function() {
  return {
    restrict: 'A',
    link: function($scope, element, attrs) {
      $scope.updatePdf = function() {
        var url = $scope.selectedPdf && $scope.selectedPdf.pdf_file.url;
        var elem = element;
        var pdfObj = $('#pdf-object');
        var pdfTimestamp = $scope.selectedPdf.updated_at;

        if(pdfObj.length > 0 ) {
          pdfObj.attr('data', url);
          $('#pdf-link').attr('href', url);
          pdfTimestamp.attr('data', updated_at);
        }
        else if(url) {
          elem.replaceWith('<object ng-disabled="!selectedPdf" ng-show="selectedPdf" data="' + url + '" class="cp-deck" id="pdf-object">Unable to display : <a href="' + url + '" id="pdf-link">Download</a></object>');
        }
      }

      $scope.updatePdf();
    }
  };
});

companyApp.directive('httpPrefix', function() {
  return {
    restrict: 'A',
    require: 'ngModel',
    link: function(scope, element, attrs, controller) {
      function ensureHttpPrefix(value) {
        // Need to add prefix if we don't have http:// prefix already AND we don't have part of it
        if(value && !/^(https?):\/\//i.test(value) && 'http://'.indexOf(value) === -1) {
          controller.$setViewValue('http://' + value);
          controller.$render();
          return 'http://' + value;
        }
        else {
            return value;
        }
      }
      controller.$formatters.push(ensureHttpPrefix);
      controller.$parsers.push(ensureHttpPrefix);
    }
  };
});

companyApp.directive('datepicker', function() {
  return {
    restrict: 'A',
    require : 'ngModel',
    link : function (scope, element, attrs, ngModelCtrl) {
      $(function(){
        element.datepicker({
          changeMonth: true,
          changeYear: true,
          dateFormat:'mm/dd/yy',
          onSelect:function (date) {
            scope.$apply(function () {
              ngModelCtrl.$setViewValue(date);
            });
          }
        });
      });
    }
  }
});

companyApp.directive('fancySelect', function() {
  return {
    restrict: 'A',
    scope: false,
    link: function($scope, element, attrs) {
      var $targetSelect = $(element);
      $targetSelect.selectBox().change(function () {
        var selected = $(this).val();

        $scope.$apply(function() {
          $scope.selectedPdfTypeId = selected;
          $scope.selectedPdf = $scope.profile.company_deck[$scope.selectedPdfTypeId - 1];
          $scope.updatePdf();
        });
      });

      if($scope.selectedPdf != null) {
        $('.products-tech-header a.selectBox').show();
      }
      else {
        $('.products-tech-header a.selectBox').hide();
      }

      $targetSelect.selectBox('refresh');
    }
  };
});


//define services for company
companyApp.factory("companyService", function($http) {
  return {
    addPatents: function(params) {
      return $http({
        url: "/api/company/add_patents",
        method : "POST",
        data: params
      });
    },

    claimOpenProfile: function(params) {
      return $http({
        url: "/api/company/claim_open_profile",
        method: "POST",
        data: params
      });
    },

    seeAll: function(companyId, type) {
      query = "/" + companyId + "?type=" + type;
      return $http({
        url: "/api/company/see_all" + query,
        method : "GET"
      });
    },

    editOptions: function() {
      return $http({
        url: "/api/company/edit_options",
        method : "GET"
      });
    },

    updatePatents: function(params) {
      return $http({
        url: "/api/company/update_patents",
        method : "PUT",
        data: params
      });
    },

    toggleVisible: function(params) {
      return $http({
        url: "/api/company/toggle_visible",
        method : "POST",
        data: params
      });
    },

    updateAlternateNames: function(params) {
      return $http({
        url: "/api/company/alternate_names",
        method : "POST",
        data: params
      });
    },

    addInvestor: function(params) {
      return $http({
        url: "/investors?source=investments",
        method : "POST",
        data: params
      });
    },

    addCompany: function(params) {
      return $http({
        url: "/companies.json?source=relationships",
        method : "POST",
        data: params
      });
    },

    requestUpdate: function(params, companyId) {
      return $http({
        url: "/api/company/request_update/" + companyId,
        method : "POST",
        data: params
      });
    }, 

    sendFeedback: function(params) {
      return $http({
        url: "/api/company/send_feedback",
        method : "POST",
        data: params
      });
    },
    
    sendUpdateDescription: function(params) {
      return $http({
        url: "/api/company/send_update_description",
        method : "POST",
        data: params
      });
    },

    createUserList: function(params) {
      return $http({
        url: "/user_lists/create.json",
        method : "POST",
        data: params
      });
    },

    updateUserLists: function(params) {
      return $http({
        url: "/user_lists/add_companies_to_lists.json?" + params,
        method : "GET"
      });
    },

    contactProfile: function(params, companyId) {
      return $http({
        url: "/api/company/" + companyId + "/contact_po",
        method : "POST",
        data: params
      });
    },

    shareProfile: function(params, companyId) {
      return $http({
        url: "/api/company/" + companyId + "/share_profile",
        method : "POST",
        data: params
      });
    },

    inviteColleague: function(params, companyId) {
      return $http({
        url: "/api/company/" + companyId + "/invite_colleague",
        method : "POST",
        data: params
      });
    },

    getCompanyProfile: function(companyId) {
      return $http.get("/api/company/profile/" + companyId);
    },

    patents: function(companyId, sort, dir, type) {
      var append = "?sort_by=" + sort + "&direction=" + dir + "&type=" + type;
      return $http.get("/api/search/patents/" + companyId + append);
    },

    updateCompanyProfile: function(params, id) {
      return $http({
        url: "/api/company/update.json",
        method: "POST",
        data: params
      });
    },

    follow: function(entity_id) {
      return $http({
        url: "/account/follow",
        method: "POST",
        data: { entity_id : entity_id }
      });
    },

    unfollow: function(entity_id) {
      return $http({
        url: "/account/unfollow",
        method: "POST",
        data: { entity_id : entity_id }
      });
    },

    uploadCompanyDeck: function(companyId, deckId, typeId, files) {
      var fd = new FormData();

      angular.forEach(files, function(file) {
        fd.append('file', file);
      });

      fd.append('user_submitted_type_id', typeId);
      fd.append('deck_id', deckId);

      return $http.post("/api/company/" + companyId + "/upload_deck_pdf",
        fd,
        {
          transformRequest: angular.identity,
          headers: {'Content-Type':undefined}
        }
      );
    },

    updateOverview: function(companyId, params, files, parentCompanyIds) {
      var fd = new FormData();

      angular.forEach(files, function(file) {
        fd.append('company[company_logo]', file);
      });

      fd.append('type', $('#company-content').attr('data-profile-type'));
      fd.append('company[short_description]', params.short_description || "");
      fd.append('company[year_founded]', params.year_founded|| "");
      fd.append('company[development_stage_id]', params.development_stage_id || "");
      fd.append('company[investor_type_id]', params.investor_type_id || "");
      fd.append('company[industry_type_id]', params.industry_type_id || "");
      fd.append('company[company_status_id]', params.company_status_id || "");
      fd.append('company[industry_group_id]', params.industry_group_id || "");
      fd.append('company[primary_tag_id]', params.primary_tag_id || "");
      fd.append('company[address]', params.address || "");
      fd.append('company[city]', params.city || "");
      fd.append('company[state]', params.state || "");
      fd.append('company[zip]', params.zip || "");
      fd.append('company[country_id]', params.country_id || "");
      fd.append('company[website]', params.website || "");
      fd.append('company[ticker_symbol]', params.ticker_symbol || "");
      fd.append('parent_company_ids', parentCompanyIds || []);

      return $http.post("/api/company/" + companyId + "/overview",
        fd,
        {
          transformRequest: angular.identity,
          headers: {'Content-Type':undefined}
        }
      );
    },
 
    updateProduct: function(companyId, params, files) {
      var fd = new FormData();
      var type = "add";

      fd.append('remove', params['remove']);
      fd.append('product_id', params.product_id || "");

      if(params['add'] || params['update']) {
        type = (params.product_id || "") == "" ? "add" : "update";

        angular.forEach(files, function(file) {
          fd.append(type + '[product][product_image]', file);
        });

        fd.append('type', $('#company-content').attr('data-profile-type'));
        fd.append(type + '[product][name]',                   params[type].product.name                    || "");
        fd.append(type + '[product][description]',            params[type].product.description             || "");
        fd.append(type + '[product][product_status_id]',      params[type].product.product_status_id       || "");
        fd.append(type + '[product][revenue_id]',             params[type].product.revenue_id              || "");
        fd.append(type + '[product][company_id]',             params[type].product.company_id              || "");
        fd.append(type + '[product][usd_per_kw_current]',     params[type].product.usd_per_kw_current      || "");
        fd.append(type + '[product][usd_per_kwh_current]',    params[type].product.usd_per_kwh_current     || "");
        fd.append(type + '[product][usd_per_kw_prospected]',  params[type].product.usd_per_kw_prospected   || "");
        fd.append(type + '[product][usd_per_kwh_prospected]', params[type].product.usd_per_kwh_prospected  || "");
      }

      return $http.post("/api/company/" + companyId + "/product",
        fd,
        {
          transformRequest: angular.identity,
          headers: {'Content-Type':undefined}
        }
      );
    },

    deleteCompanyDeck: function(deckId) {
      return $http({
        url: "/api/company/" + deckId + "/deck_pdf",
        method: "DELETE"
      });
    }
  };
});

//Update company
companyApp.controller("showCtrl", ["$scope","$location","$http","$anchorScroll","companyService","$window","$sce","companyProfileInitData",function($scope, $location, $http, $anchorScroll, companyService, $window, $sce,companyProfileInitData) {
  $scope.profile = companyProfileInitData;
  $scope.companyRecommendations = angular.copy($scope.profile.recommendations);
  $scope.URL_REGEXP = /^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/;
  $scope.isEditingMode = false;
  $scope.patentType = 'uspto';
  $scope.showAll = {};
  $scope.showPencil = {};
  $scope.showLoading = {
    'investments_made_more' : false
  };
  $scope.isEditing = {};
  $scope.showSave = {};
  $scope.primary_tag_id = 0;
  $scope.allPatentsVisible = true;
  $scope.teammember = {};
  $scope.editOptions = {};
  $scope.boardmember = {};
  $scope.showUpdateEditor = {};
  $scope.notePreDelete = false;
  $scope.globalEdit = false;
  $scope.globalLoading = true;
//  $scope.teammemberSelected = false;
//  $scope.boardmemberSelected = false;
  $scope.product = {};
  $scope.boardmember = {};
  $scope.ipoHistory = $scope.profile.ipo_history;
  $scope.acquisition = {};
  $scope.htmlBindings = {
    trustedAcquiredCompanyHtml : "",
    parentCompaniesHtml : "",
    childCompaniesHtml : "",
    subsidiaryCompaniesHtml : ""
  };
  $scope.product_image = null;
  $scope.selectedPdf = null;
  $scope.selectedPdfTypeId = 1;
  $scope.showFollowingLoading = false;
  $scope.following_text = "Follow";
  $scope.userName = $('#user_name').val();
  $scope.companyName = $('#company_name').val();
  $scope.isModalSaving = {
    shareProfile: false,
    contactProfile: false,
    requestUpdate: false,
    sendFeedback: false,
    addPipeline: false,
    addCompany: false,
    addInvestor: false,
    inviteColleague: false,
    alternateName: false,
    addPatents: false
  };
  $scope.showLoader = {
    toggleVisible: false
  };
  $scope.isShowing = {
    shareProfile : false,
    contactProfile : false,
    requestUpdate : false,
    sendFeedback: false,
    addPipeline : false,
    addCompany: false,
    addInvestor: false
  };
  $scope.messages = {
    shareProfile : "",
    contactProfile : "",
    requestUpdate : "",
    sendFeedback: "",
    normalEdit : "",
    corporateEdit : "",
    basicEdit : "",
    addPipelineButton : "Create a new list",
    addPipeline : "",
    addCompany : "",
    addInvestor: "",
    hideOrPublish: "Hide",
    inviteColleague: ""
  };
  $scope.addInvestorFrom = "";
  $scope.addCompanyFrom = "";
  $scope.contactProfileList = null;
  $scope.contactProfileBody = $('#contact-profile-body').val();
  $scope.orderByField = {
    'investor_portfolios_document' : 'first_investment_at',
    'investments_made' : 'investment_date',
    'program_participant_list': 'date'
//    'program_cohort_info': 'created_at'
  };
  $scope.reverseSort = {
    'investor_portfolios_document' : true,
    'investments_made' : true,
    'program_participant_list': true
//     'program_cohort_info': true
  };
  $scope.loading = {};
  $scope.patentOrderByField = "filed_on";
  $scope.patentReverseSort = true;
  maSelector = null;
  customerSelector = null;
  relationshipSelector = null;

  $scope.teamSelector = $('#add_teams_input').tokenInput(getTeamSearchUrl, {
    queryParam: "term",
    tokenLimit: 1,
    searchDelay: 1000,
    onAdd: function(e) {
      $('.show-add-team-link').hide();
      $('#add-team-span').append("<div id='management-data' style='display:none;' data-first='"+e.first_name+"' data-last='"+e.last_name+"'></div>");
      $('#add-team-span').trigger('click');
      $scope.$apply(function() {
      //  $scope.showUpdateEditor['teammember'] = true;
      });
    },
    onDelete: function() {
      $('.show-add-team-link').show();
      $scope.$apply(function () {
      });
    }
  });

  $scope.boardmemberSelector = $('#add_boardmembers_input').tokenInput(getBoardmemberSearchUrl, {
    queryParam: "term",
    tokenLimit: 1,
    searchDelay: 1000,
    onAdd: function(e) {
      $('.show-add-boardmember-link').hide();
      $('#add-board-span').append("<div id='board-data' style='display:none;' data-first='"+e.first_name+"' data-last='"+e.last_name+"'></div>");
      $('#add-board-span').trigger('click');
      $scope.$apply(function() {
      //  $scope.showUpdateEditor['boardmember'] = true;
      });
    },
    onDelete: function() {
      $('.show-add-boardmember-link').show();
      $scope.$apply(function () {
      //  $scope.showUpdateEditor['boardmember'] = false;
      });
    }
  });
  
  
  

  $scope.teammemberSocialClick = function(event) {
    var target = $(event.target);

    if(target.hasClass('social')) {
      event.stopPropagation();
      event.preventDefault();

      var parent = target.parent();

      if(parent.hasClass('link_linkedin')) {
        $window.open(parent.attr('ng-href'));
      }
      else if(parent.hasClass('link_email')) {
        $scope.contactProfileList = [$scope.profile.primary_contact];
        $('#contact-profile-body').val($scope.contactProfileBody);
        $('#contact_profile_owner_modal').css("left", "50%");
        $('#contact_profile_owner_modal').css("top", $(window).scrollTop() + 75);
      }
    }
  };

  $scope.teammemberFullSocialClick = function(event) {
    var target = $(event.target);

    if(target.hasClass('social')) {
      event.stopPropagation();
      event.preventDefault();

      var parent = target.parent();

      if(parent.hasClass('link_linkedin')) {
        $window.open(parent.attr('ng-href'));
      }
      else if(parent.hasClass('link_email')) {
        $scope.contactProfileList = [{
          id: parent.attr("data-user-id"),
          first_name: parent.attr("data-first-name"),
          last_name: parent.attr("data-last-name")
        }];
        var full_name = parent.attr("data-first-name") + " " + parent.attr("data-last-name");
        $('#contact-profile-body').val($scope.profile.po_contact_bodies[full_name]);
       // $scope.overlay['contactProfile'].toggle("open");
        openPopup("#contact_profile_owner_modal");
        centerModal("contact_profile_owner_modal");
        $('#contact_profile_owner_modal').css("left", "50%");
        $('#contact_profile_owner_modal').css("top", $(window).scrollTop() + 75);
        //$(".contact-profile-button").trigger("click");
      }
    }
  };

  $scope.seeAll = function(type) 
  {
  	var itemLength = $scope.profile[type].length;
    if (type == "news") {
  	 var slideUpElem = $('.' + type + '-table tbody tr:not(.edit-row):nth-child(5)');
    } 
    else {
     var slideUpElem = $('.' + type + '-table tbody tr:not(.edit-row):nth-child(6)'); 
    }
    
  	var slideDownElem = $('.' + type + '-table tbody tr:not(.edit-row)');
  	
  	
  	
    if(itemLength > 5) {
      if($scope.showAll[type]) {
        //everything currently shown...now hide
        slideUpElem.nextAll().slideUp();
      }
      else {
        slideDownElem.nextAll().slideDown();
      }

      $scope.showAll[type] = !$scope.showAll[type];
    }
    else {
      $scope.loading[type] = true;
      companyService.seeAll($scope.companyId, type).
        success(function(data, status) {
          $scope.profile[type] = data;
          $scope.showAll[type] = true;
          $scope.loading[type] = false;
        }).
        error(function(data, status) {
          $scope.loading[type] = false;
        });
    }
  };

  $scope.togglePatents = function(type) {
    var checked = $("#all-" + type).is(':checked');
    angular.forEach($scope.profile.patent_data[type.replace('-','_')+"_patents"], function(item) {
      item.is_visible = checked;
    });
  };

  $scope.addPatents = function(isValid) {
    $scope.submitted = true;

    if(isValid) {
      var params = {
        company_id: $scope.companyId,
        patent_num: $scope.patent.patent_num,
        published_app_num: $scope.patent.published_app_num,
        application_num: $scope.patent.application_num,
        type: $scope.patentType
      };

      $scope.isModalSaving['addPatents'] = true;
      companyService.addPatents(params)
        .success(function(data, status) {
          $('.close').trigger("click");
          $scope.isModalSaving['addPatents'] = false;
          $scope.submitted = false;
          $('#patent-submitted').css("top", $(window).scrollTop() + 75);
          openPopup("#patent-submitted");
        }).
        error(function(data, status) {
          $scope.isModalSaving['addPatents'] = false;
        });
    }
  };

  $scope.contactMeFor = function(event) {
    var target = $(event.target);
    event.stopPropagation();
    event.preventDefault();

    $scope.contactProfileList = [{
      id: target.attr("data-user-id"),
      first_name: target.attr("data-first-name"),
      last_name: target.attr("data-last-name")
    }];
    $('#contact-profile-body').val($scope.contactProfileBody);
    openPopup("#contact_profile_owner_modal");
    centerModal("contact_profile_owner_modal");
    $('#contact_profile_owner_modal').css("left", "50%");
    $('#contact_profile_owner_modal').css("top", $(window).scrollTop() + 75);
  };

  $scope.investorAdd = function(isValid) {
    $scope.addInvestorSubmitted = true;

    if(isValid && !$scope.isShowing['addInvestor']) {
      var params = {
        company: {
          name: $scope.addInvestor.name,
          country_id: $scope.addInvestor.country_id,
          investor_type_id: $scope.addInvestor.investor_type_id
        }
      };

      $scope.messages['addInvestor'] = "";
      $scope.isShowing['addInvestor'] = true;
      $scope.isModalSaving['addInvestor'] = true;

      companyService.addInvestor(params)
        .success(function(data, status) {
          $scope.addInvestorSubmitted = false;
          $scope.addInvestor.name = "";
          $scope.addInvestor.country_id = 15026;
          $scope.addInvestor.investment_type_id = null;

          if($scope.addInvestorFrom == "team") {
            investorSelector.tokenInput("add", {id:data.id, name:data.name});
          }
          else {
            investmentSelector.tokenInput("add", {id:data.id, name:data.name});
          }

          $('.close').trigger("click");
          $scope.isShowing['addInvestor'] = false;
          $scope.isModalSaving['addInvestor'] = false;
        })
        .error(function(data, status) {
          $scope.messages['addInvestor'] = data;
          $scope.isShowing['addInvestor'] = false;
          $scope.isModalSaving['addInvestor'] = false;
        });
    }
  };

  $scope.toggleVisible = function() {
    if(!$scope.showLoader['toggleVisible']) {
      $scope.showLoader['toggleVisible'] = true;

      var params = {
        id : $scope.companyId
      };

      companyService.toggleVisible(params)
        .success(function(data, status) {
          $scope.profile = data;
          $scope.messages['hideOrPublish'] = $scope.profile.company.hidden ? "Publish" : "Hide";
          $scope.showLoader['toggleVisible'] = false;
        })
        .error(function(data, status) {
          $scope.showLoader['toggleVisible'] = false;
        });
    }
  };

  $scope.switchPatent = function(type) {
    $scope.patentType = type;

    if(type == "uspto") {
      $('#uspto-btn').addClass("selected");
      $('#espacenet-btn, #uspto-published-btn').removeClass("selected");
    }
    else if(type == "uspto-published") {
      $('#uspto-published-btn').addClass("selected");
      $('#espacenet-btn, #uspto-btn').removeClass("selected");
    }
    else if(type == "espacenet") {
      $('#uspto-btn, #uspto-published-btn').removeClass("selected");
      $('#espacenet-btn').addClass("selected");
    }
  };

  $scope.companyAdd = function(isValid) {
    $scope.addCompanySubmitted = true;

    if(isValid && !$scope.isShowing['addCompany']) {
      var params = {
        company: {
          name: $scope.addCompany.name,
          country_id: $scope.addCompany.country_id
        }
      };

      $scope.messages['addCompany'] = "";
      $scope.isShowing['addCompany'] = true;
      $scope.isModalSaving['addCompany'] = true;

      companyService.addCompany(params)
        .success(function(data, status) {
          $scope.addCompanySubmitted = false;
          $scope.addCompany.name = "";
          $scope.addCompany.country_id = 15026;

          if($scope.addCompanyFrom == "relationship") {
            relationshipSelector.tokenInput("clear");
            relationshipSelector.tokenInput("add", {id:data.id, name:data.name});
          }
          else if($scope.addCompanyFrom == "ma") {
            maSelector.tokenInput("add", {id:data.id, name:data.name});
          }
          else if($scope.addCompanyFrom == "customer") {
            customerSelector.tokenInput("add", {id:data.id, name:data.name});
          }
          else if($scope.addCompanyFrom == "investments-made") {
            relationshipSelector.tokenInput("add", {id:data.id, name:data.name});
          }

          $('.close').trigger("click");
          $scope.isShowing['addCompany'] = false;
          $scope.isModalSaving['addCompany'] = false;
        })
        .error(function(data, status) {
          $scope.messages['addCompany'] = data;
          $scope.isShowing['addCompany'] = false;
          $scope.isModalSaving['addCompany'] = false;
        });
    }
  };

  $scope.parentSelector = $('#add_parent_input').tokenInput(getParentSearchUrl, {
    queryParam: "term",
    searchDelay: 1000,
    tokenLimit: 1
  });

  // $scope.secondaryTagSelector = $('#add_secondary_tag_input').tokenInput(getSecondaryTagSearchUrl, {
  //   queryParam: "term",
  //   searchDelay: 1000
  // });

  $scope.geographySelector = $('#add_geography_input').tokenInput($scope.profile.edit_options.regions, {
    queryParam: "term",
    minChars: 0,
    preventDuplicates: true
  });

  $scope.stageSelector = $('#add_stage_input').tokenInput($scope.profile.edit_options.stages, {
    queryParam: "term",
    minChars: 0,
    searchDelay: 500,
    preventDuplicates: true
  });

  $scope.corporateTagsSelector = $('#add_corporate_tags_input').tokenInput(getCorporateTagsSearchUrl, {
    queryParam: "term",
    minChars: 0,
    searchDelay: 300,
    preventDuplicates: true
  });

  $scope.dealTypeSelector = $('#add_deal_types_input').tokenInput($scope.profile.edit_options.deal_types, {
    queryParam: "term",
    minChars: 0,
    searchDelay: 500,
    preventDuplicates: true
  });

  $scope.revenueRangeSelector = $('#add_revenue_range_input').tokenInput($scope.profile.edit_options.revenue_ranges, {
    queryParam: "term",
    minChars: 0,
    searchDelay: 500,
    preventDuplicates: true
  });
    
  $scope.numEmployeeRangeSelector = $('#add_num_employee_range_input').tokenInput($scope.profile.edit_options.num_employee_ranges, {
    queryParam: "term",
    minChars: 0,
    searchDelay: 500,
    preventDuplicates: true
  });

  $scope.togglePortfolioRounds = function(type) {
    if(type == 'portfolio') {
      $scope.showRounds = false;
      $("#portfolio-tab-link").removeClass("deselected-tab-link").addClass("selected-tab-link");
      $("#rounds-tab-link").removeClass("selected-tab-link").addClass("deselected-tab-link");
    }
    else {
      $scope.showRounds = true;
      $("#rounds-tab-link").removeClass("deselected-tab-link").addClass("selected-tab-link");
      $("#portfolio-tab-link").removeClass("selected-tab-link").addClass("deselected-tab-link");
    }
  };

  $scope.togglePatentAbstract = function(event) {
    var target = $(event.target);
    event.preventDefault();
    event.stopPropagation();
    target.next('div').css('display') == "none" ? target.siblings('div').slideDown() : target.siblings('div').slideUp();
  };

  $scope.hidePatents = function(type) {
    $('#' + type + '-table .patent-table tbody input:not(:checked)').each(function() { $(this).closest('tr').hide(); });
    $('#' + type + '-table .patent-table tbody tr:visible').each(function(i) {
      if(i > 5) {
        $(this).hide();
      }
    });

    $scope.showAll[type.replace('-','_') + '_patents'] = false;
  };

  $scope.showAllPatents = function(type) {
    var type_replaced = type.replace('-','_') + '_patents';
    if( (type == "uspto" && $scope.profile.patent_data.uspto_patents.length > 5) ||
        (type == "uspto-published" && $scope.profile.patent_data.uspto_published_patents.length > 5) ||
        (type == "espacenet" && $scope.profile.patent_data.espacenet_patents.length > 5) ){
      $('#' + type + '-table .patent-table tbody tr').nextAll().slideDown();
      $scope.showAll[type_replaced] = true;
    }
    else {
      $scope.loading[type] = true;
      companyService.patents($scope.companyId, $scope.patentOrderByField, $scope.patentReverseSort, type)
        .success(function(data, status) {
          type_replaced = data.type.replace('-','_') + "_patents";
          $scope.profile.patent_data[type_replaced] = data.data;
          $scope.showAll[type_replaced] = true;
          $scope.loading[data.type] = false;
        })
        .error(function(data, status) {
        });
    }
  };

  $scope.toggleUpdateEditor = function(tile) {
    $scope.showUpdateEditor[tile] = !$scope.showUpdateEditor[tile];

    switch(tile) {
      case "note":
        $scope.note = {
          note_date : $.datepicker.formatDate('m/dd/yy', new Date())
        };

        break;
    }

    $('.token-input-dropdown').hide();
  };
  
  
  $scope.toggleNoteDelete = function()
  {
  	$scope.notePreDelete = false;
  	$scope.noteDeleteId = null;
  };


  $scope.getNote = function (noteId)
  {
  	if ($scope.notePreDelete || $scope.showLoading['note'] || $scope.showUpdateEditor['note'])
  	{
  		return;
  	}
  	
  	$scope.noteDisplayId = noteId;
    $scope.noteDisplayStr =  'Displaying note ID => ' + noteId;
  };


  $scope.toggleNoteUpdateEditor = function(tile, structureId) {
    $scope.showUpdateEditor[tile] = !$scope.showUpdateEditor[tile];

	$scope.note = {
		note_date : $.datepicker.formatDate('m/dd/yy', new Date()),
		user_note_structure_id: structureId
	};
	
    if (structureId == 1)
    {
    	$scope.note.qa_info = $scope.profile.notes_unstruct_q;
    }
      else if (structureId == 2)
    {
    	$scope.note.qa_info = $scope.profile.notes_struct_q;
    }
    else if (structureId == 3)
    {
    	$scope.note.qa_info = $scope.profile.notes_struct_qcomp;
    }
    else if (structureId == 4)
    {
    	$scope.note.qa_info = $scope.profile.notes_struct_qinv;
    }
    else if (structureId == 5)
    {
    	$scope.note.qa_info = $scope.profile.notes_struct_qcorp;
    }
    else if (structureId == 6)
    {
    	$scope.note.qa_info = $scope.profile.notes_struct_qeso;
    }

    $('.token-input-dropdown').hide();
  	$scope.noteDisplayId = null;
  };


  $scope.trustedPdfSrc = function(url) {
    return $sce.trustAsResourceUrl(url);
  };

  //formats date from YYYY-MM-DD to MM/DD/YYYY
  function formatDateProper(format_date) {
    if(format_date) {
      var a = format_date.split("-");
      return (a[1] + "/" + a[2] + "/" + a[0]);
    }

    return format_date;
  };

  $scope.formatDateProper = function(format_date) {
    return formatDateProper(format_date);
  };

  $scope.sendFeedbackPatent = function() {
    var params = {
      subj: "Feedback - patents",
      feedback: $('#feedback_comment').val()
    }

    $scope.isModalSaving['sendFeedback'] = true;

    companyService.sendFeedback(params)
      .success(function(data, status) {
        $scope.isModalSaving['sendFeedback'] = false;
        $('.close').trigger("click");
      })
      .error(function(data, status) {
        $scope.isModalSaving['sendFeedback'] = false;
      });
  };
  
  $scope.sendUpdateDescription = function() {
    var params = {
      subj: "Update Company Description",
      feedback: $('#update_description_comment').val()
    }

    $scope.isModalSaving['sendUpdateDescription'] = true;

    companyService.sendUpdateDescription(params)
      .success(function(data, status) {
        $scope.isModalSaving['sendUpdateDescription'] = false;
        $('.close').trigger("click");
      })
      .error(function(data, status) {
        $scope.isModalSaving['sendUpdateDescription'] = false;
      });
  };

  $scope.tagsEdit = function(event) {
    $scope.primary_tag_id = $scope.profile.company.primary_tag_id;
    $scope.industry_group_id = $scope.profile.company.industry_group_id;

    // $scope.secondaryTagSelector.tokenInput("clear");
    //
    // for(var i = 0; $scope.profile.edit_company_tags && (i < $scope.profile.edit_company_tags.length); i++) {
    //   $scope.secondaryTagSelector.tokenInput("add", {id: $scope.profile.edit_company_tags[i].id, name: $scope.profile.edit_company_tags[i].name});
    // }
  };

  $scope.tagPresent = function(tag) {
    tag = tag.toLowerCase();
    if ($scope.profile.company.primary_tag != null && $scope.profile.company.primary_tag.toLowerCase() == tag) {
      return true;
    }

    var tag_list = $scope.profile.edit_company_tags
    var arrayLength = tag_list.length;
    for (var i = 0; i < arrayLength; i++) {
      if (tag_list[i].name.toLowerCase() == tag) {
        return true;
      }
    }
    return false;
  };


  $scope.alternateName = function() {
    var params = {
      company_id: $scope.companyId,
      alternate_names: $scope.profile.alternate_names
    };

    $scope.isModalSaving['alternateName'] = true;

    companyService.updateAlternateNames(params)
      .success(function(data, status) {
        $scope.isModalSaving['alternateName'] = false;
        $('.close').trigger("click");
      })
      .error(function(data, status) {
        $scope.isModalSaving['alternateName'] = false;
        alert(data.errorMsg);
      });
  };

  $scope.claimOpenProfile = function(isValid) {
    $scope.submitted = true;

    if(isValid) {
      var params = {
        first_name: $scope.openProfileUser.first_name,
        last_name: $scope.openProfileUser.last_name,
        title: $scope.openProfileUser.title,
        company: $scope.openProfileUser.company,
        email: $scope.openProfileUser.email,
        company_id: $scope.companyId
      };

      companyService.claimOpenProfile(params).
        success(function(data, status) {
          $scope.messages.openProfileUser = data.status_message;
        }).
        error(function(data, status) {
          $scope.messages.openProfileUser = data.status_message;
        });
    }
  };

  $scope.investmentMadeEdit = function(event) {
    var target = event.target.className;

    if(target == "edit-icon" || target == "delete-icon" || target == "delete-icon-comp-rel") {
      event.preventDefault();
      event.stopPropagation();

      var elem = $(event.target).closest(".investment-item");
      var investmentId = elem.attr("data-investment-id");

      if(target == 'edit-icon') {
        relationshipSelector.tokenInput("clear");
        $scope.investment = findItem("investments_made", investmentId);
        $scope.investment.investment_date = formatDateProper($scope.investment.investment_date);
        $scope.showUpdateEditor['investments-made'] = true;

        relationshipSelector.tokenInput("add", {id: $scope.investment.company_id, name: $scope.investment.company.name});
      }
      else if (target == "delete-icon") {
        $scope.investment = {};
        $scope.showUpdateEditor['investments-made'] = false;
        elem.addClass('deleted-investment');
        elem.hide();
      }
      else if (target == "delete-icon-comp-rel") {
        $scope.investment = {};
        $scope.showUpdateEditor['investments-made'] = false;
        elem.addClass('deleted-comp-rel');
        elem.hide();
      }
    }
  };
  

  $scope.noteEdit = function(event) {
    var target = event.target.className;

    if(target == "edit-icon" || target == "delete-icon") {
      event.preventDefault();
      event.stopPropagation();
      var elem = $(event.target).closest(".note-item-details");
      var noteId = elem.attr("data-note-id");
      var notes = null;

      if (target == "edit-icon") {
        $scope.note = findItem("notes", noteId);
        $scope.note.note_date = formatDateProper($scope.note.note_date);
        $scope.showUpdateEditor['note'] = true;
      }
      else if (target == 'delete-icon') {
      	$scope.notePreDelete = true;
      	$scope.noteDeleteId = noteId;
      }
      else {
        $scope.note = {};
        $scope.showUpdateEditor['note'] = false;
        elem.hide();
      }
    }
  };
  
  

  function findItem(typeName, itemId) {
    for(var i = 0; i < $scope.profile[typeName].length; i++) {
      if($scope.profile[typeName][i].id == itemId) {
        return angular.copy($scope.profile[typeName][i]);
      }
    }
  };

  $scope.competitorSelector = $('#edited_competitors_input').tokenInput(getCompanySearchUrl, {
    queryParam: "term",
    searchDelay: 1000
  });
  
  $scope.compareSelector = $('#compare_company_input1, #compare_company_input2, #compare_company_input3').tokenInput(getCompareSearchUrl, {
    queryParam: "term",
    tokenLimit: 1,
    searchDelay: 1000,
    onAdd: function(e) {
        if($(this).is('#compare_company_input1')){
          z = 1
        } else if ($(this).is('#compare_company_input2')) {
          z = 2
        } else if ($(this).is('#compare_company_input3')) {
          z = 3
        }
      $('#getco'+z+'Logo').append('<div class="compare-thumb"><img id="co'+z+'-logo" class="company-img" src="'+e.logo_image_url+'" /></div>');  
      $('#getco'+z+'Name').append('<span  id="co'+z+'-name"  data-name='+e.name+'></span> ');
      $('#getco'+z+'Desc').append('<span  id="co'+z+'-desc" data-name='+e.short_description+'></span> ');
      $('#getco'+z+'Status').append('<span  id="co'+z+'-status" data-name='+e.status+'></span> ');
      $('#getco'+z+'Year').append('<span  id="co'+z+'-year" data-name='+e.year_founded+'></span> ');
      $('#getco'+z+'Ig').append('<span  id="co'+z+'-ig" data-name='+e.industry_group+'></span> ');
      $('#getco'+z+'Sector').append('<span  id="co'+z+'-sector" data-name='+e.primary_tag+'></span> ');
      $('#getco'+z+'CapRaised').append('<span  id="co'+z+'-cap-raised" data-name='+e.capital+'></span> ');
      $('#getco'+z+'DevStage').append('<span  id="co'+z+'-dev-stage" data-name='+e.stage+'></span> ');
      $('#getco'+z+'Country').append('<span  id="co'+z+'-country" data-name='+e.country+'></span> ');
      $('#getco'+z+'NumEmp').append('<span  id="co'+z+'-num-emp" data-name='+e.num_employee_range+'></span> ');
      $('#getco'+z+'RevRange').append('<span  id="co'+z+'-rev-range" data-name='+e.revenue+'></span> ');
      if (e.rounds != null) {
        $('#getco'+z+'FinEvents').append('<span  id="co'+z+'-fin-events" data-name='+e.rounds+'></span> ');
          if (e.rnds_date != null || e.rnds_date != "") {
            $('#getco'+z+'FinEvents').append('<br />');
            $('#getco'+z+'FinEvents').append('<span  id="co'+z+'-fin-year" data-name='+e.rnds_date+'></span> ');
           }
      }
      $('#getco'+z+'Investors').append('<span  id="co'+z+'-investors" data-name='+e.investors+'></span> ');
      
        if (e.capital == "$0") {
            var capraised = ""
        } else {
            var capraised = e.capital
        }

        if (e.rnds_date == "") {
            var rndyr = ""
        } else {
            var rndyr = e.rnds_date
        }
        
        if (e.rnds_amt == "$0" || e.rnds_amt == "") {
            var rndamt = ""
        } else {
            var rndamt = ' round of '+e.rnds_amt
        } 
    
      $('#co'+z+'-name').text(e.name);
      $('#co'+z+'-desc').text(e.short_description);      
      $('#co'+z+'-status').text(e.status);
      $('#co'+z+'-year').text(e.year_founded);
      $('#co'+z+'-ig').text(e.industry_group);
      $('#co'+z+'-sector').text(e.primary_tag);
      $('#co'+z+'-cap-raised').text(capraised);
      $('#co'+z+'-dev-stage').text(e.stage);
      $('#co'+z+'-country').text(e.country);
      $('#co'+z+'-num-emp').text(e.num_employee_range);
      $('#co'+z+'-rev-range').text(e.revenue);
      $('#co'+z+'-fin-events').text(e.rounds+rndamt);
      $('#co'+z+'-fin-year').text(rndyr);
      $('#co'+z+'-investors').text(e.investors);
      
      $scope.$apply(function() {
      });
    },
    onDelete: function(e) {
        if($(this).is('#compare_company_input1')){
          z = 1
        } else if ($(this).is('#compare_company_input2')) {
          z = 2
        } else if ($(this).is('#compare_company_input3')) {
          z = 3
        }
      $('#getco'+z+'Logo').children("div").remove();
      $('.comp'+z+'-name').children("span").remove();
      $('.comp'+z+'-name').children("br").remove();
    },
  });

  function getCorporateTagsSearchUrl() {
    var url = "/api/suggest/corporate_tags?current=";
    var selected = [];

    if($scope.corporateTagsSelector) {
      selected = $.map($scope.corporateTagsSelector.tokenInput('get'), function(m) { return m.id; });
    }

    return (url + selected.join(','));
  };

  function getParentSearchUrl() {
    var url = "/api/suggest/company_all_name_and_id?current=";
    var selected = [];

    if($scope.parentSelector) {
      selected = $.map($scope.parentSelector.tokenInput('get'), function(m) { return m.id; });
    }

    return (url + selected.join(','));
  };

  function getSecondaryTagSearchUrl() {
    var url = "/api/suggest/secondary_tags?current=";
    var selected = [];

    // if($scope.secondaryTagSelector) {
    //   selected = $.map($scope.secondaryTagSelector.tokenInput('get'), function(m) { return m.id; });
    // }

    return (url + selected.join(','));
  };

  function getBoardmemberSearchUrl() {
    var url = "/api/suggest/teammember_name?current=";
    var current = $.map($('.boardmember-remove-link'), function (m) { return $(m).attr('data-teammember-id'); });
    var selected = [];

    if($scope.boardmemberSelector) {
      selected = $.map($scope.boardmemberSelector.tokenInput('get'), function(m) { return m.id; });
    }

    return (url + current.concat(selected).join(','));
  };

  function getTeamSearchUrl() {
    var url = "/api/suggest/teammember_name?current=";
    var current = $.map($('.team-full-remove-link'), function (m) { return $(m).attr('data-teammember-id'); });
    var selected = [];

    if($scope.teamSelector) {
      selected = $.map($scope.teamSelector.tokenInput('get'), function(m) { return m.id; });
    }

    return (url + current.concat(selected).join(','));
  };

  function getCompanySearchUrl() {
    var url = "/api/suggest/company_name_and_id?current=";
    var current = $.map($('.competitor-remove-link'), function (m) { return $(m).attr('data-competitor-id'); });
    var selected = [];

    if($scope.competitorSelector) {
      selected = $.map($scope.competitorSelector.tokenInput('get'), function(m) { return m.id; });
    }

    return (url + current.concat(selected).join(','));
  };
  
  
    function getCompareSearchUrl() {
      var url = "/api/suggest/compare_search?";
      var current = "";
      var selected = [];

      if($scope.compareSelector) {
        selected = $.map($scope.compareSelector.tokenInput('get'), function(m) { return m.id; });
      }

      return (url + selected.join(','));
    };
    
  
  $scope.tiles = $.map($('.app-tile'), function (m) { 
  	var tile_id = $(m).attr('data-tile-id'); 
  	return tile_id;
  									   });
  $scope.companyId = $('#company-content').attr('data-company-id');

  function collectToBeAddedTeammembers() {
    var obj = getManagementCopyData();
    var params = {
      remove_teammember: []
    };

    $('.management-deleted:hidden').each(function(i,f) { params.remove_teammember.push($(f).attr('data-teammember-id')); });

    if(obj) {
      if($scope.teamSelector.tokenInput('get').length > 0) {
        //add existing user to team
        obj['person_id'] = $.map($scope.teamSelector.tokenInput('get'), function(m) { return m.id; }).join('');
        params['add_existing'] = obj;
      }
      else if(obj.teammember.id == null && obj.teammember.person.id == '') {
        //add new teammember and new person
        params['add'] = obj;
      }
      else if(obj.teammember.id && obj.teammember.person && obj.teammember.person.id) {
        //update existing user to in existing team
        params['update'] = obj;
      }
    }

    return params;
  };

  function collectToBeRemovedI3Users() {
    var params = {
      remove_i3user: []
    };

    $('.i3user-deleted:hidden').each(function(i,f) { params.remove_i3user.push($(f).attr('data-i3user-id')); });

    return params;
  };

  function collectToBeAddedBoardmembers() {
    var obj = getBoardCopyData();
    var params = {
      remove_boardmember: []
    };

    $('.board-deleted:hidden').each(function(i,f) { params.remove_boardmember.push($(f).attr('data-boardmember-id')); });

    if(obj) {
      if($scope.boardmemberSelector.tokenInput('get').length > 0) {
        //add existing user to team
        obj['company_id'] = $scope.companyId;
        obj['person_id'] = $.map($scope.boardmemberSelector.tokenInput('get'), function(m) { return m.id; }).join('');
        params['add_existing'] = obj;
      }
      else if(obj.boardmember.id == null && obj.boardmember.person.id == "") {
        //add new teammember and new person
        params['add'] = obj;
      }
      else if(obj.boardmember.id && obj.boardmember.person && obj.boardmember.person.id) {
        //update existing user to in existing team
        params['update'] = obj;
      }
    }

    return params;
  };

  function collectToBeAddedCompetitors() {
    var ids = [];
    var new_ids = $.map($scope.competitorSelector.tokenInput('get'), function(m) { return m.id; });

    $('.competitor-list .pictures-250x100 ').each(function(index, value) {
      var elem = $(value);

      if(elem.css('display') != 'none') {
        ids.push(elem.find('a').attr('data-competitor-id'));
      }
    });

    return ids.concat(new_ids);
  };


  function isAnyTeamOrBoardDeleted() {
    return ($('.management-deleted:hidden').length + $('.board-deleted:hidden').length + $('.i3user-deleted:hidden').length) > 0;
  };

  function collectToBeAddedAcquisitions() {
    var obj = getMaCopyData();
    var params = {remove: []};
    $('.ma-deleted:hidden').each(function(i,f) { params.remove.push($(f).attr('data-ma-id')); });

    if(obj) {
      var acquired_id = $.map(maSelector.tokenInput('get'), function(m) { return m.id; }).join("");

      if($('.edit-direction-copy').val() == '1') {
        obj['company_id'] = $scope.companyId;
        obj['acquired_id'] = acquired_id;
      }
      else {
        obj['company_id'] = acquired_id;
        obj['acquired_id'] = $scope.companyId;
      }

      //if id exists, then it's an updates
      if(obj.id) {
        params.update = {};
        params.update.acquisition_id = obj.id;
        params.update.acquisition = obj;
      }
      else {
        params.add = {};
        params.add.acquisition = obj;
      }
    }

    return params;
  };

  function generateParams(tile) {
    var params = {};

    $.each($('.' + tile + 'Input'), function(i,f) {
      var elem = $(f);
      var name = elem.attr('name');
      params[name] = elem.val();
    });
    
    if(tile == "tags") {
      params['primary_tag_id'] = $scope.primary_tag_id;
      params['industry_group_id'] = $scope.industry_group_id;
      // params['edited_tags'] = $.map($scope.secondaryTagSelector.tokenInput('get'), function(m) { return m.id; });
      params['company_tag_list'] = $('#company_tags_editor_input').val();
    }
    else if(tile == "git") {
      params['amount'] = $scope.seeking_funding && $scope.seeking_funding.amount;

      if($scope.primary_contact_id) {
        params['primary_contact_id'] = $scope.primary_contact_id;
      }
    }
    else if(tile == 'competitors') {
      params['competitor_ids'] = collectToBeAddedCompetitors();
    }
    else if(tile == "traction") {
      params['revenue_range_id'] = $scope.traction.revenue_range_id;
      params['num_employee_range_id'] = $scope.traction.num_employee_range_id;
    }
    else if(tile == 'team-full') {
      params['teammember'] = collectToBeAddedTeammembers();
      params['boardmember'] = collectToBeAddedBoardmembers();
      params['i3user'] = collectToBeRemovedI3Users();
    }
    else if(tile == "ma") {
      params = collectToBeAddedAcquisitions();
    }
    else if(tile == "team-short") {
      if($scope.profile.primary_contact) {
        params['primary_contact_id'] = $scope.profile.primary_contact.id;
      }
    }
    else if (tile == "investments-made") {
      var obj = {
      };
      
      
      params['remove'] = [];
      $('.editable-investment.deleted-investment').each(function(i,f) {
        params.remove.push($(f).attr('data-investment-id'));
      });
      
      params['remove_comp_rels'] = [];
      $('.editable-investment.deleted-comp-rel').each(function(i,f) {
        params.remove_comp_rels.push($(f).attr('data-investment-id'));
      });
      
      if($scope.investment && $scope.showUpdateEditor['investments-made']) {
        obj['company_id'] = $.map(relationshipSelector.tokenInput('get'), function(m) { return m.id; }).join("");
        params['investment_id'] = $scope.investment.id;

        copyScopeToParamThroughList($scope.investment,
          obj,
          ['id','investment_date','investment_type_id','amount','notes','source']
        );
        if($scope.investment.id) {
          params['update'] = {};
          params['update']['investment'] = obj;
        }
        else {
          params['add'] = {};
          params['add']['investment'] = obj;
        }
      }
    }
    else if(tile == "investment") {
      var obj = getInvestmentCopyData();
      params['remove'] = [];
      
      $('.investment-deleted:hidden').each(function(i,f) { 
      	params.remove.push($(f).attr('data-investment-id')); 
      });

      if(obj) {
        params['investors'] = $.map(investmentSelector.tokenInput('get'), function(m) { return m.id; });
        params['investment_id'] = obj.id;

        if(obj.id) {
          params['update'] = {};
          params['update']['investment'] = obj;
          
		  var inv_list = $('.investors_entered');
          		
		  if (inv_list.length) {
	          params['update']['inc_accel_rel'] = $("input[type=radio][name=inv_rel_sel]:checked").val();
          }
        }
        else {
          params['add'] = {};
          params['add']['investment'] = obj;
          
		  var inv_list = $('.investors_entered');
          		
		  if (inv_list.length) {
	          params['add']['inc_accel_rel'] = $("input[type=radio][name=inv_rel_sel]:checked").val();		  
          }
        }
      }

      if(!$.isEmptyObject($scope.ipoHistory)) {
        params['ipo_history'] = {
          company_id: $scope.companyId
        };

        copyScopeToParamThroughList($scope.ipoHistory,
          params['ipo_history'],
          ["id","ipo_status_id","ipo_type_id","as_of_date","amount","initial_share","ticker_symbol","exchange","prospectus","source","notes"]
        );
      }
    }
    else if(tile == "relationship") {
      var obj = getRelationshipCopyData();
      params['remove'] = [];
      $('.relationship-deleted:hidden').each(function(i,f) { params.remove.push($(f).attr('data-relationship-id')); });

      if(obj) {
        obj['company1_id'] = $scope.companyId;
        obj['company2_id'] = $.map(relationshipSelector.tokenInput('get'), function(m) { return m.id; }).join('');
        params['relationship_id'] = obj.id;

        if(obj.id) {
          params['update'] = {};
          params['update']['relationship'] = obj;
        }
        else {
          params['add'] = {};
          params['add']['relationship'] = obj;
        }
      }
    }
    else if(tile == "customer") {
      var obj = getCustomerCopyData();
      params['remove'] = [];
      $('.customer-deleted:hidden').each(function(i,f) { params.remove.push($(f).attr('data-customer-id')); });

      if(obj) {
        obj['company1_id'] = $scope.companyId;
        obj['company2_id'] = $.map(customerSelector.tokenInput('get'), function(m) { return m.id; }).join('');
        params['relationship_id'] = obj.id;

        if(obj.id) {
          params['update'] = {};
          params['update']['customer'] = obj;
        }
        else {
          params['add'] = {};
          params['add']['customer'] = obj;
        }
      }
    }
    else if(tile == "note") {
      var obj = {};
      
      params['remove'] = [];
      
      if ($scope.noteDeleteId != null)
      {
      	params['remove'].push($scope.noteDeleteId);
      	
      	$scope.notePreDelete = false;
		$scope.noteDeleteId = null;
      }
      
      // PD 20170406 - Disabling this for now since hiding notes is a necessity with the new layout.
//       $('.note-item:hidden').each(function(i,f) { params.remove.push($(f).attr('data-note-id')); });

      if($scope.note && $scope.showUpdateEditor['note']) {
        params['note_id'] = $scope.note.id;
        obj['company_id'] = $scope.companyId;

        copyScopeToParamThroughList($scope.note,
          obj,
          ['note_date','note_text', 'title', 'user_note_structure_id']		// PD 20170403 - Check and make sure adding user_note_structure_id does not effect edits!
        );

        obj['qa_info'] = $scope.note.qa_info;

        if($scope.note.id) 
        {
          params['update'] = {};
          params['update']['note'] = obj;
        }
        else {
          params['add'] = {};
          params['add']['note'] = obj;
        }
      }
    }
    else if(tile == "product") {
      var obj = getProductCopyData();
      params['remove'] = [];
      $('.product-deleted:hidden').each(function(i,f) { params.remove.push($(f).attr('data-product-id')); });

      if(obj) {
        params['product_id'] = obj.id;
        obj['company_id'] = $scope.companyId;

        if(obj.id) {
          params['update'] = {};
          params['update']['product'] = obj;
        }
        else {
          params['add'] = {};
          params['add']['product'] = obj;
        }
      }
    }
    else if(tile == "looking-for") {
      params['snapshot'] = $scope.company.snapshot;
      params['offer'] = $scope.company.offer;
      params['tag_ids'] = $.map($scope.corporateTagsSelector.tokenInput('get'), function(m) { return m.id; });
      params['development_stage_ids'] = $.map($scope.stageSelector.tokenInput('get'), function(m) { return m.id; });
      params['geography_ids'] = $.map($scope.geographySelector.tokenInput('get'), function(m) { return m.id; });
      params['revenue_range_ids'] = $.map($scope.revenueRangeSelector.tokenInput('get'), function(m) { return m.id; });
    }
    else if(tile == "offer") {
      params['offer'] = $scope.company.offer;
      params['deal_type_ids'] = $.map($scope.dealTypeSelector.tokenInput('get'), function(m) { return m.id; });
    }
    else if(tile == "campaign") {
      params['selected'] = $scope.selected_campaigns;
    }
    

    return params;
  };

  $scope.findItem = function(typeName, itemId) {
    return findItem(typeName, itemId);
  };

  $scope.deleteSeekingFunding = function() {
    $('.seeking-funding').hide();
  };

  $scope.scrollTo = function(id) {
    $(window).scrollTo('#'+id);
  //  $location.hash(id);
  //  $anchorScroll();
  };

  function copyScopeToParamThroughList(s, p, l) {
    for(var i = 0; i < l.length; i++) {
      p[l[i]] = s[l[i]];
    }
  };

  function getCustomerCopyData() {
    var customer = $('.customer-copy');

    if(customer.length > 0) {
      return {
        id: customer.prop('data-customer-id'),
        relationship_date: customer.find('.edit-date').val(),
      //  relationship_type_id:
      //  size:
        confirmation_email: customer.find('.edit-email').val(),
        notes: customer.find('.edit-notes').val(),
        source: customer.find('.edit-source').val()
      };
    }

    return false;
  };

  function getInvestmentCopyData() {
    var investment = $('.investment-copy');

    if(investment.length > 0) {
      var ivalue = investment.find('.edit-investment-type').val();
      var iid = (ivalue == "" || ivalue == "?") ? null : $scope.profile.edit_options.investment_types[investment.find('.edit-investment-type').val()].id;

      return {
        company_id: $scope.companyId,
        id: investment.prop('data-investment-id'),
        investment_date: investment.find('.edit-date').val(),
        investment_type_id: iid,
        amount: investment.find('.edit-amount').val(),
        valuation: investment.find('.edit-valuation').val(),
        notes: investment.find('.edit-notes').val(),
        source: investment.find('.edit-source').val()
      };
    }

    return false;
  };

  function getManagementCopyData() {
    var p = $('.management-copy');

    if(p.length > 0) {
      return {
        teammember : {
          person_id: p.find('.edit-person').val(),
          date_joined: p.find('.edit-joined').val(),
          date_departed: p.find('.edit-departed').val(),
          id: p.prop('data-teammember-id'),
          title : p.find('.edit-title').val(),
          company_id : $scope.companyId,
          person: {
            first_name: p.find('.edit-first').val(),
            last_name: p.find('.edit-last').val(),
            linkedin_url: p.find('.edit-linkedin').val(),
            id: p.find('.edit-person').val()
          }
        },
        company_id : $scope.companyId,
        team_id : p.prop('data-teammember-id')
      };
    }

    return false;
  };


  function getBoardCopyData() {
    var p = $('.board-copy');

    if(p.length > 0) {
      var rid = p.find('.edit-role').val() != "" ? $scope.profile.edit_options.board_member_roles[p.find('.edit-role').val()].id : null;
      return {
        boardmember : {
          person_id: p.find('.edit-person').val(),
          role_id: rid,
          start_date: p.find('.edit-start').val(),
          end_date: p.find('.edit-end').val(),
          id: p.prop('data-board-id'),
          company_id : $scope.companyId,
          investor_id: $.map(investorSelector.tokenInput('get'), function(m) { return m.id; }).join(""),
          person: {
            first_name: p.find('.edit-first').val(),
            last_name: p.find('.edit-last').val(),
            linkedin_url: p.find('.edit-linkedin').val(),
            id: p.find('.edit-person').val()
          }
        },
        company_id : $scope.companyId,
        boardmember_id : p.prop('data-board-id')
      };
    }

    return false;
  };

  function getMaCopyData() {
    var p = $('.ma-copy');

    if(p.length > 0) {
      return {
        id: p.prop('data-ma-id'),
        date_closed: p.find('.edit-date-closed').val(),
        date_announced: p.find('.edit-date-announced').val(),
        notes: p.find('.edit-notes').val(),
        source: p.find('.edit-source').val(),
        amount: p.find('.edit-amount').val()
      };
    }

    return false;
  };

  function getRelationshipCopyData() {
    var p = $('.relationship-copy');

    if(p.length > 0) {
      var rti = p.find('.edit-relationship-type').val() != "" ? $scope.profile.edit_options.partnership_relationship_types[p.find('.edit-relationship-type').val()].id : null;
      return {
        id: p.prop('data-relationship-id'),
        relationship_date: p.find('.edit-date').val(),
        relationship_type_id: rti,
        confirmation_email: p.find('.edit-email').val(),
        notes: p.find('.edit-notes').val(),
        source: p.find('.edit-source').val()
      };
    }

    return false;
  };

  function getProductCopyData() {
    var p = $('.product-copy');

    if(p.length > 0) {
      var psid = p.find('.edit-status').val() != "" ? $scope.profile.edit_options.product_statuses[p.find('.edit-status').val()].id : null;
      var rid = p.find('.edit-revenue').val() != "" ? $scope.profile.edit_options.revenues[p.find('.edit-revenue').val()].id : null;
      return {
        id: p.prop('data-product-id'),
        name: p.find('.edit-name').val(),
        description: p.find('.edit-description').val(),
        product_status_id: psid,
        revenue_id: rid,
        usd_per_kw_current: p.find('.edit-usd_per_kw_current').prop('value'),
        usd_per_kwh_current: p.find('.edit-usd_per_kwh_current').prop('value'),
        usd_per_kw_prospected: p.find('.edit-usd_per_kw_prospected').prop('value'),
        usd_per_kwh_prospected: p.find('.edit-usd_per_kwh_prospected').prop('value')
      };
    }

    return false;
  };


  function firstValidPdf(decks) {
    for(var i = 0; decks && (i < decks.length); i++) {
      if(decks[i]) {
        $scope.selectedPdfTypeId = i + 1;
        return decks[i];
      }
    }
    return null;
  };

  function editOptionsLoad() {
    companyService.editOptions()
      .success(function(data, status) {
        $scope.editOptions = data;
      })
      .error(function(data, status) {
        alert("Unable to load edit options");
      });
  };


  $scope.tiles.forEach(function(t) {
    $scope.showPencil[t] = false;
    $scope.showLoading[t] = true;
    $scope.isEditing[t] = false;
    $scope.showSave[t] = false;
    $scope.showUpdateEditor[t] = false;
  });

  function runAfterLoad() {
  //  editOptionsLoad();

    if($scope.profile.structure) {
      $scope.htmlBindings['parentCompaniesHtml'] = $sce.trustAsHtml($scope.profile.structure.parent);
      $scope.htmlBindings['childCompaniesHtml'] = $sce.trustAsHtml($scope.profile.structure.child);
      $scope.htmlBindings['subsidiaryCompaniesHtml']= $sce.trustAsHtml($scope.profile.structure.subsidiary);
    }

    if($scope.profile.patent_data && $scope.profile.patent_data.uspto_count == 0) {
      if($scope.profile.patent_data && $scope.profile.patent_data.espacenet_count > 0) {
        $scope.switchPatent("espacenet");
      }
      else if ($scope.profile.patent_data && $scope.profile.patent_data.uspto_published_count > 0) {
        $scope.switchPatent("uspto-published");
      }
    }

    $scope.selectedPdf = firstValidPdf($scope.profile.company_deck);//$scope.profile.company_deck[$scope.selectedPdfTypeId - 1];
    $('#select-pdf-options').val($scope.selectedPdfTypeId);
    $('#select-pdf-options').selectBox('refresh');
    $scope.globalLoading = false;

    $scope.htmlBindings['trustedAcquiredCompanyHtml'] = $sce.trustAsHtml($scope.profile.acquired_message);

    $scope.tiles.forEach(function(t) {
      $scope.showLoading[t] = false;
      $scope.showPencil[t] = false;
      $scope.following_text = "";
    });

    $scope.messages['hideOrPublish'] = $scope.profile.company.hidden ? "Publish" : "Hide";

    $scope.enableGE();
  };

  $scope.deleteDeckPdf = function() {
    if(!$scope.showLoading['deck']) {
      $scope.showLoading['deck'] = true;
      $scope.showSave['deck'] = false;

      companyService.deleteCompanyDeck($scope.selectedPdf.id)
        .success(function(data, status) {
          $scope.profile.company_deck = data;
          $scope.selectedPdf = null;
          $scope.showLoading['deck'] = false;
          $scope.showSave['deck'] = true;
        })
        .error(function(data, status) {
          $scope.showLoading['deck'] = false;
          $scope.showSave['deck'] = true;
        });
    }
  };

  $scope.updatePrimaryContact = function(position, entities) {
    angular.forEach(entities, function(pc, index) {
      if(position != index)
        pc.checked = false;
    });

    var pc = entities[position];
    var pcId = pc.checked == true ? pc.id + "__AdminUser" : null;
    var params = {id: $scope.companyId, type: "company", sections: {git: {amount: null, primary_contact_id: pcId}}};

    companyService.updateCompanyProfile(params, "git").
      success(function(data, status) {
        $scope.profile = data;
      }).
      error(function(data, status) {

      });
  };

  $scope.toggleGlobalEditor = function() {
    if($scope.globalLoading) {
      return;
    }

    $scope.globalEdit = !$scope.globalEdit;

    if($scope.globalEdit) {
    //global editing on
      $scope.tiles.forEach(function(t) { $scope.showPencil[t] = true; });
      $scope.isEditingMode = true;
      
	      $scope.tiles.forEach(function(t) { 
    	  	if (t.includes("program_")) {
	    	  	$scope.showPencil[t] = false; 
		    }
    	  });
      
    }
    else {
    //global editing off
      $scope.tiles.forEach(function(t) { $scope.showPencil[t] = false; });
      $scope.isEditingMode = false;
    }

    $scope.messages["normalEdit"] = $scope.showPencil['git'] ? "Stop" : "";
    $scope.messages["basicEdit"] = $scope.showPencil['overview'] ? "Stop" : "";
    $scope.messages["corporateEdit"] = $scope.showPencil['overview'] ? "Stop" : "";

    $scope.tiles.forEach(function(t) {
      $scope.showLoading[t] = false;
      $scope.isEditing[t] = false;
      $scope.showSave[t] = false;
    });
  };

  $scope.removeCompetitor = function(e) {
    if(e.target.className == "competitor-remove-icon") {
      e.stopPropagation();
      e.preventDefault();
      var competitorId = $(e.target).parent().attr('data-competitor-id');
      $scope.toRemoveCompetitors.push(competitorId);
      $(e.target).closest(".pictures-250x100").hide();
    }
  };

  $scope.edit = function(id) {
    $scope.showPencil[id] = !$scope.showPencil[id];
    $scope.showSave[id] = !$scope.showSave[id];
    $scope.isEditing[id] = !$scope.isEditing[id];

    if($scope.isEditing[id]) {
      if(id == 'overview') {
        $scope.company = angular.copy($scope.profile.company);

        try {
          $scope.parentSelector.tokenInput("clear");
          for(var i = 0; i < $scope.profile.structure.parent_objs.length; i++) {
            var parent = $scope.profile.structure.parent_objs[i];
            $scope.parentSelector.tokenInput("add", {id: parent.id, name: parent.name});
          }
        }
        catch(err) {
        }
      }
      else if(id == "products_tech") {
        $scope.snapshot = {};
        $scope.snapshot.overview = angular.copy($scope.profile.company.overview);
        $('.products-tech-header a.selectBox').show();
      }
      else if(id == "competitors") {
        $scope.toRemoveCompetitors = [];
        $scope.competitors = angular.copy($scope.profile.competitors);
      }
      else if(id == "traction") {
        $scope.traction = angular.copy($scope.profile.traction);
      }
      else if(id == "team-full") {
        $scope.team = angular.copy($scope.profile.team);
        $('.show-add-team-link').show();
        $('#current_management_selected').hide();
        $scope.addInvestor = { name: "", country_id: 15026, investor_type_id: null };
        $scope.addInvestorFrom = "team";
      }
      else if(id == "git" || id == "team-short") {
        $scope.seeking_funding = angular.copy($scope.profile.seeking_funding);

        if($scope.profile.primary_contact) {
          $scope.primary_contact_id = $scope.profile.primary_contact.id_selected;
        }
      }
      else if(id == "customer") {
        $scope.addCompany = { name: "", country_id: 15026 };
        $scope.addCompanyFrom = "customer";
      }
      else if(id == "ma") {
        $('#merge_direction').val(1);
        $scope.addCompany = { name: "", country_id: 15026 };
        $scope.addCompanyFrom = "ma";
      }
      else if(id == "tags") {
        $scope.tagsEdit(null);
      }
      else if(id == "relationship") {
        $scope.addCompanyFrom = "relationship";
        $scope.addCompany = { name: "", country_id: 15026 };
      }
      else if(id == "investments-made") {
        $scope.addCompany = { name: "", country_id: 15026 };
        $scope.addCompanyFrom = "investments-made";
      }
      else if(id == "investment") {
        $scope.addInvestor = { name: "", country_id: 15026, investor_type_id: null };
        $scope.addInvestorFrom = "investment";
        $scope.ipoHistory = angular.copy($scope.profile.ipo_history);
      }
      else if(id == 'looking-for') {
        $scope.company = angular.copy($scope.profile.company);
        $scope.stageSelector.tokenInput("clear");
        $scope.geographySelector.tokenInput("clear");
        $scope.corporateTagsSelector.tokenInput("clear");
        $scope.revenueRangeSelector.tokenInput("clear");
        $.each($scope.profile.seeking_development_stages, function(k,v) { $scope.stageSelector.tokenInput("add", { id: v.id, name: v.name}); });
        $.each($scope.profile.seeking_geographies, function(k,v) { $scope.geographySelector.tokenInput("add", { id: v.id, name: v.name}); });
        $.each($scope.profile.seeking_tags, function(k,v) { $scope.corporateTagsSelector.tokenInput("add", { id: v.id, name: v.tag_name}); });
        $.each($scope.profile.seeking_revenue_ranges, function(k,v) { $scope.revenueRangeSelector.tokenInput("add", { id: v.id, name: v.name}); });
      }
      else if(id == "offer") {
        $scope.company = angular.copy($scope.profile.company);
        $scope.dealTypeSelector.tokenInput("clear");
        $.each($scope.profile.seeking_deal_types, function(k,v) { $scope.dealTypeSelector.tokenInput("add", { id: v.id, name: v.name}); });
      }
      else if(id == "campaign") {
        $scope.showUpdateEditor['campaign'] = true;
        $scope.selected_campaigns = $.map($scope.profile.selected_campaigns, function(m) { return m.id; });
      }
      else if(id == "patents") {
        $scope.showAllPatents($scope.patentType);
      }
    }
  };

  $scope.updatePipeline = function(isValid) {
    if(isValid && !$scope.isShowing['addPipeline']) {
      $scope.messages['addPipeline'] = "";
      $scope.isShowing['addPipeline'] = true;
      $scope.isModalSaving['addPipeline'] = true;

      var params = {
        remove_unselected : true,
        company_ids : [ $scope.companyId ],
        selected_ids : $.map($('.pipeline-input:checked'), function(m) { return $(m).val(); }),
        presented_list_ids : $.map($('.presented_list_ids'), function(m) {return $(m).val() })
      };

      companyService.updateUserLists(jQuery.param(params))
        .success(function(data, status) {
          $('.close').trigger("click");
          $scope.isModalSaving['addPipeline'] = false;
          $scope.isShowing['addPipeline'] = false;
        })
        .error(function(data, status) {
          $scope.isModalSaving['addPipeline'] = false;
          $scope.isShowing['addPipeline'] = false;
        });
    }
  };

  $scope.addUserList = function() {
    var name = $('#input-user-list').val();

    if(name != "") {
      var user_list = {
        name : name
      };

      $scope.messages['addPipelineButton'] = "Saving...";

      companyService.createUserList(user_list)
        .success(function(data, status) {
          $scope.profile.user_lists.push({ name : data.name, id : data.id, checked : true });
          $('#input-user-list').val("");
          $scope.messages['addPipelineButton'] = "Create list";
        })
        .error(function(data, status) {
          $scope.messages['addPipelineButton'] = "Create list";
          alert(data.status);
        });
    }
  };

  $scope.contactProfile = function(isValid) {
    $scope.submitted = true;

    var params = {
      user_ids: $.map($(".uneditable-input .token-input-token"), function(m) { return $(m).attr('data-id'); }),
      subject: $('#contact-profile-subject').val(),
      body: $('#contact-profile-body').val()
    };

    if(isValid && !$scope.isShowing['contactProfile']) {
      $scope.messages['contactProfile'] = "";
      $scope.isShowing['contactProfile'] = true;
      $scope.isModalSaving['contactProfile'] = true;

      companyService.contactProfile(params, $scope.companyId)
        .success(function(data, status) {
          $scope.submitted = false;
          $scope.contactProfile.emails = null;
          $('.close').trigger("click");
          $scope.isShowing['contactProfile'] = false;
          $scope.isModalSaving['contactProfile'] = false;
          $scope.profile.messages_sent = data.messages_sent;
          $scope.profile.message_url = data.message_url;

        })
        .error(function(data, status) {
          $scope.messages['contactProfile'] = data.status_message;
          $scope.isShowing['contactProfile'] = false;
          $scope.isModalSaving['contactProfile'] = false;
        });
    }
  };

  $scope.requestUpdate = function (isValid) {
    $scope.submitted = true;

    var params = {
      comment : $('#request_update_comment').val()
    }

    if(isValid && !$scope.isShowing['requestUpdate']) {
      $scope.messages['requestUpdate'] = "";
      $scope.isShowing['requestUpdate'] = true;
      $scope.isModalSaving['requestUpdate'] = true;

      companyService.requestUpdate(params, $scope.companyId)
        .success(function(data, status) {
          $scope.submitted = false;
          $('#request_update_comment').val("");
          $('.close').trigger("click");
          $scope.isModalSaving['requestUpdate'] = false;
          $scope.isShowing['requestUpdate'] = false;
        })
        .error(function(data, status) {
          $scope.messages['requestUpdate'] = data.status_message;
          $scope.isModalSaving['requestUpdate'] = false;
          $scope.isShowing['requestUpdate'] = false;
        });
    }
  };

  $scope.inviteColleagues = function(isValid, isCorporate) {
    $scope.submitted = true;

    if(isValid) {
      var params = {
        email : $scope.inviteColleague.emails,
        first_name : $scope.inviteColleague.first_name,
        last_name : $scope.inviteColleague.last_name,
        title: $scope.inviteColleague.title,
        corporate: isCorporate
      };

      $scope.isModalSaving['inviteColleague'] = true;
      $scope.messages['inviteColleague'] = "";

      companyService.inviteColleague(params, $scope.companyId)
        .success(function(data, status) {
          $scope.inviteColleague = {};
          $('.close').trigger("click");
          $scope.isModalSaving['inviteColleague'] = false;
          $scope.messages['inviteColleague'] = "";
          $scope.submitted = false;


        })
        .error(function(data, status) {
          $scope.messages['inviteColleague'] = data.status_message;
          $scope.isModalSaving['inviteColleague'] = false;
        });
    }
  };

  $scope.shareProfile = function(isValid) {
    $scope.submitted = true;

    var params = {
      email : $scope.shareProfile.emails,
      custom_text : $('#custom_text').val()
    };

    if(isValid && !$scope.isShowing['shareProfile']) {
      $scope.messages['shareProfile'] = "";
      $scope.isShowing['shareProfile'] = true;
      $scope.isModalSaving['shareProfile'] = true;

      companyService.shareProfile(params, $scope.companyId)
        .success(function(data, status) {
          $scope.submitted = false;
          $scope.shareProfile.emails = null;
          $('.close').trigger("click");
          $scope.isShowing['shareProfile'] = false;
          $scope.isModalSaving['shareProfile'] = false;
          $scope.messages['shareProfile'] = "";
        })
        .error(function(data, status) {
          $scope.messages['shareProfile'] = data.status_message;
          $scope.isShowing['shareProfile'] = false;
          $scope.isModalSaving['shareProfile'] = false;
        });
    }
  };


  $scope.editTiles = function(type) {
    var tiles = {
      basic : [
        'traction',
        'overview'
      ],
      corporate : [
        'overview',
        'git',
        'looking-for',
        'campaign',
        'offer'
      ],
      normal : [
        'git',
        'ma',
        'tags',
        'team-short',
        'team-full',
        'products_tech',
        'deck',
        'looking-for',
        'competitors',
        'customer',
        'relationship',
        'investment',
        'investments-made',
        'product',
        'note',
        'patents'
      ]
    };

    if(!$scope.globalLoading) {
      for(var i = 0; i < tiles[type].length; i++) {
        $scope.showPencil[tiles[type][i]] = !$scope.showPencil[tiles[type][i]];
      }

      if(type == 'normal') {
        $scope.isEditingMode = !$scope.isEditingMode;
        $scope.messages["normalEdit"] = $scope.showPencil['git'] ? "Stop" : "";

        if($scope.showPencil['products_tech']) {
          $('.products-tech-header a.selectBox').show();
        }
        else if(!$scope.showPencil['products_tech'] && $scope.selectedPdf == null) {
          $('.products-tech-header a.selectBox').hide();
        }
      }
      else if(type == "corporate") {
        $scope.messages["corporateEdit"] = $scope.showPencil['overview'] ? "Stop" : "";
      }
      else {
        $scope.messages["basicEdit"] = $scope.showPencil['overview'] ? "Stop" : "";
      }
    }
  };

  $scope.filesChanged = function(elm) {
    $scope.fileExtensionError = false;

    if(elm.files[0].name.match(/\.([^\.]+)$/)[1].toLowerCase() == "pdf" ) {
      $scope.files = elm.files;
      $scope.upload();
    }
    else {
      alert("File must be PDF");
      $scope.fileExtensionError = true;
    }

    $scope.$apply();
  };

  $scope.productPictureChanged = function(elm) {
    $scope.product_image = elm.files;
    $scope.$apply();

    $('.upload-image-icon').show();

    if($scope.product_image && $scope.product_image[0]) {
      previewImage($scope.product_image[0], "product_image_preview-copy");
      $('.upload-image-icon').hide();
    }
  };

  $scope.logoChanged = function(elm) {
    if(elm.files[0].type == "image/jpeg" || elm.files[0].type == "image/png") {
      $scope.logo_image = elm.files;
      $scope.$apply();

      if($scope.logo_image && $scope.logo_image[0]) {
        previewImage($scope.logo_image[0], "logo_image_preview");
      }
    }
    else {
      alert("File must be JPEG or PNG");
    }
  };

  function previewImage(file, preview_id) {
    var oFReader = new FileReader();
    oFReader.readAsDataURL(file);

    oFReader.onload = function (oFREvent) {
      document.getElementById(preview_id).src = oFREvent.target.result;
    };
  };

  $scope.updateFollowState = function() {
    if(!$scope.showFollowingLoading) {
      $scope.showFollowingLoading = true;

      if($scope.profile.follow == "follow") {
        companyService.follow($scope.profile.company.id)
          .success(function(d, status) {
            if(d.status == "OK") {
              $scope.profile.follow = "following";
              $scope.showFollowingLoading = false;
            }
          })
          .error(function(data, status) {
            $scope.showFollowingLoading = false;
          });
      }
      else if($scope.profile.follow == "following") {
        companyService.unfollow($scope.profile.company.id)
          .success(function(d) {
            if(d.status == "OK") {
              $scope.profile.follow = "follow";
              $scope.showFollowingLoading = false;
            }
          })
          .error(function(data, status) {
            $scope.showFollowingLoading = false;
          });
      }
    }
  };

  $scope.upload = function() {
    var selectedPdfTypeId = $scope.selectedPdfTypeId;
    var deckId = null;

    if(!$scope.showLoading['deck']) {
      if($scope.selectedPdf) {
        selectedPdfTypeId = $scope.selectedPdf.user_submitted_pdf_type_id;
        deckId = $scope.selectedPdf.id;
      }

      if($scope.files) {
        $scope.showLoading['deck'] = true;
        $scope.showSave['deck'] = false;

        companyService.uploadCompanyDeck($scope.companyId, deckId, selectedPdfTypeId, $scope.files)
          .success(function(d) {
            $("#company_file_input").val("");
            $scope.selectedPdf = d.pdf;
            $scope.profile.company_deck = d.pdfs;
            $scope.showLoading['deck'] = false;
            $scope.showSave['deck'] = true;
            location.reload();
          })
          .error(function(data, status) {
            $scope.showSave['deck'] = true;
            $scope.showLoading['deck'] = false;
            console.log(status);
          });
      }
    }
  };

  $scope.saveOverview = function(isValid) {
    var id = "overview";
    $scope.submitted = true;

    if(isValid && !$scope.showLoading[id]) {
      try {
        var parentCompanyIds = $.map($scope.parentSelector.tokenInput('get'), function(m) { return m.id; });
      }
      catch(err) {
        var parentCopmanyIds = [];
      }

      $scope.showLoading[id] = true;
      $scope.showSave[id] = false;

      companyService.updateOverview($scope.companyId, $scope.company, $scope.logo_image, parentCompanyIds)
        .success(function(data, status) {
          $scope.profile = data;
          $scope.submitted = false;
          $scope.showSave[id] = false;
          $scope.showPencil[id] = true;
          $scope.isEditing[id] = false;
          $scope.showLoading[id] = false;
        //  $scope.company = {};
          $scope.logo_image = null;

          if($scope.profile.structure) {
            $scope.htmlBindings['parentCompaniesHtml'] = $sce.trustAsHtml($scope.profile.structure.parent);
          }
        })
        .error(function(data, status) {
          $scope.showSave[id] = true;
          $scope.showLoading[id] = false;
        });
    }
  };

  $scope.enableGE = function() {
    var enable = $('#globalE').val() == "true" ? true : false;

    if(enable) {
      $scope.toggleGlobalEditor();
    }
  };

  $scope.saveProduct = function(id, isValid) {
    $scope.submitted = true;

    if(isValid && !$scope.showLoading[id]) {
      var params = generateParams(id);
      $scope.showLoading[id] = true;
      $scope.showSave[id] = false;

      companyService.updateProduct($scope.companyId, params, $scope.product_image)
        .success(function(data, status) {
          $scope.profile = data;
          $scope.submitted = false;
          $scope.showSave[id] = false;
          $scope.showPencil[id] = true;
          $scope.isEditing[id] = false;
          $scope.showLoading[id] = false;
          $scope.product_image = null;
          $('.product-copy').remove();
          $('.products-table tbody tr:not(.edit-row)').show();
          $scope.showUpdateEditor[id] = false;
        })
        .error(function(data, status) {
          $scope.showSave[id] = true;
          $scope.showLoading[id] = false;
        });
    }
  };

  function validateAutocompleteNonblank(tile, tokenId) {
    var borderId = "#token-input-add_" + tile + "_input";

    if(tokenId != null) {
      borderId = "#token-input-" + tokenId;
    }

    var count = $.map($scope[tile + "Selector"].tokenInput('get'), function(m) { return m.id; }).length;
    $(borderId).closest("ul")
      .css("border-color", "#ddd")
      .css("border-width", "1px");

    if(count == 0) {
      $(borderId).closest("ul")
        .css("border-color", "#ff671b")
        .css("border-width", "2px");
      return false;
    }

    return true;
  };

  function validateAutocomplete2(selector) {
    var borderId = "#token-input-" + selector.prop("id");

    var count = $.map(selector.tokenInput('get'), function(m) { return m.id; }).length;
    $(borderId).closest("ul")
      .css("border-color", "#ddd")
      .css("border-width", "1px");

    if(count < 1) {
      $(borderId).closest("ul")
        .css("border-color", "#ff671b")
        .css("border-width", "2px");
      return false;
    }

    return true;
  };

  $scope.save_and_disable_tag_editor = function(tag_editor_id, id, isValid) {
    var ed = $(tag_editor_id).next('.tag-editor');
    ed.find('input').autocomplete('disable');
    $scope.isEditing['tags'] = false;
    $scope.save(id, isValid);
  };

  $scope.openConfirmDeletePopup = function() {
    if(isAnyTeamOrBoardDeleted()) {
      $('#confirm_team_delete_modal').css('top', $(window).scrollTop() + 100);
      openPopup("#confirm_team_delete_modal");
    }
    else {
      $scope.save('team-full', $scope.boardForm.$valid && $scope.manageForm.$valid);
    }
  };

  $scope.confirmedDelete = function() {
    $('.close').trigger("click");
    $scope.save('team-full', $scope.boardForm.$valid && $scope.manageForm.$valid);
  };

  $scope.save = function(id, isValid) {
    $scope.submitted = true;

    if($scope.isEditing[id]) {
      if("relationship" == id) {
        if(relationshipSelector && !validateAutocomplete2(relationshipSelector)) {
          $scope[id + "Form"].$invalid = true;
          isValid = false;
        }
      }
      else if("customer" == id) {
        if(customerSelector && !validateAutocomplete2(customerSelector)) {
          $scope[id + "Form"].$invalid = true;
          isValid = false;
        }
      }
      else if("ma" == id) {
        if(maSelector && !validateAutocomplete2(maSelector)) {
          $scope[id + "Form"].$invalid = true;
          isValid = false;
        }
      }
    }
    else if(id == "looking-for") {
      if(!validateAutocompleteNonblank("corporateTags", "add_corporate_tags_input")) {
        $scope["editFlowForm"].$invalid = true;
        isValid = false;
      }
    }

    if(isValid && !$scope.showLoading[id]) {
      var params = {
        id : $scope.companyId,
        type : $('#company-content').attr('data-profile-type')
      };

      params['sections'] = {};
      
      params['sections'][id] = generateParams(id);

      $scope.showLoading[id] = true;
      $scope.showSave[id] = false;
      
	 $(".prog_part_button").prop("disabled", true);

      companyService.updateCompanyProfile(params, id)
        .success(function(data, status) {
          $scope.profile = data;
          $scope.submitted = false;
          $scope.showSave[id] = false;
          $scope.showPencil[id] = true;
          $scope.isEditing[id] = false;
          $scope.showLoading[id] = false;

          if(id == 'competitors') {
            $scope.competitorSelector.tokenInput('clear');
          }
          else if(id == 'team-full') {
            $scope.teamSelector.tokenInput('clear');
            $scope.boardmemberSelector.tokenInput("clear");
            $scope.showUpdateEditor['teammember'] = false;
            $scope.showUpdateEditor['boardmember'] = false;
            $('#edit-new-team, #edit-new-board').hide();
            $('.team-find-edit, .board-find-edit').show();
            $('.management-copy, .board-copy').remove();
            $scope.teammember = {};
            $scope.boardmember = {};
          }
          else if(id == "ma") {
            $('.ma-copy').remove();
            $('.ma-table tbody tr:not(.edit-row)').show();
            $scope.showUpdateEditor[id] = false;
          }
          else if(id == "investment") {
            $('.investment-copy').remove();
            $('.investments-table tbody tr:not(.edit-row)').show();
            $scope.showUpdateEditor[id] = false;
            $scope.showUpdateEditor['ipoHistory'] = false;
          }
          else if(id == "relationship") {
            $('.relationship-copy').remove();
            $('.relationships-table tbody tr:not(.edit-row)').show();
            $scope.showUpdateEditor[id] = false;
          }
          else if(id == "customer") {
            $('.customer-copy').remove();
            $('.customers-table tbody tr:not(.edit-row)').show();
            $scope.showUpdateEditor[id] = false;
          }
          else if(id == "note") {
            $scope.note = {};
            $scope.showUpdateEditor[id] = false;
          }
          else if(id == "git") {
            $scope.seeking_funding = {};
          }
          else if(id == "tags") {
          }
          else if(id == "investments-made") {
            $scope.investment = {};
          }
          else if(id == "looking-for") {
            $scope.company = {};
          }
          else if(id == "offer") {
            $scope.company = {};
          }
          else if(id == "campaign") {
            $scope.showUpdateEditor[id] = false;
          }

          if(firstValidPdf($scope.profile.company_deck) != null) {
            $('.products-tech-header a.selectBox').show();
          }
          else {
            $('.products-tech-header a.selectBox').hide();
          }

          $('.token-input-dropdown').hide();
          
          
		 $(".prog_part_button").prop("disabled", false);
		 
        })
        .error(function(data, status) {
          $scope.showSave[id] = true;
          $scope.showLoading[id] = false;
        });
    }
  };

  $scope.updatePatents = function() {
    var type = $scope.patentType;

    var params = { company_id: $scope.companyId,
      sort_by: $scope.patentOrderByField,
      direction: $scope.patentReverseSort,
      patents: {},
      type: type
    };

    $('#' + params.type + '-table .patent_visible').each(function(i,f) {
      var id = $(f).prop("id").split("__")[1];
      var value = $(f).prop("checked");
      params.patents[id] = value;
    });

    $scope.showLoading["patents"] = true;
    $scope.showSave["patents"] = false;

    companyService.updatePatents(params)
      .success(function(data, status) {
        $scope.profile.patent_data = data.data;
        $scope.hidePatents(data.type);
        $scope.showSave["patents"] = false;
        $scope.showPencil["patents"] = true;
        $scope.isEditing["patents"] = false;
        $scope.showLoading["patents"] = false;
      })
      .error(function(data, status) {
        $scope.showSave["patents"] = true;
        $scope.showLoading["patents"] = false;
      });
  };

  $scope.addIpo = function() {
    $scope.ipoHistory = {};
  };

  $scope.cancelEdit = function(id) {
    $scope.showSave[id] = false;
    $scope.submitted = false;
    $scope.showPencil[id] = true;
    $scope.isEditing[id] = false;

    if(id == 'overview' && !$scope.isEditing[id]) {
      $scope.logo_image = null;
      $scope.company = {};
    }
    else if(id == "ma") {
      $('.ma-copy').remove();
      $('.ma-table tbody tr:not(.edit-row)').show();
      $('#merge_direction').val(1);
    }
    else if(id == "competitors") {
      $('.competitor-list .pictures-250x100').show();
      $scope.competitorSelector.tokenInput('clear');
      $('.token-input-dropdown').hide();
    }
    else if(id == "team-full") {
      $('.teammember-item, .boardmember-item').show();
      $('.management-copy, .board-copy').remove();
      $scope.teammember = {};
      $scope.boardmember = {};
      $scope.teamSelector.tokenInput('clear');
      $('.token-input-dropdown').hide();
    }
    else if(id == "product") {
      $('.product-copy').remove();
      $('.products-table tbody tr:not(.edit-row)').show();
      $scope.product_image = null;
    }
    else if(id == "investment") {
      $('.investment-copy').remove();
      $('.investments-table tbody tr:not(.edit-row)').show();
      $scope.ipoHistory = angular.copy($scope.profile.ipo_history);
    }
    else if(id == "ipo_history") {
      $scope.ipoHistory = angular.copy($scope.profile.ipo_history);
    }
    else if(id == "relationship") {
      $('.relationship-copy').remove();
      $('.relationship-item').show();
      $scope.relationship = {};
      $scope.showUpdateEditor[id] = false;
      $('.token-input-dropdown').hide();
    }
    else if(id == "customer") {
      $scope.showUpdateEditor[id] = false;
      $('.customer-copy').remove();
      $('.customers-table tbody tr:not(.edit-row)').show();
    }
    else if(id == "note") {
      $('.note-item').show();
      $scope.note = {};
      $scope.showUpdateEditor[id] = false;
    }
    else if(id == "git") {
      $scope.seeking_funding = {};
      $('.seeking-funding').show();
    }
    else if(id == "tags") {
    }
    else if(id == "products_tech") {
      if(firstValidPdf($scope.profile.company_deck) != null) {
        $('.products-tech-header a.selectBox').show();
      }
      else {
        $('.products-tech-header a.selectBox').hide();
      }
    }
    else if(id == "campaign") {
      $scope.showUpdateEditor[id] = false;
    }
    else if(id == "looking-for") {
      $scope.company = {};
    }
    else if(id == "offer") {
      $scope.company = {};
    }
    else if(id == "traction") {
      $scope.traction = {};
    }
  };

  runAfterLoad();

}])
.directive('onFinishRender', function ($timeout) {
  return {
    restrict: 'A',
    link: function (scope, element, attr) {
      if (scope.$last === true) {
        $timeout(function () {
          scope.$emit('ngRepeatFinished');
        });
      }
    }
  }
});
//Add company

companyApp.controller('addCtrl', ["$scope", "$location", "$http", function($scope, $location, $http) {
  $scope.searchUrl = "/api/company/search.json";
  $scope.claimCompanyUrl = "/api/user_requests.json";
  $scope.keywords = $("#initialKeyword").val();
  $scope.claimOverlay = new OverlayModal("overlay-claim-content");

  $scope.claimCompany = function(event) {
    var target = event.target.className;
    event.preventDefault();
    event.stopPropagation();

    if(target.search("ctg-link") != -1 && target.search("claimed") == -1) {
      var elem = $(event.target).closest(".company-result");
      var companyId  = elem.attr("data-company-id");

      var params = {
        company_id : companyId,
        match : true
      };

      $('#company_' + companyId).html("Requesting...");

      $http({
        url: $scope.claimCompanyUrl,
        method: "POST",
        data: params,
        headers: {'Content-Type': 'application/json'}
      })
      .success(function (data, status, headers, config) {
        if(data.url == "") {
          $('#company_' + companyId).html("Claimed");
          $('#company_' + companyId).addClass("claimed");
          $scope.claimOverlay.toggle();
        }
        else {
          window.location.href = data.url;
        }
      })
      .error(function (data, status, headers, config) {
        $('#company_' + companyId).html("Claim this profile");
        alert(data.notice);
      });
    }
  };

  $scope.createCompany = function() {
    var params = {
      company: {
        name: $scope.keywords
      }
    };

    $http({
      url: "/api/company/create_company",
      method: "POST",
      data: params,
      headers: {'Content-Type': 'application/json'}
    })
    .success(function (data, status, headers, config) {
      if(status == 201) {
        window.location.href = data;
      }
    })
    .error(function (data, status, headers, config) {
      alert(data.name);
    });
  };

  $scope.searchInit = function() {
    if($scope.keywords != "") {
      $scope.search($scope.searchForm.$valid);
    }
  };

  function searchRequest(page) {
    $http({
      url: $scope.searchUrl,
      method: "POST",
      data: {
        'q' : $scope.keywords,
        'page' : page
      }
    })
    .success(function(data, status) {
      $scope.companies = data.companies;
      $scope.exact = data.exact;
      $scope.totalFound = data.total;

      if($scope.exact) {
        $scope.showPrimeResult = true;
        $scope.companies = [];
      }
      else if(data.total > 0) {
        $scope.exact = [];
        $scope.totalPages = Math.floor($scope.totalFound / 10) || 1;
        $scope.showSecondaryResults = true;
        $scope.showPagination = ($scope.totalPages == 1) ? false : true;
        $('.pagination-input').val(page || 1);
      }

      $scope.searchLoading = false;
      $scope.pageLoading = false;
    })
    .error(function(data, status) {
      $scope.companies = data.companies || [];
      $scope.exact = data.exact || [];
      $scope.searchLoading = false;
      $scope.hasErrors = true;
      $scope.errorMessage = "Sorry, an error has occured.";
      $scope.searchLoading = false;
      $scope.pageLoading = false;
    });
  };

  //called when user wants to do a search
  $scope.search = function(isValid) {
    $scope.submitted = true;

    if(isValid) {
      $scope.showPrimeResult = false;
      $scope.showSecondaryResults = false;
      $scope.searchLoading = true;
      $scope.hasErrors = false;

      searchRequest(0);
    }
  };

  $scope.updatePagination = function(position) {
    var page = $('#pagination-value-' + position).val();
    $('.pagination-input').val(page);
    $scope.pageLoading = true;
    searchRequest(page);
  };

  //for pagination
  $scope.previous = function(position) {
    var page = parseInt($('#pagination-value-' + position).val()) - 1;
    page = (page < 0 || isNaN(page)) ? 0 : page;
    $scope.pageLoading = true;
    searchRequest(page);
  };

  $scope.next = function(position) {
    var page = parseInt($('#pagination-value-' + position).val()) + 1;
    var max = $scope.totalPages;
    page = (page > max || isNaN(page)) ? max : page;
    $scope.pageLoading = true;
    searchRequest(page);
  };

  //called after ng-repeat is finished and truncates and adds ellipses on elements with lots of text.
  $scope.$on('ngRepeatFinished', function(ngRepeatFinishedEvent) {
    $('.company-description').dotdotdot({ellipsis: '...'});
  });
}])
.directive('onFinishRender', function ($timeout) {
  return {
    restrict: 'A',
    link: function (scope, element, attr) {
      if (scope.$last === true) {
        $timeout(function () {
          scope.$emit('ngRepeatFinished');
        });
      }
    }
  }
});

  companyApp.service("companyProfileInitData", function () {
  // profile data in json
  return {"message_url":null,"po_contact_bodies":{"Ellen Altenborg":"Dear USER_FIRST_NAME,\n\nI was browsing i3 and came across the profile of Saga Robotics.\n\nWould you be interested in connecting?\n\nBest,\n\nSENDER_FIRST_NAME SENDER_LAST_NAME\nSENDER_TITLE\nSENDER_COMPANY"},"row_counts":{"customers":0,"relationships":0,"news":0,"investments":2,"products":0,"ma":0},"patent_data":{"total":0,"uspto_patents":[],"uspto_count":0,"uspto_url":null,"uspto_published_patents":[],"uspto_published_count":0,"uspto_published_url":null,"espacenet_patents":[],"espacenet_count":0,"espacenet_patent_url":null},"alternate_names":"Thorvald","recommendations":[{"id":390785,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/85/390785/standard_logo_ageagle.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/85/390785/standard_logo_ageagle.png","name":"AgEagle","url":"/company/ageagle","completeness_score":72,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":19928,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/28/19928/standard_novariant.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/28/19928/standard_novariant.png","name":"Novariant","url":"/company/novariant","completeness_score":76,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":38,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/38/38/standard_TARGETEDGROWTH.jpg","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/38/38/standard_TARGETEDGROWTH.jpg","name":"Targeted Growth","url":"/company/targeted-growth","completeness_score":69,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":385988,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/88/385988/standard_ecoponix.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/88/385988/standard_ecoponix.png","name":"Ecoponex Systems","url":"/company/ecoponex-systems","completeness_score":76,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":84,"logo_image_url":"https://s3.amazonaws.com/prod.cleantech/8527.jpeg","logo_url":"https://s3.amazonaws.com/prod.cleantech/8527.jpeg","name":"Force-A","url":"/company/force-a","completeness_score":69,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":12491,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/91/12491/standard_enalta.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/91/12491/standard_enalta.png","name":"Enalta Inovacoes Tecnologicas","url":"/company/enalta-inovacoes-tecnologicas","completeness_score":69,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":395870,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/70/395870/standard_APSELogoWebsite.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/70/395870/standard_APSELogoWebsite.png","name":"Apse","url":"/company/apse","completeness_score":69,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":28,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/28/28/standard_Cibus-Logo.jpg","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/28/28/standard_Cibus-Logo.jpg","name":"Cibus","url":"/company/cibus-global","completeness_score":75,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":25,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/25/25/standard_header-logo.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/25/25/standard_header-logo.png","name":"Chromatin","url":"/company/chromatin","completeness_score":80,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":386154,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/54/386154/standard_Lumense.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/54/386154/standard_Lumense.png","name":"Lumense","url":"/company/lumense","completeness_score":77,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":9859,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/59/9859/standard_logo.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/59/9859/standard_logo.png","name":"Revolution Foods","url":"/company/revolution-foods","completeness_score":71,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":390625,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/25/390625/standard_Indigo_Logo.jpg","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/25/390625/standard_Indigo_Logo.jpg","name":"Indigo","url":"/company/indigo","completeness_score":77,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":390950,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/50/390950/standard_awhere.jpg","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/50/390950/standard_awhere.jpg","name":"aWhere","url":"/company/awhere","completeness_score":70,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":29177,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/77/29177/standard_mOasis.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/77/29177/standard_mOasis.png","name":"mOasis","url":"/company/moasis","completeness_score":69,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":12752,"logo_image_url":"https://s3.amazonaws.com/prod.cleantech/9233.jpeg","logo_url":"https://s3.amazonaws.com/prod.cleantech/9233.jpeg","name":"TreeMetrics","url":"/company/treemetrics","completeness_score":68,"primary_tag":"agriculture \u0026 food","jaccard":null},{"id":381389,"logo_image_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/89/381389/standard_Benson_Hill.png","logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/89/381389/standard_Benson_Hill.png","name":"Benson Hill","url":"/company/benson-hill","completeness_score":79,"primary_tag":"agriculture \u0026 food","jaccard":null}],"structure":{"parent_objs":[],"parent":"","child":"","subsidiary":""},"updated_by_info":{"first":"Updated by Cleantech Group on 08/17/2021"},"ipo_history":null,"edit_company_tags":[{"id":504,"name":"precision agriculture"},{"id":1783,"name":"robotics"}],"company_tags":[{"tag":"agriculture \u0026 food","slug":"agriculture-food","startup_count":3606},{"tag":"precision agriculture","slug":"precision-agriculture","startup_count":575},{"tag":"robotics","slug":"robotics","startup_count":569}],"industry_group":"agriculture \u0026 food","primary_tag":"agriculture \u0026 food","user_lists":[],"recent_user_lists":[],"acquired_message":"","seeking_funding":{"amount":null},"seeking_funding_message":"","company_editor_users":[],"notes":[],"notes_unstruct_q":[{"question_id":1,"question":"","answer":""}],"notes_struct_qcomp":[{"question_id":11,"question":"Interviewee first name","answer":""},{"question_id":12,"question":"Last name","answer":""},{"question_id":13,"question":"Title","answer":""},{"question_id":14,"question":"Email","answer":""},{"question_id":15,"question":"Opt in to Inside Cleantech? (enter lowercase y or n)","answer":""},{"question_id":16,"question":"Company (history, background, organization, revenues, investors, investment, raising capital?) ","answer":""},{"question_id":17,"question":"Business (technology or service, business model, challenges, customer/ clients)","answer":""},{"question_id":18,"question":"Market (trends, competitors, regulation, drivers, challenges)","answer":""}],"notes_struct_qinv":[{"question_id":11,"question":"Interviewee first name","answer":""},{"question_id":12,"question":"Last name","answer":""},{"question_id":13,"question":"Title","answer":""},{"question_id":14,"question":"Email","answer":""},{"question_id":15,"question":"Opt in to Inside Cleantech? (enter lowercase y or n)","answer":""},{"question_id":19,"question":"Fund (history, LPs, capital raised, team)","answer":""},{"question_id":20,"question":"Investments (where, why, how, type \u0026 size  – initial, follow on, portfolio of companies, why select these companies?)","answer":""},{"question_id":21,"question":"Market (trends, competitors to companies in portfolio, drivers, challenges)","answer":""}],"notes_struct_qcorp":[{"question_id":11,"question":"Interviewee first name","answer":""},{"question_id":12,"question":"Last name","answer":""},{"question_id":13,"question":"Title","answer":""},{"question_id":14,"question":"Email","answer":""},{"question_id":15,"question":"Opt in to Inside Cleantech? (enter lowercase y or n)","answer":""},{"question_id":22,"question":"Corporate (organization – CVC, strategy, sustainability, view on engaging innovation)","answer":""},{"question_id":23,"question":"Activities (where, why, how they engage innovation, portfolio companies, programs, challenges, pilots, participation in ESO’s)","answer":""},{"question_id":24,"question":"Market (trends, what competition is doing, drivers, challenges)","answer":""}],"notes_struct_qeso":[{"question_id":11,"question":"Interviewee first name","answer":""},{"question_id":12,"question":"Last name","answer":""},{"question_id":13,"question":"Title","answer":""},{"question_id":14,"question":"Email","answer":""},{"question_id":15,"question":"Opt in to Inside Cleantech? (enter lowercase y or n)","answer":""},{"question_id":25,"question":"Organization (mission, funding sources, organized )","answer":""},{"question_id":26,"question":"Activites (where, why, how they support innovation, portfolio companies, programs, challenges, pilots)","answer":""},{"question_id":27,"question":"Market (trends, drivers, challenges)","answer":""}],"company":{"id":412020,"name":"Saga Robotics","url":"/company/saga-robotics","logo_id":null,"short_description":"Developer of farm robots","website":"https://sagarobotics.com/","year_founded":2016,"telephone":null,"address":"Sagaveien 3","city":"As","state":"","zip":"","country_id":14964,"company_status_id":1,"num_employees":10,"ticker_symbol":"","overview":null,"products_description":null,"development_stage_id":2,"primary_tag":"agriculture \u0026 food","total_investment":11300000,"updated_at":"2021-08-17T03:42:05.000-07:00","investor_status_id":3,"assets":"","long_description":null,"investment_focus":null,"key_funds":null,"investor_type_id":0,"updated_by_user_id":18880,"company_logo":{"url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/20/412020/saga-robotics.png","standard":{"url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/20/412020/standard_saga-robotics.png"}},"logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/20/412020/standard_saga-robotics.png","profile_type_id":1,"hidden":false,"industry_type_id":1,"revenue_range_id":null,"snapshot":null,"offer":null,"industry_group":"agriculture \u0026 food","company_type":"Private","industry_type":"N/A","country":"Norway","investor_type_name":"Not an Investor","stage":"Product Development","primary_tag_id":1777,"industry_group_id":1777},"follow":"follow","team":[{"id":20871065,"person_id":338065,"title":"COO","date_joined":null,"date_departed":null,"person":{"id":338065,"first_name":"Ellen","last_name":"Altenborg","email":null,"linkedin_url":"http://www.linkedin.com/in/ellenaltenborg/?lipi=urn%3Ali%3Apage%3Ad_flagship3_search_srp_people%3BvdwSxd5cSoyar2IWfWZNBw%3D%3D\u0026licu=urn%3Ali%3Acontrol%3Ad_flagship3_search_srp_people-search_srp_result\u0026lici=pZOVXazJSqyPeKuwsKlX9Q%3D%3D"}}],"board_of_directors":[],"past_management":[],"past_board_of_directors":[],"ma":[],"primary_contact":{"id":20871065,"type":"CompanyManager","id_selected":"20871065__CompanyManager","name":"Ellen Altenborg","first_name":"Ellen","last_name":"Altenborg","title":"COO","linkedin_url":"http://www.linkedin.com/in/ellenaltenborg/?lipi=urn%3Ali%3Apage%3Ad_flagship3_search_srp_people%3BvdwSxd5cSoyar2IWfWZNBw%3D%3D\u0026licu=urn%3Ali%3Acontrol%3Ad_flagship3_search_srp_people-search_srp_result\u0026lici=pZOVXazJSqyPeKuwsKlX9Q%3D%3D","image_url":"/assets/newdesign/placeholders/user.png","email":null},"traction":{"customers":{"total":0,"confirmed":0},"partnerships":{"total":0,"confirmed":0},"financing":{"rounds":2,"investors":5},"capital":"$11.3M","num_employee_range":"1-10","num_employee_range_id":1,"employee_num_timestamp":"10/26/2018","revenue":null,"revenue_range_updated":"","revenue_range_id":null},"products":[],"company_deck":[null,null,null,null],"competitors":[],"customers":[],"taxonomy_tags":[{"name":"agriculture \u0026 food","url":"/tags/agriculture-food/1533/activity","description":"Technologies and services that make the production of food more efficient and effective","companies_count":3603,"id":1533,"tag_id":1777},{"name":"precision agriculture","url":"/tags/precision-agriculture/1535/activity","companies_count":585},{"name":"robotics","url":"/tags/robotics/1540/activity","companies_count":572}],"investor_tags":[],"options_for_primary_contacts":[{"id":"20871065__CompanyManager","name":"Ellen Altenborg","title":"COO","type":"CompanyManager"}],"relationships":[],"news":[],"investments":[{"id":54885,"company_id":412020,"investment_date":"2020-09-02","investment_type_id":2,"amount":11300000,"valuation":null,"notes":"Saga is leading a project called ‘Robot Highways’ from its office in Lincoln, where it’s aiming to perform what Innovate UK describes as “the largest known global demonstration of robotics and autonomous technologies on a farm.” ","source":"https://agfundernews.com/saga-robotics-raises-11m-to-develop-robo-strawberry-pickers.html","get_related_inc_accel_cid":-1,"investors":[{"id":403614,"name":"ADM Capital","url":"/investor/adm-capital","hidden":false},{"id":418329,"name":"Rabo Food \u0026 Agri Innovation Fund","url":"/investor/rabo-food-agri-innovation-fund","hidden":true},{"id":412177,"name":"Propagator Ventures","url":"/investor/propagator-ventures","hidden":true},{"id":413203,"name":"Nysno Climate Investments","url":"/investor/nysno","hidden":false}],"investment_type":{"name":"Series A"},"company":{"logo_url":null},"most_deal_logo_url":"https://s3.amazonaws.com/i3.cleantech/uploads/company/company_logo/14/403614/standard_ADM_capital.jfif"}],"investments_made":[],"investor_funds":[],"investor_investments_summary":null,"edit_options":{"investment_types":[{"id":8,"name":"Buyout / Late-Stage Private Equity"},{"id":22,"name":"Coin/Token Offering"},{"id":21,"name":"Follow-on Public Offering"},{"id":15,"name":"Grant"},{"id":14,"name":"Growth Equity"},{"id":19,"name":"Loan"},{"id":16,"name":"Loan Guarantee"},{"id":20,"name":"PIPE"},{"id":18,"name":"Project Finance"},{"id":1,"name":"Seed"},{"id":2,"name":"Series A"},{"id":3,"name":"Series B"},{"id":12,"name":"Structured Debt"}],"investor_types":[{"id":15,"name":"Accelerator / Incubator"},{"id":14,"name":"Angel Investor / Individual"},{"id":20,"name":"Angel Network"},{"id":6,"name":"Corporate Venture"},{"id":2,"name":"Corporation"},{"id":13,"name":"Crowdfunding"},{"id":11,"name":"Debt Funds"},{"id":18,"name":"Family Office / Foundation"},{"id":19,"name":"Investment Advisory Firm"},{"id":21,"name":"Investment Holding Company"},{"id":7,"name":"Investment/Merchant Banker"},{"id":5,"name":"Other"},{"id":23,"name":"Pension Fund"},{"id":3,"name":"Private Equity"},{"id":12,"name":"Public Sector"},{"id":17,"name":"Quasi-Governmental/Public-Private Partnership"},{"id":22,"name":"Specialty Finance"},{"id":16,"name":"University"},{"id":1,"name":"Venture Capital"}],"board_member_roles":[{"id":2,"name":"Board Advisor"},{"id":1,"name":"Board Member"},{"id":3,"name":"Board Observer"},{"id":7,"name":"Chairman of the Board"},{"id":6,"name":"Engineering Advisor"},{"id":5,"name":"Scientific Advisor"},{"id":4,"name":"Technical Advisor"}],"company_statuses":[{"id":6,"name":"Acquired"},{"id":8,"name":"Bankrupt"},{"id":9,"name":"Other"},{"id":7,"name":"Out of Business"},{"id":1,"name":"Private"},{"id":3,"name":"Public"}],"development_stages":[{"id":1,"name":"Concept"},{"id":2,"name":"Product Development"},{"id":3,"name":"Shipping Product/Pilot"},{"id":4,"name":"Wide Commercial Availability"}],"product_statuses":[{"id":1,"name":"Concept"},{"id":3,"name":"Pilot/Early Revenue"},{"id":2,"name":"Product Development"},{"id":4,"name":"Wide Commercial Availability"}],"states":[{"id":1,"country_id":15026,"abbrev":"AL","name":"Alabama"},{"id":2,"country_id":15026,"abbrev":"AK","name":"Alaska"},{"id":52,"country_id":14843,"abbrev":"AB","name":"Alberta"},{"id":3,"country_id":15026,"abbrev":"AZ","name":"Arizona"},{"id":4,"country_id":15026,"abbrev":"AR","name":"Arkansas"},{"id":53,"country_id":14843,"abbrev":"BC","name":"British Colombia"},{"id":5,"country_id":15026,"abbrev":"CA","name":"California"},{"id":6,"country_id":15026,"abbrev":"CO","name":"Colorado"},{"id":7,"country_id":15026,"abbrev":"CT","name":"Connecticut"},{"id":8,"country_id":15026,"abbrev":"DE","name":"Delaware"},{"id":10,"country_id":15026,"abbrev":"FL","name":"Florida"},{"id":11,"country_id":15026,"abbrev":"GA","name":"Georgia"},{"id":12,"country_id":15026,"abbrev":"HI","name":"Hawaii"},{"id":13,"country_id":15026,"abbrev":"ID","name":"Idaho"},{"id":14,"country_id":15026,"abbrev":"IL","name":"Illinois"},{"id":15,"country_id":15026,"abbrev":"IN","name":"Indiana"},{"id":16,"country_id":15026,"abbrev":"IA","name":"Iowa"},{"id":17,"country_id":15026,"abbrev":"KS","name":"Kansas"},{"id":18,"country_id":15026,"abbrev":"KY","name":"Kentucky"},{"id":19,"country_id":15026,"abbrev":"LA","name":"Louisiana"},{"id":20,"country_id":15026,"abbrev":"ME","name":"Maine"},{"id":54,"country_id":14843,"abbrev":"MB","name":"Manitoba"},{"id":21,"country_id":15026,"abbrev":"MD","name":"Maryland"},{"id":22,"country_id":15026,"abbrev":"MA","name":"Massachusetts"},{"id":23,"country_id":15026,"abbrev":"MI","name":"Michigan"},{"id":24,"country_id":15026,"abbrev":"MN","name":"Minnesota"},{"id":25,"country_id":15026,"abbrev":"MS","name":"Mississippi"},{"id":26,"country_id":15026,"abbrev":"MO","name":"Missouri"},{"id":27,"country_id":15026,"abbrev":"MT","name":"Montana"},{"id":28,"country_id":15026,"abbrev":"NE","name":"Nebraska"},{"id":29,"country_id":15026,"abbrev":"NV","name":"Nevada"},{"id":55,"country_id":14843,"abbrev":"NB","name":"New Brunswick"},{"id":30,"country_id":15026,"abbrev":"NH","name":"New Hampshire"},{"id":31,"country_id":15026,"abbrev":"NJ","name":"New Jersey"},{"id":32,"country_id":15026,"abbrev":"NM","name":"New Mexico"},{"id":33,"country_id":15026,"abbrev":"NY","name":"New York"},{"id":56,"country_id":14843,"abbrev":"NL","name":"Newfoundland and Labrador"},{"id":34,"country_id":15026,"abbrev":"NC","name":"North Carolina"},{"id":35,"country_id":15026,"abbrev":"ND","name":"North Dakota"},{"id":62,"country_id":14843,"abbrev":"NT","name":"Northwest Territories"},{"id":57,"country_id":14843,"abbrev":"NS","name":"Nova Scotia"},{"id":63,"country_id":14843,"abbrev":"NU","name":"Nunavut"},{"id":36,"country_id":15026,"abbrev":"OH","name":"Ohio"},{"id":37,"country_id":15026,"abbrev":"OK","name":"Oklahoma"},{"id":58,"country_id":14843,"abbrev":"ON","name":"Ontario"},{"id":38,"country_id":15026,"abbrev":"OR","name":"Oregon"},{"id":39,"country_id":15026,"abbrev":"PA","name":"Pennsylvania"},{"id":59,"country_id":14843,"abbrev":"PE","name":"Prince Edward Island"},{"id":60,"country_id":14843,"abbrev":"QC","name":"Quebec"},{"id":40,"country_id":15026,"abbrev":"RI","name":"Rhode Island"},{"id":61,"country_id":14843,"abbrev":"SK","name":"Saskatchewan"},{"id":41,"country_id":15026,"abbrev":"SC","name":"South Carolina"},{"id":42,"country_id":15026,"abbrev":"SD","name":"South Dakota"},{"id":43,"country_id":15026,"abbrev":"TN","name":"Tennessee"},{"id":44,"country_id":15026,"abbrev":"TX","name":"Texas"},{"id":45,"country_id":15026,"abbrev":"UT","name":"Utah"},{"id":46,"country_id":15026,"abbrev":"VT","name":"Vermont"},{"id":47,"country_id":15026,"abbrev":"VA","name":"Virginia"},{"id":48,"country_id":15026,"abbrev":"WA","name":"Washington"},{"id":9,"country_id":15026,"abbrev":"DC","name":"Washington DC"},{"id":49,"country_id":15026,"abbrev":"WV","name":"West Virginia"},{"id":50,"country_id":15026,"abbrev":"WI","name":"Wisconsin"},{"id":51,"country_id":15026,"abbrev":"WY","name":"Wyoming"},{"id":64,"country_id":14843,"abbrev":"YT","name":"Yukon"}],"countries":[{"id":14806,"abbrev":"AF","name":"Afghanistan","region_id":2},{"id":14807,"abbrev":"AL","name":"Albania","region_id":4},{"id":14808,"abbrev":"DZ","name":"Algeria","region_id":1},{"id":14809,"abbrev":"AS","name":"American Samoa","region_id":2},{"id":14810,"abbrev":"AD","name":"Andorra","region_id":4},{"id":14811,"abbrev":"AO","name":"Angola","region_id":1},{"id":14812,"abbrev":"AI","name":"Anguilla","region_id":3},{"id":14813,"abbrev":"AQ","name":"Antarctica","region_id":3},{"id":14814,"abbrev":"AG","name":"Antigua And Barbuda","region_id":3},{"id":14815,"abbrev":"AR","name":"Argentina","region_id":3},{"id":14816,"abbrev":"AM","name":"Armenia","region_id":4},{"id":14817,"abbrev":"AW","name":"Aruba","region_id":3},{"id":14818,"abbrev":"AU","name":"Australia","region_id":2},{"id":14819,"abbrev":"AT","name":"Austria","region_id":4},{"id":14820,"abbrev":"AZ","name":"Azerbaijan","region_id":5},{"id":14821,"abbrev":"BS","name":"Bahamas","region_id":3},{"id":14822,"abbrev":"BH","name":"Bahrain","region_id":5},{"id":14823,"abbrev":"BD","name":"Bangladesh","region_id":2},{"id":14824,"abbrev":"BB","name":"Barbados","region_id":3},{"id":14825,"abbrev":"BY","name":"Belarus","region_id":4},{"id":14826,"abbrev":"BE","name":"Belgium","region_id":4},{"id":14827,"abbrev":"BZ","name":"Belize","region_id":3},{"id":14828,"abbrev":"BJ","name":"Benin","region_id":1},{"id":14829,"abbrev":"BM","name":"Bermuda","region_id":3},{"id":14830,"abbrev":"BT","name":"Bhutan","region_id":2},{"id":14831,"abbrev":"BO","name":"Bolivia","region_id":3},{"id":14832,"abbrev":"BA","name":"Bosnia And Herzegovina","region_id":4},{"id":14833,"abbrev":"BW","name":"Botswana","region_id":1},{"id":14834,"abbrev":"BV","name":"Bouvet Island","region_id":1},{"id":14835,"abbrev":"BR","name":"Brazil","region_id":3},{"id":14836,"abbrev":"IO","name":"British Indian Ocean Territory","region_id":2},{"id":15033,"abbrev":"VG","name":"British Virgin Islands","region_id":3},{"id":14837,"abbrev":"BN","name":"Brunei","region_id":2},{"id":14838,"abbrev":"BG","name":"Bulgaria","region_id":4},{"id":14839,"abbrev":"BF","name":"Burkina Faso","region_id":1},{"id":14840,"abbrev":"BI","name":"Burundi","region_id":1},{"id":14841,"abbrev":"KH","name":"Cambodia","region_id":2},{"id":14842,"abbrev":"CM","name":"Cameroon","region_id":1},{"id":14843,"abbrev":"CA","name":"Canada","region_id":6},{"id":14844,"abbrev":"CV","name":"Cape Verde","region_id":1},{"id":14845,"abbrev":"KY","name":"Cayman Islands","region_id":3},{"id":14846,"abbrev":"CF","name":"Central African Republic","region_id":1},{"id":14847,"abbrev":"TD","name":"Chad","region_id":1},{"id":14848,"abbrev":"CL","name":"Chile","region_id":3},{"id":14849,"abbrev":"CN","name":"China","region_id":2},{"id":14850,"abbrev":"CX","name":"Christmas Island","region_id":2},{"id":14851,"abbrev":"CC","name":"Cocos (Keeling) Islands","region_id":2},{"id":14852,"abbrev":"CO","name":"Colombia","region_id":3},{"id":14853,"abbrev":"KM","name":"Comoros","region_id":1},{"id":14854,"abbrev":"CG","name":"Congo","region_id":1},{"id":14855,"abbrev":"CK","name":"Cook Islands","region_id":2},{"id":14856,"abbrev":"CR","name":"Costa Rica","region_id":3},{"id":14857,"abbrev":"CI","name":"Cote D'Ivorie (Ivory Coast)","region_id":1},{"id":14858,"abbrev":"HR","name":"Croatia (Hrvatska)","region_id":4},{"id":14859,"abbrev":"CU","name":"Cuba","region_id":3},{"id":14860,"abbrev":"CY","name":"Cyprus","region_id":4},{"id":14861,"abbrev":"CZ","name":"Czech Republic","region_id":4},{"id":14862,"abbrev":"DK","name":"Denmark","region_id":4},{"id":14863,"abbrev":"DJ","name":"Djibouti","region_id":1},{"id":14864,"abbrev":"DM","name":"Dominica","region_id":3},{"id":14865,"abbrev":"DO","name":"Dominican Republic","region_id":3},{"id":14866,"abbrev":"TP","name":"East Timor","region_id":2},{"id":14867,"abbrev":"EC","name":"Ecuador","region_id":3},{"id":14868,"abbrev":"EG","name":"Egypt","region_id":1},{"id":14869,"abbrev":"SV","name":"El Salvador","region_id":3},{"id":14870,"abbrev":"GQ","name":"Equatorial Guinea","region_id":1},{"id":14871,"abbrev":"ER","name":"Eritrea","region_id":1},{"id":14872,"abbrev":"EE","name":"Estonia","region_id":4},{"id":14873,"abbrev":"ET","name":"Ethiopia","region_id":1},{"id":14874,"abbrev":"FK","name":"Falkland Islands (Malvinas)","region_id":3},{"id":14875,"abbrev":"FO","name":"Faroe Islands","region_id":4},{"id":14942,"abbrev":"FM","name":"Federated States of Micronesia","region_id":2},{"id":14876,"abbrev":"FJ","name":"Fiji","region_id":2},{"id":14877,"abbrev":"FI","name":"Finland","region_id":4},{"id":14878,"abbrev":"FR","name":"France","region_id":4},{"id":14879,"abbrev":"FX","name":"France, Metropolitan","region_id":4},{"id":14880,"abbrev":"GF","name":"French Guinea","region_id":3},{"id":14881,"abbrev":"PF","name":"French Polynesia","region_id":2},{"id":14882,"abbrev":"TF","name":"French Southern Territories","region_id":2},{"id":14883,"abbrev":"GA","name":"Gabon","region_id":1},{"id":14884,"abbrev":"GM","name":"Gambia","region_id":1},{"id":14885,"abbrev":"GE","name":"Georgia","region_id":4},{"id":14886,"abbrev":"DE","name":"Germany","region_id":4},{"id":14887,"abbrev":"GH","name":"Ghana","region_id":1},{"id":14888,"abbrev":"GI","name":"Gibraltar","region_id":4},{"id":14889,"abbrev":"GR","name":"Greece","region_id":4},{"id":14890,"abbrev":"GL","name":"Greenland","region_id":4},{"id":14891,"abbrev":"GD","name":"Grenada","region_id":3},{"id":14892,"abbrev":"GP","name":"Guadeloupe","region_id":3},{"id":14893,"abbrev":"GU","name":"Guam","region_id":2},{"id":14894,"abbrev":"GT","name":"Guatemala","region_id":3},{"id":14895,"abbrev":"GN","name":"Guinea","region_id":1},{"id":14896,"abbrev":"GW","name":"Guinea-Bissau","region_id":1},{"id":14897,"abbrev":"GY","name":"Guyana","region_id":3},{"id":14898,"abbrev":"HT","name":"Haiti","region_id":3},{"id":14899,"abbrev":"HM","name":"Heard And McDonald Islands","region_id":2},{"id":14900,"abbrev":"HN","name":"Honduras","region_id":3},{"id":14901,"abbrev":"HK","name":"Hong Kong","region_id":2},{"id":14902,"abbrev":"HU","name":"Hungary","region_id":4},{"id":14903,"abbrev":"IS","name":"Iceland","region_id":4},{"id":14904,"abbrev":"IN","name":"India","region_id":2},{"id":14905,"abbrev":"ID","name":"Indonesia","region_id":2},{"id":14906,"abbrev":"IR","name":"Iran","region_id":5},{"id":14907,"abbrev":"IQ","name":"Iraq","region_id":5},{"id":14908,"abbrev":"IE","name":"Ireland","region_id":4},{"id":14909,"abbrev":"IL","name":"Israel","region_id":4},{"id":14910,"abbrev":"IT","name":"Italy","region_id":4},{"id":14911,"abbrev":"JM","name":"Jamaica","region_id":3},{"id":14912,"abbrev":"JP","name":"Japan","region_id":2},{"id":14913,"abbrev":"JO","name":"Jordan","region_id":5},{"id":14914,"abbrev":"KZ","name":"Kazakhstan","region_id":2},{"id":14915,"abbrev":"KE","name":"Kenya","region_id":1},{"id":14916,"abbrev":"KI","name":"Kiribati","region_id":2},{"id":14999,"abbrev":"KR","name":"Korea Republic","region_id":2},{"id":14917,"abbrev":"KW","name":"Kuwait","region_id":5},{"id":14918,"abbrev":"KG","name":"Kyrgyzstan","region_id":2},{"id":14919,"abbrev":"LA","name":"Laos","region_id":2},{"id":14920,"abbrev":"LV","name":"Latvia","region_id":4},{"id":14921,"abbrev":"LB","name":"Lebanon","region_id":5},{"id":14922,"abbrev":"LS","name":"Lesotho","region_id":1},{"id":14923,"abbrev":"LR","name":"Liberia","region_id":1},{"id":14924,"abbrev":"LY","name":"Libya","region_id":1},{"id":14925,"abbrev":"LI","name":"Liechtenstein","region_id":4},{"id":14926,"abbrev":"LT","name":"Lithuania","region_id":4},{"id":14927,"abbrev":"LU","name":"Luxembourg","region_id":4},{"id":14928,"abbrev":"MO","name":"Macau","region_id":2},{"id":14929,"abbrev":"MK","name":"Macedonia","region_id":4},{"id":14930,"abbrev":"MG","name":"Madagascar","region_id":1},{"id":14931,"abbrev":"MW","name":"Malawi","region_id":1},{"id":14932,"abbrev":"MY","name":"Malaysia","region_id":2},{"id":14933,"abbrev":"MV","name":"Maldives","region_id":2},{"id":14934,"abbrev":"ML","name":"Mali","region_id":1},{"id":14935,"abbrev":"MT","name":"Malta","region_id":4},{"id":14936,"abbrev":"MH","name":"Marshall Islands","region_id":2},{"id":14937,"abbrev":"MQ","name":"Martinique","region_id":3},{"id":14938,"abbrev":"MR","name":"Mauritania","region_id":1},{"id":14939,"abbrev":"MU","name":"Mauritius","region_id":1},{"id":14940,"abbrev":"YT","name":"Mayotte","region_id":1},{"id":14941,"abbrev":"MX","name":"Mexico","region_id":3},{"id":14943,"abbrev":"MD","name":"Moldova","region_id":4},{"id":14944,"abbrev":"MC","name":"Monaco","region_id":4},{"id":14945,"abbrev":"MN","name":"Mongolia","region_id":2},{"id":14946,"abbrev":"MS","name":"Montserrat","region_id":4},{"id":14947,"abbrev":"MA","name":"Morocco","region_id":1},{"id":14948,"abbrev":"MZ","name":"Mozambique","region_id":1},{"id":14949,"abbrev":"MM","name":"Myanmar (Burma)","region_id":2},{"id":14950,"abbrev":"NA","name":"Namibia","region_id":1},{"id":14951,"abbrev":"NR","name":"Nauru","region_id":2},{"id":14952,"abbrev":"NP","name":"Nepal","region_id":2},{"id":14953,"abbrev":"NL","name":"Netherlands","region_id":4},{"id":14954,"abbrev":"AN","name":"Netherlands Antilles","region_id":3},{"id":14955,"abbrev":"NC","name":"New Caledonia","region_id":2},{"id":14956,"abbrev":"NZ","name":"New Zealand","region_id":2},{"id":14957,"abbrev":"NI","name":"Nicaragua","region_id":3},{"id":14958,"abbrev":"NE","name":"Niger","region_id":1},{"id":14959,"abbrev":"NG","name":"Nigeria","region_id":1},{"id":14960,"abbrev":"NU","name":"Niue","region_id":2},{"id":14961,"abbrev":"NF","name":"Norfolk Island","region_id":2},{"id":14962,"abbrev":"KP","name":"North Korea","region_id":2},{"id":14963,"abbrev":"MP","name":"Northern Mariana Islands","region_id":2},{"id":14964,"abbrev":"NO","name":"Norway","region_id":4},{"id":14965,"abbrev":"OM","name":"Oman","region_id":5},{"id":14966,"abbrev":"PK","name":"Pakistan","region_id":2},{"id":14967,"abbrev":"PW","name":"Palau","region_id":2},{"id":14968,"abbrev":"PA","name":"Panama","region_id":3},{"id":14969,"abbrev":"PG","name":"Papua New Guinea","region_id":2},{"id":14970,"abbrev":"PY","name":"Paraguay","region_id":3},{"id":14971,"abbrev":"PE","name":"Peru","region_id":3},{"id":14972,"abbrev":"PH","name":"Philippines","region_id":2},{"id":14973,"abbrev":"PN","name":"Pitcairn","region_id":2},{"id":14974,"abbrev":"PL","name":"Poland","region_id":4},{"id":14975,"abbrev":"PT","name":"Portugal","region_id":4},{"id":14976,"abbrev":"PR","name":"Puerto Rico","region_id":6},{"id":14977,"abbrev":"QA","name":"Qatar","region_id":5},{"id":14978,"abbrev":"RE","name":"Reunion","region_id":1},{"id":14979,"abbrev":"RO","name":"Romania","region_id":4},{"id":14980,"abbrev":"RU","name":"Russia","region_id":4},{"id":14981,"abbrev":"RW","name":"Rwanda","region_id":1},{"id":14982,"abbrev":"SH","name":"Saint Helena","region_id":1},{"id":14983,"abbrev":"KN","name":"Saint Kitts And Nevis","region_id":3},{"id":14984,"abbrev":"LC","name":"Saint Lucia","region_id":3},{"id":14985,"abbrev":"PM","name":"Saint Pierre And Miquelon","region_id":6},{"id":14986,"abbrev":"SM","name":"San Marino","region_id":4},{"id":14987,"abbrev":"ST","name":"Sao Tome And Principe","region_id":1},{"id":14988,"abbrev":"SA","name":"Saudi Arabia","region_id":5},{"id":14989,"abbrev":"SN","name":"Senegal","region_id":1},{"id":14990,"abbrev":"RS","name":"Serbia","region_id":4},{"id":14991,"abbrev":"SC","name":"Seychelles","region_id":1},{"id":14992,"abbrev":"SL","name":"Sierra Leone","region_id":1},{"id":14993,"abbrev":"SG","name":"Singapore","region_id":2},{"id":14994,"abbrev":"SK","name":"Slovakia","region_id":4},{"id":14995,"abbrev":"SI","name":"Slovenia","region_id":4},{"id":14996,"abbrev":"SB","name":"Solomon Islands","region_id":2},{"id":14997,"abbrev":"SO","name":"Somalia","region_id":1},{"id":14998,"abbrev":"ZA","name":"South Africa","region_id":1},{"id":15000,"abbrev":"ES","name":"Spain","region_id":4},{"id":15001,"abbrev":"LK","name":"Sri Lanka","region_id":2},{"id":15002,"abbrev":"SD","name":"Sudan","region_id":1},{"id":15003,"abbrev":"SR","name":"Suriname","region_id":3},{"id":15004,"abbrev":"SJ","name":"Svalbard And Jan Mayen","region_id":4},{"id":15005,"abbrev":"SZ","name":"Swaziland","region_id":1},{"id":15006,"abbrev":"SE","name":"Sweden","region_id":4},{"id":15007,"abbrev":"CH","name":"Switzerland","region_id":4},{"id":15008,"abbrev":"SY","name":"Syria","region_id":5},{"id":15009,"abbrev":"TW","name":"Taiwan","region_id":2},{"id":15010,"abbrev":"TJ","name":"Tajikistan","region_id":2},{"id":15011,"abbrev":"TZ","name":"Tanzania","region_id":1},{"id":15012,"abbrev":"TH","name":"Thailand","region_id":2},{"id":15013,"abbrev":"TG","name":"Togo","region_id":1},{"id":15014,"abbrev":"TK","name":"Tokelau","region_id":2},{"id":15015,"abbrev":"TO","name":"Tonga","region_id":2},{"id":15016,"abbrev":"TT","name":"Trinidad And Tobago","region_id":3},{"id":15017,"abbrev":"TN","name":"Tunisia","region_id":1},{"id":15018,"abbrev":"TR","name":"Turkey","region_id":5},{"id":15019,"abbrev":"TM","name":"Turkmenistan","region_id":2},{"id":15020,"abbrev":"TC","name":"Turks And Caicos Islands","region_id":3},{"id":15021,"abbrev":"TV","name":"Tuvalu","region_id":2},{"id":15022,"abbrev":"UG","name":"Uganda","region_id":1},{"id":15023,"abbrev":"UA","name":"Ukraine","region_id":4},{"id":15024,"abbrev":"AE","name":"United Arab Emirates","region_id":5},{"id":15025,"abbrev":"UK","name":"United Kingdom","region_id":4},{"id":15026,"abbrev":"US","name":"United States","region_id":6},{"id":15027,"abbrev":"UY","name":"Uruguay","region_id":3},{"id":15028,"abbrev":"UZ","name":"Uzbekistan","region_id":2},{"id":15029,"abbrev":"VU","name":"Vanuatu","region_id":2},{"id":15030,"abbrev":"VA","name":"Vatican City (Holy See)","region_id":4},{"id":15031,"abbrev":"VE","name":"Venezuela","region_id":3},{"id":15032,"abbrev":"VN","name":"Vietnam","region_id":2},{"id":15034,"abbrev":"VI","name":"Virgin Islands (US)","region_id":6},{"id":15035,"abbrev":"WF","name":"Wallis And Futuna Islands","region_id":2},{"id":15036,"abbrev":"EH","name":"Western Sahara","region_id":1},{"id":15037,"abbrev":"WS","name":"Western Samoa","region_id":2},{"id":15038,"abbrev":"YE","name":"Yemen","region_id":5},{"id":15039,"abbrev":"ZM","name":"Zambia","region_id":1},{"id":15040,"abbrev":"ZW","name":"Zimbabwe","region_id":1}],"revenue_ranges":[{"id":1,"name":"Pre-revenue"},{"id":2,"name":"$0 - $500k"},{"id":3,"name":"$500k - $2m"},{"id":4,"name":"$2m - $5m"},{"id":5,"name":"$5m - $10m"},{"id":6,"name":"$10m - $25m"},{"id":7,"name":"$25m - $100m"},{"id":8,"name":"$100m or more"}],"num_employee_ranges":[{"id":1,"name":"1-10"},{"id":2,"name":"11-50"},{"id":3,"name":"51-100"},{"id":4,"name":"101-250"},{"id":5,"name":"250+"}],"industry_groups":[{"id":1777,"tag_id":1777,"name":"agriculture \u0026 food"},{"id":2334,"tag_id":2334,"name":"energy \u0026 power"},{"id":2335,"tag_id":2335,"name":"materials \u0026 chemicals"},{"id":2337,"tag_id":2337,"name":"resources \u0026 environment"},{"id":2338,"tag_id":2338,"name":"transportation \u0026 logistics"},{"id":2336,"tag_id":2336,"name":"enabling technologies"}],"tags":[{"id":751,"tag_id":751,"name":"advanced materials"},{"id":1777,"tag_id":1777,"name":"agriculture \u0026 food"},{"id":752,"tag_id":752,"name":"air"},{"id":753,"tag_id":753,"name":"biofuels \u0026 biochemicals"},{"id":754,"tag_id":754,"name":"biomass generation"},{"id":822,"tag_id":822,"name":"conventional fuels"},{"id":4,"tag_id":4,"name":"energy efficiency"},{"id":5,"tag_id":5,"name":"energy storage"},{"id":1115,"tag_id":1115,"name":"fuel cells \u0026 hydrogen"},{"id":275,"tag_id":275,"name":"geothermal"},{"id":881,"tag_id":881,"name":"hydro \u0026 marine power"},{"id":423,"tag_id":423,"name":"nuclear"},{"id":1575,"tag_id":1575,"name":"other cleantech"},{"id":8,"tag_id":8,"name":"recycling \u0026 waste"},{"id":9,"tag_id":9,"name":"smart grid"},{"id":10,"tag_id":10,"name":"solar"},{"id":11,"tag_id":11,"name":"transportation"},{"id":12,"tag_id":12,"name":"water \u0026 wastewater"},{"id":13,"tag_id":13,"name":"wind"}],"ind_grp_tags":[{"id":1777,"tag_id":1777,"name":"agriculture \u0026 food"},{"id":2334,"tag_id":2334,"name":"energy \u0026 power"},{"id":2335,"tag_id":2335,"name":"materials \u0026 chemicals"},{"id":2337,"tag_id":2337,"name":"resources \u0026 environment"},{"id":2338,"tag_id":2338,"name":"transportation \u0026 logistics"},{"id":2336,"tag_id":2336,"name":"enabling technologies"}],"revenues":[{"id":8,"name":"License of Usage"},{"id":1,"name":"Products - Retail"},{"id":2,"name":"Products - Wholesale"},{"id":7,"name":"Rental"},{"id":3,"name":"Service - Fixed Price"},{"id":4,"name":"Service - Per Unit"},{"id":5,"name":"Subscription"},{"id":6,"name":"Usage Fees"}],"relationship_types":[{"id":4,"name":"Channel Partner"},{"id":1,"name":"Customer"},{"id":7,"name":"Development Partner"},{"id":10,"name":"Incubation/Acceleration"},{"id":6,"name":"Joint Venture"},{"id":2,"name":"Licensee"},{"id":9,"name":"Licensor"},{"id":5,"name":"Project Development"},{"id":3,"name":"Technology Partner"},{"id":8,"name":"Vendor"}],"customer_relationship_types":[{"id":1,"name":"Customer"}],"partnership_relationship_types":[{"id":4,"name":"Channel Partner"},{"id":7,"name":"Development Partner"},{"id":10,"name":"Incubation/Acceleration"},{"id":6,"name":"Joint Venture"},{"id":2,"name":"Licensee"},{"id":9,"name":"Licensor"},{"id":5,"name":"Project Development"},{"id":3,"name":"Technology Partner"},{"id":8,"name":"Vendor"}],"ipo_statuses":[{"id":1,"name":"Filed"},{"id":2,"name":"Listed"},{"id":3,"name":"Speculated"},{"id":6,"name":"Withdrawn"}],"ipo_types":[{"id":1,"name":"IPO"},{"id":2,"name":"SPAC"}]}};
});
</script>

<input type="hidden" id="globalE" value=false />
<input type="hidden" id="user_name" value="" />
<input type="hidden" id="company_name" value="" />

<div class="ctg-overlay"></div>
<!-- End Overlay -->

  <div class="popup-window" id="share_list_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="shareProfileForm" novalidate>
  <div class="popup-window-content">
    <h3>Share this profile</h3>

    <div class="share-body">
      <div class="share-top">
       <input
        ng-model="shareProfile.emails"
        ng-class="{'has-error': shareProfileForm.emails.$invalid && submitted}"
        name="emails"
        type="text"
        class="modal-text"
        placeholder="To:"
        id="to_share_emails"
        required /><br/>
       <span class="font-size-11">You can enter multiple email addresses by separating them with a comma (,)</span>
       <br/>
       </div>

       <textarea
        ng-class="{'has-error': shareProfileForm.custom_text.$invalid && submitted}"
        name="custom_text"
        id="custom_text"
        class="width-100 height-215px modal-text">
Hi there,

I was browsing i3 and came across the profile of {{profile.company.name}}

To access it, click on the button below!

Best,

       </textarea>
    </div>

    <div class="error-message" style="font-size:14px;margin-bottom:10px;">{{messages['shareProfile']}}</div>
    <div class="popup-window-actions">
      <a href="#" ng-click="shareProfile(shareProfileForm.$valid)">
        <span ng-hide="isModalSaving['shareProfile']" >Share</span>
        <img ng-show="isModalSaving['shareProfile']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $("#share_button").on('click', function(event) {
      openPopup("#share_list_modal");
    });
  });
</script>

  <style>
  div.token-input-dropdown {
    z-index: 3000;
    width: 200px;
  }
  ul.token-input-list {
    width: 200px;
  }
  li.token-input-token {
    width: 175px;
  }
  h3,
  .comp-search1,
  .comp-search2,
  .comp-search3 {
    display: inline-block;
  }
  .comp-search-wrapper {
    float:right;
  }
  .compare-input {
    width: 100%;
  }
  #compare_company_input {
    outline: none;
    font-size: 14px;
    font-style: italic;
    padding: 7px;
    margin: 5px 6px;
    font-family: Verdana; 
    font-weight: 400; 
    letter-spacing: 0px; 
    white-space: nowrap;
  }
  table#compare-table {
    width: 100%;
    margin: 25px 0 40px 0;
  }
  
  table#compare-table tr:nth-child(even) {
    background-color: #dcdcdc;
  }
  table#compare-table th, table#compare-table td {
    width:20%;
    border-top: solid #dcdcdc .5px;
    border-bottom: solid #dcdcdc .5px;
    font-size: 14px;
    padding: 25px 15px;
    font-family: Verdana; 
    font-weight: 500; 
    vertical-align: middle;
  }
  table#compare-table th {
    text-align: left;
  }
  table#compare-table td {
    text-align: center;
  }
  .compare-logo-a,
  .compare-logo {
    margin: 0;
    width: 160px;
  }
  .compare-thumb {
    height: 104px;
    width: 160px;
    position: relative;
  }
  .compare-thumb a,
  .compare-thumb img {
    display: inline-block;
    max-height: 100%;
    max-width: 100%;
    bottom: 0;
    left: 0;
    margin: auto;
    position: absolute;
    right: 0;
    top: 0;
  }
  
  div.comp-name-a,
  div.comp-name-b,
  div.comp-name-c,
  div.comp-name-d {
    font-weight: 700;
    margin-top: 20px;
  }
  div.comp-name-a span,
  div.comp-name-b span,
  div.comp-name-c span,
  div.comp-name-d span {
    margin-bottom: 0;
  }
  .action-btns {
    float:right;
  }
</style>


   
<div class="popup-window" id="compare-company-modal">
  <a href="#" class="close-btn close">Close</a>
  <div class="popup-window-content" id="compare">

    <div class="compare-company-body">
      <h3>Select up to 3 companies</h3>
      <div class="comp-search-wrapper">    
    
        <div class="comp-search1">     
          <form class="well form-horizontal" id="compare_company_input1" action="/company/comparison_company1.412020" accept-charset="UTF-8" method="post"><input type="hidden" name="_method" value="patch" /><input type="hidden" name="authenticity_token" value="2aPlHyq+wy3JcUEGCI+eLI7BiQt9YEMqwRV6iJc97cmKOpb3fIyMigKJGpHnHoBdVIL7sV/hGWhGhnhicOcYHQ==" />
</form>            <input type="hidden" name="company_name" id="company_name" />
            <input type="hidden" name="selected_ids[]" id="selected_ids_" />
        </div>
        
        <div class="comp-search2">     
          <form class="well form-horizontal" id="compare_company_input2" action="/company/comparison_company2.412020" accept-charset="UTF-8" method="post"><input type="hidden" name="_method" value="patch" /><input type="hidden" name="authenticity_token" value="2T1cvnkNi6w1l6u+dWhpZi2Nm4gVqdqwxzdAOsDAZkx1+6A+6oKk5PMk4YsM0Ri5IWliMoBK62tCI8hKvReg4Q==" />
</form>            <input type="hidden" name="company_name" id="company_name" />
            <input type="hidden" name="selected_ids[]" id="selected_ids_" />
        </div>
        
        <div class="comp-search3">     
          <form class="well form-horizontal" id="compare_company_input3" action="/company/comparison_company3.412020" accept-charset="UTF-8" method="post"><input type="hidden" name="_method" value="patch" /><input type="hidden" name="authenticity_token" value="TMjU/xULZ63iq3K6WgOVY14aho7ez+ysAYSxYFSy5hpsbXxN9p2BC+kcBENkzciIeGqIhFe3xk85gOeWiyCcoA==" />
</form>            <input type="hidden" name="company_name" id="company_name" />
            <input type="hidden" name="selected_ids[]" id="selected_ids_" />
        </div>
      </div>
      <input type="hidden" id="prof-id" name="prof-id" value="{{profile.company.id}}" />
      
      <table id="compare-table">
          <tr>
            <th style="font-weight:700;">
              Company
            </th>
            <td>
              <div class="compare-logo-a">
                  <div class="compare-thumb">
                    <img ng-src="{{profile.company.logo_url || '/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png'}}" />
                  </div>
              </div>
              <div class="comp-name-a">
                <span>{{profile.company.name}}</span>
              </div>
            </td>      
            <td>
              <div class="compare-logo">
                <div id="getco1Logo">
        <!------- here ------>          
                </div>
              <div class="comp-name-b comp1-name" id="getco1Name">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="compare-logo">
                <div id="getco2Logo">
        <!------- here ------>          
                </div>
              <div class="comp-name-c comp2-name" id="getco2Name">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="compare-logo">
                <div id="getco3Logo">
        <!------- here ------>          
                </div>
              <div class="comp-name-d comp3-name" id="getco3Name">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Short Description
            </th>
            <td>
              <span>{{profile.company.short_description}}</span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1Desc">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2Desc">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3Desc">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Status
            </th>
            <td>
              <span>{{profile.company.company_type}}</span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1Status">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2Status">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3Status">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Year Founded
            </th>
            <td>
              <span>{{profile.company.year_founded}}</span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1Year">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2Year">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3Year">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Industry Group
            </th>
            <td>
              <span>{{profile.company.industry_group}}</span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1Ig">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2Ig">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3Ig">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Sector
            </th>
            <td>
              <span>{{profile.company.primary_tag}}</span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1Sector">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2Sector">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3Sector">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Development Stage
            </th>
            <td>
              <span>{{profile.company.stage}}</span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1DevStage">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2DevStage">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3DevStage">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Country
            </th>
            <td>
              <span>{{profile.company.country}}</span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1Country">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2Country">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3Country">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Nbr Employees
            </th>
            <td>
              <span>{{profile.traction.num_employee_range}}</span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1NumEmp">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2NumEmp">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3NumEmp">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Revenue Range
            </th>
            <td>
              <span>{{profile.traction.revenue}}</span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1RevRange">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2RevRange">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3RevRange">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Total Equity<br />Capital Raised
            </th>
            <td>
              <span>{{profile.traction.capital}}</span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1CapRaised">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2CapRaised">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3CapRaised">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Last Stage<br />Capital Raised
            </th>
            <td>
              <span>
                  Series A
                     round of 
                    $11.3M
              </span>
                  <br />
                  <span>
                    2020
                  </span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1FinEvents">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2FinEvents">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3FinEvents">
<!------- here ------>
              </div>
            </td>
          </tr>
          <tr>
            <th>
              Investors
            </th>
            <td>
              <span>Department for Business, Energy, and Industrial Strategy (BEIS), ADM Capital, Rabo Food &amp; Agri Innovation Fund, Propagator Ventures, Nysno Climate Investments</span>
            </td>      
            <td>
              <div class="comp1-name" id="getco1Investors">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp2-name" id="getco2Investors">
<!------- here ------>
              </div>
            </td>
            <td>
              <div class="comp3-name" id="getco3Investors">
<!------- here ------>
              </div>
            </td>
          </tr>
          
      </table>
    <input type="hidden" id="dc" name="dc" />
    </div>
    
    <div class="popup-window-actions" style="width:1072px">
      <div style="float:left;">
        <a href="#" class="feedback" id="send-compare-feedback">Send Feedback</a>
      </div>  
      <div class="action-btns">
        <a href="#" class="close">Close</a>
        
        <a href="#" class="compare-download" id="download-compare-comps">Download</a>
        <input type="hidden" name="format" value="csv">
      </div>
    </div>

  </div>
</div>

<script type="text/javascript">

  $(function() {
    $("#compare-company-button").on('click', function(event) {
      openPopup("#compare-company-modal");
    $('input').attr("placeholder", "Type company name");
    });
  });
  
  var selected_comps = []
    
  $(document).ready(function() {
      
    $(function() {
      $("#compare_list")
      .bind('ajax:error', function(evt, xhr, error) {
        alert(xhr.responseText);
      })
      .bind('ajax:success', function(evt, data, status) {
        $('#compare-company-modal').modal('hide');
        $('#compare_company_input1').tokenInput('add', {
          id: data.id,
          name: data.name
        });
        $('#compare_company_input2').tokenInput('add', {
          id: data.id,
          name: data.name
        });
        $('#compare_company_input3').tokenInput('add', {
          id: data.id,
          name: data.name
        });
      });
      $( ".close" ).click(function() {
        $('#compare_company_input1').tokenInput("clear");
        $('#compare_company_input2').tokenInput("clear");
        $('#compare_company_input3').tokenInput("clear");
        $('#token-input-compare_company_input1').trigger("blur");
        $('#token-input-compare_company_input2').trigger("blur");
        $('#token-input-compare_company_input3').trigger("blur");
      });
      
      $('#compare-company-modal').on('show', function () {
        $('#company_name').val('');
        $('#company_name').focus();
      });
      
      $("#send-compare-feedback").on('click', function(event) {
        openPopup("#feedback-modal");
      });
      
      $("#download-compare-comps").on('click', function(event) {
        selected_comps.length = 0
        var c0 = $('#prof-id').val();
        selected_comps.push(parseInt(c0));
        var c1 = $('#compare_company_input1').val();
        selected_comps.push(parseInt(c1));    
        var c2 = $('#compare_company_input2').val();
        selected_comps.push(parseInt(c2));  
        var c3 = $('#compare_company_input3').val();
        selected_comps.push(parseInt(c3));

        downloadComps = $.grep( selected_comps, function( n, i ) {
          return n > 0;
        });
      
        $('#dc').attr("value", downloadComps);
        
        window.location = "/company/compare_company_download?&format=csv&data=" + downloadComps.toString();
      }); 
    });
  });
</script>

  
  <div class="popup-window" id="invite_colleagues_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="inviteColleagueForm" novalidate>
  <div class="popup-window-content">
    <h3>Invite a colleague</h3>

    <div class="share-body">
      <div class="share-top invite-colleague-body">
      <input
        ng-model="inviteColleague.first_name"
        ng-class="{'has-error': inviteColleagueForm.first_name.$invalid && submitted}"
        name="first_name"
        type="text"
        class="modal-text"
        placeholder="First name*"
        id="to_invite_first_name"
        style="width:100%;"
        required /><br/>
       <input
        ng-model="inviteColleague.last_name"
        ng-class="{'has-error': inviteColleagueForm.last_name.$invalid && submitted}"
        name="last_name"
        type="text"
        class="modal-text"
        placeholder="Last name*"
        id="to_invite_last_name"
        style="width:100%;"
        required /><br/>
       <input
        ng-model="inviteColleague.title"
        ng-class="{'has-error': inviteColleagueForm.title.$invalid && submitted}"
        name="title"
        type="text"
        class="modal-text"
        placeholder="Title*"
        id="to_invite_title"
        style="width:100%;"
        required /><br/>
      <input
        ng-model="inviteColleague.emails"
        ng-class="{'has-error': inviteColleagueForm.emails.$invalid && submitted}"
        name="emails"
        type="text"
        class="modal-text"
        placeholder="Email*"
        id="to_invite_emails"
        style="width:100%;"
        required /><br/>
       </div>
    </div>

    <div class="error-message" style="font-size:14px;margin-bottom:10px;">{{messages['inviteColleague']}}</div>
    <div class="popup-window-actions">
      <a href="#" ng-click="inviteColleagues(inviteColleagueForm.$valid, false)">
        <span ng-hide="isModalSaving['inviteColleague']" >Invite</span>
        <img ng-show="isModalSaving['inviteColleague']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $("#invite-colleague").on('click', function(e) {
      e.preventDefault();
      $('#invite_colleagues_modal').css('top', $(window).scrollTop() + 100);

      openPopup("#invite_colleagues_modal");
    });
  });
</script>


  <div class="popup-window" id="request-update-modal" style="position: fixed;">
  <a href="#" class="close-btn close">Close</a>
  <form name="requestUpdateForm" novalidate>
  <div class="popup-window-content">
    <h3>Request Update</h3>

    <div class="profile-owner-body">
       <textarea
        name="body"
        id="request_update_comment"
        placeholder="Please tell us which area(s) of the profile you think need attention."
        class="width-100 height-180px modal-text"></textarea>
    </div>

    <div class="popup-window-actions">
      <a href="#" ng-click="requestUpdate(true)">
        <span ng-hide="isModalSaving['requestUpdate']" >Send</span>
        <img ng-show="isModalSaving['requestUpdate']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>

  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $(".request-update-button").on('click', function(event) {
      openPopup("#request-update-modal");
    });
  });
</script>

  <div class="popup-window" id="pipeline-content-modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="pipelineForm" novalidate>
  <div class="popup-window-content">
    <h3>Add to pipeline</h3>

    <div class="pipeline-body">
      <div class="pipeline-lists">
        <div class="list-wrapper"><label style="font-weight:600;">Recently updated lists:</label></div>
        <label style="font-weight:400;" ng-repeat="list in profile.recent_user_lists">
          <input
            type="checkbox"
            ng-checked="list.checked"
            value="{{list.id}}"
            name="user_lists[]"
            class="pipeline-input pi_{{list.id}}"
            />&nbsp; {{list.name}}
          <br/>
        </label>
        <hr>
        <div class="list-wrapper"><label style="font-weight:600;">Your lists:</label></div>
        <label style="font-weight:400;" ng-repeat="list in profile.user_lists">
          <input class="presented_list_ids" type="hidden" name="presented_list_ids[]" value="{{list.id}}">
          <input
            type="checkbox"
            ng-checked="list.checked"
            value="{{list.id}}"
            name="user_lists[]"
            class="pipeline-input pi_{{list.id}}"
            />&nbsp; {{list.name}}
          <br/>
        </label>
      </div>

      <div class="pipeline-add">
        <input type="text" id="input-user-list" placeholder="Enter a new list name..." class="modal-text" /><button class="ctg-button float-left" ng-click="addUserList()">{{messages['addPipelineButton']}}</button>
      </div>
    </div>
    <div class="clear"></div>

    <div class="popup-window-actions">
      <a href="#" ng-click="updatePipeline(pipelineForm.$valid)">
        <span ng-hide="isModalSaving['addPipeline']" >Save</span>
        <img ng-show="isModalSaving['addPipeline']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="loading23" />
      </a>

      <a href="#" class="close">Close</a>
    </div>

  </div>
  </form>
</div>

<script type="text/javascript">

  $(function() {
    $('.pipeline-input').on('click',function() {
      var c = this.className.replace('pipeline-input ','');
      $('.'+c).prop("checked", this.checked);
    });

    $(".pipeline-content-button").on('click', function(event) {
      openPopup("#pipeline-content-modal");
    });
  });
</script>

  <div class="popup-window" id="add_company_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="addCompanyForm" novalidate>
  <div class="popup-window-content">
    <h1>Add Company</h1>
    <div class="">
      <div>
        <input
          ng-model="addCompany.name"
          name="addCompanyName"
          type="text"
          ng-class="{'has-error': addCompanyForm.addCompanyName.$invalid && addCompanySubmitted}"
          class="modal-text margin-bottom-15px width-100p"
          placeholder="Company Name"
          id="addCompanyName" 
          required />
        </div>

        <label>Country</label>
        <select
           ng-model="addCompany.country_id"
           class="margin-bottom-15px"
           ng-options="obj.id as obj.name for obj in profile.edit_options.countries"
           name="addCountryId"
           id="addCountryId">
        </select>
    </div>
    <div class="popup-window-actions">
      <a href="#" ng-click="companyAdd(addCompanyForm.$valid)">
        <span ng-hide="isModalSaving['addCompany']" >Create</span>
        <img ng-show="isModalSaving['addCompany']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $(document).on("click", ".add-company-button",function(event) {
      openPopup("#add_company_modal");
      $('#add_company_modal').css("left", "50%");
      $('#add_company_modal').css("top", $(window).scrollTop() + 100);      
    });
  });
</script>
  <div class="popup-window" id="add_investor_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="addInvestorForm" novalidate>
  <div class="popup-window-content">
    <h3>Add Investor</h3>
    <div>
      <div>
        <input
          ng-model="addInvestor.name"
          name="addInvestorName"
          type="text"
          ng-class="{'has-error': addInvestorForm.addInvestorName.$invalid && addInvestorSubmitted}"
          class="modal-text margin-bottom-15px width-100p"
          placeholder="Investor Name"
          id="addInvestorName"
          required />
        </div>

        <label>Investor Type</label>
        <select
           ng-model="addInvestor.investor_type_id"
           class="margin-bottom-15px"
           style="width: 100%;"
           ng-class="{'has-error': addInvestorForm.addInvestorTypeId.$invalid && addInvestorSubmitted}"
           ng-options="obj.id as obj.name for obj in profile.edit_options.investor_types"
           name="addInvestorTypeId"
           id="addInvestorTypeId"
           required>
        </select><br/>

        <label>Country</label>
        <select
           ng-model="addInvestor.country_id"
           class="margin-bottom-15px"
           ng-class="{'has-error': addInvestorForm.addInvestorCountryId.$invalid && addInvestorSubmitted}"
           ng-options="obj.id as obj.name for obj in profile.edit_options.countries"
           name="addInvestorCountryId"
           id="addInvestorCountryId"
           required>
        </select><br/>
        <div class="margin-bottom-15px">
          <span style="font-size:11px;">Investors must be an venture capital firm, accredited individual, or company</span>
        </div>
    </div>
    <div class="popup-window-actions">
      <a href="#" ng-click="investorAdd(addInvestorForm.$valid)">
        <span ng-hide="isModalSaving['addInvestor']" >Create</span>
        <img ng-show="isModalSaving['addInvestor']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $(document).on('click', ".add-investor-button", function(event) {
      openPopup("#add_investor_modal");
      $('#add_investor_modal').css("left", "50%");
      $('#add_investor_modal').css("top", $(window).scrollTop() + 100);
    });
  });
</script>
  <div class="popup-window" id="investment_no_edit_modal">
  <div class="popup-window-content">
  	<h3>Investment Data Information</h3>
  	<div>
  		<p>Investment data is not editable by profile owners.<br><br>Please contact <a href="mailto:research@cleantech.com?Subject=Investment%20Data%20Inquiry" target="_top">research@cleantech.com</a> to make changes.</p>
	    <div class="popup-window-actions" style="position:relative; left:30%;">
    	  <a href="#" class="close">Close</a>
	    </div>
  	</div>
  </div>
</div>

<script type="text/javascript">
  $(function() {
    $(document).on('click', "#investment-no-edit-button", function(event) {
      openPopup("#investment_no_edit_modal");
      $('#investment_no_edit_modal').css("left", "50%");
      $('#investment_no_edit_modal').css("top", $(window).scrollTop() + 100);
    });
  });
</script>

  <div class="popup-window" id="alternate_name_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="alternateNameForm" novalidate>
  <div class="popup-window-content">
    <h3>Alternate names</h3>
    <h3 class="margin-bottom-20px">Make sure potential partners can find you - input common misspellings, abbreviations, past names, etc.</h3>

    <div class="alternate-name-body">
      <textarea
        name="alternate_names"
        type="text"
        class="modal-text margin-bottom-15px"
        id="alternate_names"
        ng-model="profile.alternate_names"
        placeholder="Please add alternate names on their own line.">
      </textarea>
      <span style="font-size: 14px;">Each alternate name must be on its own line</span>
      <div class="popup-window-actions right-align-send-button">
        <a href="#" ng-click="alternateName(alternateNameForm.$valid)">
          <span ng-hide="isModalSaving['alternateName']" >Save</span>
          <img ng-show="isModalSaving['alternateName']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="loading23" />
        </a>
      </div>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $(".alternate-name-button").on('click', function(event) {
      openPopup("#alternate_name_modal");
    });
  });
</script>

  <div class="popup-window" id="feedback-modal" style="position: fixed;">
  <a href="#" class="close-btn close">Close</a>
  <form name="sendFeedbackForm" novalidate>
  <div class="popup-window-content">
    <h3>Feedback</h3>

    <div>
       <textarea
        style="padding-left: 10px;width:97%;"
        name="body"
        id="feedback_comment"
        placeholder=""
        class="width-100 height-180px modal-text"></textarea>
    </div>

    <div class="popup-window-actions">
      <a href="#" ng-click="sendFeedbackPatent(true)">
        <span ng-hide="isModalSaving['sendFeedback']" >Send</span>
        <img ng-show="isModalSaving['sendFeedback']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>

  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $(".feedback-button").on('click', function(event) {
      openPopup("#feedback-modal");
    });
  });
</script>

  <div class="popup-window" id="add_patent_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="addPatentForm" novalidate>
  <div class="popup-window-content">
    <h3>Submit a {{patentType == 'uspto' ? "USPTO patent" : (patentType == 'uspto-published' ? "USPTO published patent application" : "ESPACENET")}}</h3>
    <p>We do not support patent pending.  After submitting, it may take 24 hours before added patents to appear.</p>
    <p>This form is only for patents and published patent applications listed with the United States Patent and Trademark Office. <a href = "mailto: research@cleantech.com" style="color:#ff671b;font-weight:500;">Contact us</a> to add European patents.</p>
    <br/>
    <div class="share-body">
      <div class="share-top add-patent-body"><br/>
        <div ng-show="patentType == 'uspto'">Patent no.
          <input
            type="text"
            placeholder="ex: 9,124,968"
            ng-class="{'has-error': addPatentForm.patent_num.$invalid && submitted}"
            ng-model="patent.patent_num" /><br/><br/>
        </div>
        <div ng-show="patentType == 'uspto-published'">Published Application no.
          <input
            type="text"
            placeholder="ex: 20150061638"
            ng-class="{'has-error': addPatentForm.published_app_num.$invalid && submitted}"
            ng-model="patent.published_app_num" /><br/><br/>
        </div>
        <div ng-show="patentType != 'espacenet'">
          OR <br/><br/>
          Application no.<input
            type="text"
            placeholder="ex: 12/345678"
            ng-class="{'has-error': addPatentForm.application_num.$invalid && submitted}"
            ng-model="patent.application_num" /><br/><br/>
        </div>
        <!--div ng-show="patentType == 'espacenet'">Application no.
          <input
            type="text"
            ng-class="{'has-error': addPatentForm.application_num.$invalid && submitted}"
            ng-model="patent.application_num"
            ng-required="patentType == 'espacenet'" />
        </div-->
      </div>
    </div>

    <div class="popup-window-actions">
      <a href="#" ng-click="addPatents(addPatentForm.$valid)">
        <span ng-hide="isModalSaving['addPatents']" >Submit</span>
        <img ng-show="isModalSaving['addPatents']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $("#add-patent").on('click', function(e) {
      e.preventDefault();
      $('#edit-tile').trigger('click');
      $('#add_patent_modal').css('top', $(window).scrollTop() + 100);
        
      openPopup("#add_patent_modal");
    });
  });
  $(function() {
    $(".close").on('click', function(e) {
      e.preventDefault();
      $('#edit-tile').trigger('click');
    });
  });
</script>

  <div class="popup-window" id="patent-submitted">
  <a href="#" class="close-btn close">Close</a>
  <div class="popup-window-content">
    <h3>Patent request submitted!</h3>

    <div class="share-body">
      <p>Information about your patent is being retrieved from the USPTO database.  After submitting, it may take 24 hours before added patents appear.</p>
<!--      <p>Please click the Save button after closing this popup.</p>-->
    </div>

    <div class="popup-window-actions">
      <a href="#" class="close" id="close-tile">Close</a>
    </div>
  </div>
</div>

<script type="text/javascript">
  $(document).ready(function() {
      $("#close-tile").on('click', function(e) {
      $('#tile-save').trigger('click');
    });
  });
</script>
  <div class="popup-window" id="confirm_team_delete_modal">
  <a href="#" class="close-btn close">Close</a>
  <div class="popup-window-content">
    <div class="share-body">
      <h1>Your updates include deleting contacts.  Are you sure you want to continue?</h1>
    </div>

    <div class="popup-window-actions">
      <a href="#" ng-click="confirmedDelete()">
        <span>Delete</span>
      </a>
      <a href="#" class="close">Cancel</a>
    </div>
  </div>
</div>

  <div class="popup-window" id="update-description-modal" style="position: fixed;">
  <a href="#" class="close-btn close">Close</a>
  <form name="sendUpdateDescriptionForm" novalidate>
  <div class="popup-window-content">
    <h3>Update Request</h3>
    <p>
      Please briefly describe your company's technology and business model.
    </p>
    <p>
      Note that we retain editorial control over company descriptions in order to avoid publishing promotional language.
    </p>
    <div>
       <textarea
        style="padding-left: 10px;width:97%;"
        name="body"
        id="update_description_comment"
        placeholder="Describe the technology and business model"
        maxlength="250"
        class="width-100 height-180px modal-text"></textarea>
    </div>

    <div class="popup-window-actions">
      <a href="#" ng-click="sendUpdateDescription(true)">
        <span ng-hide="isModalSaving['sendUpdateDescription']" >Send</span>
        <img ng-show="isModalSaving['sendUpdateDescription']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>

  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $(".update-description-button").on('click', function(event) {
      openPopup("#update-description-modal");
    });
  });
</script>


  <div class="popup-window" id="signup-modal">
  <a href="#" class="close-btn close">Close</a>
  <div class="popup-window-content">
    <span>Hey there!</span>
    <br/><br/>
    <span>We hope you've enjoyed an initial browse of i3. Select an option below to start enjoying i3's full capabilities!</span><br/><br/>

      <div class="one_third_column" style="width:45%;">
    <img class="reg_tile_logo" height="55" src="/assets/newdesign/StartUpIcon_69x62_Retina-a2c191437b54e8f8a57ddaadcdbc27ae1f12e5946f5b0cb13ebf4287b35965fd.png" />
    <h3 class="reg_tile_h3">Startups </h3>
    <p class="reg_tile_blurb_p" style="width: 80%;margin-left: auto; margin-right: auto;">
      Use i3 to gain visibility with corporations and investors looking to invest and partner with external technology companies.
    </p>
  </div>

<!--
  <div class="one_third_column">
  </div>
-->

<div class="one_third_column" style="width:45%;">
    <img class="reg_tile_logo" height="55" src="/assets/newdesign/DataIcon_69x62_Retina-c3321cd23eb1e042fd64cf95d64a9011a9f587c5681dde65f7b9aadd5487963d.png" />
    <h3 class="reg_tile_h3">Trialists</h3>
    <p class="reg_tile_blurb_p" style="width: 80%;margin-left: auto; margin-right: auto;">Use i3 to access market intelligence on companies, investors, market activity and innovation trends.</p>
  </div>

  <div class="clear"></div>

  
  <div class="one_third_column hit_bottom" style="width:45%;padding:0px 3px;">
      <button class="orange-btn width250 font_size_18" id="claim_your_profile_button" style="margin-left: 20px;">Create your free profile</button>
  </div>
  
<!--
  <div class="one_third_column hit_bottom">
-----removed free version button-----------------------
  </div>
-->


<div class="one_third_column hit_bottom" style="width:45%;">
    <button class="orange-btn width250 font_size_18" id="request_trial_button" style="margin-left: 50px;">Register for trial access</button>
  </div>

  <div class="clear"></div>

    <div id="claim_your_profile_slider" class="hidden dashboard-input-form">
      <div class="form-introduction">      
        <p><strong>Are you involved with a startup or SME looking for strategic partners, investors, or customers? Create your free profile!</strong></p>
      </div>    
     
      <form id="startup-form" onsubmit="return validateOpenForm(&#39;startup-form&#39;)" action="/account" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="ulGAwxWOvqUJ8/VrBXGdLGcdKO9qABuwQZ0raU++sPzqDJf9NHgxpiXLr06azkzznHxS4Ps9bXLcJHGT/mESlg==" />
        <input type="hidden" name="action_type" id="action_type" value="registered" />
        <input type="hidden" name="front_page_type" id="front_page_type" value="true" />
        
        <p><strong>First name <span class="orange-text">*</span></strong> <input required="required" type="text" name="user[first_name]" id="user_first_name" /></p>
        <p><strong>Last name  <span class="orange-text">*</span></strong> <input required="required" type="text" name="user[last_name]" id="user_last_name" /></p>
        <p><strong>Title      <span class="orange-text">*</span></strong> <input required="required" type="text" name="user[title]" id="user_title" /></p>
        <p><strong>Company    <span class="orange-text">*</span></strong> <input required="required" type="text" name="user[company]" id="user_company" /></p>
        <p><strong>Email      <span class="orange-text">*</span></strong> <input required="required" type="email" name="user[email]" id="user_email" /></p>
        <p><strong>Phone                                        </strong> <input type="tel" name="user[phone]" id="user_phone" /></p>
        <p><strong>Password   <span class="orange-text">*</span></strong> <input id="startup-form-password" requred="true" type="password" name="user[password]" /></p>
        <p><strong>Confirm Password<span class="orange-text">*</span></strong> <input id="startup-form-password-confirm" required="required" type="password" name="user[password_confirm]" /></p>
    
        <p class="align-right">
          <a id="claim_your_profile_cancel" class="little-white-btn">Cancel</a>
          <input type="submit" name="commit" value="Submit" class="little-orange-btn" data-disable-with="Submit" />
        </p>
</form>    </div>
  
<!--
  <div id="access_free_version_slider" class="hidden dashboard-input-form">
  

  <div class="form-introduction">  
    <p><strong>Gain access to i3's powerful network for free:</strong></p>
  </div>
    <div id="corporate-form-message"></div>
  </div>

-->

  <div id="request_trial_slider" class="hidden dashboard-input-form">

  <div class="form-introduction">  
    <p><strong>Register for trial access and explore the full power of i3:</strong></p>
  </div>

    <form id="trial-form" onsubmit="return asyncValidateForm(&#39;trial-form&#39;)" action="/account/request_trial" accept-charset="UTF-8" method="post"><input type="hidden" name="authenticity_token" value="O5oRedL1Su5O2FAD/VfzQtH3w4Mdy0xqo1Txbl8M5tw3nT0DjbuWsfKe8G9VNcVk8UyrhiTVbg+jZBTAXegSng==" />
      <p><strong>First name <span class="orange-text">*</span></strong> <input type="text" name="first_name" id="first_name" required="required" /></p>
      <p><strong>Last name  <span class="orange-text">*</span></strong> <input type="text" name="last_name" id="last_name" required="required" /></p>
      <p><strong>Title      <span class="orange-text">*</span></strong> <input type="text" name="title" id="title" required="required" /></p>
      <p><strong>Company    <span class="orange-text">*</span></strong> <input type="text" name="company" id="company" required="required" /></p>
      <p><strong>Email      <span class="orange-text">*</span></strong> <input type="email" name="email" id="email" required="required" /></p>
      <p><strong>Phone                                        </strong> <input type="tel" name="phone" id="phone" /></p>
    
      <p class="align-right">
        <a id="request_trial_cancel" class="little-white-btn">Cancel</a>
        <input type="submit" name="commit" value="Request a trial" class="little-orange-btn" data-disable-with="Request a trial" />
      </p>
		<input type="hidden" name="tn" value="3ccnt">
</form>
    <div id="trial-form-message"></div>
  </div>


  </div>
</div>

<script type="text/javascript">
  $(function() {
      $("#claim_your_profile_button").click(function() {
        $("#access_free_version_slider").slideUp();
        $("#request_trial_slider").slideUp();
        $("#claim_your_profile_slider").slideToggle();
      });

    $("#access_free_version_button").click(function() {
      $("#claim_your_profile_slider").slideUp();
      $("#request_trial_slider").slideUp();
      $("#access_free_version_slider").slideToggle();
    });

    $("#request_trial_button").click(function() {
      $("#claim_your_profile_slider").slideUp();
      $("#access_free_version_slider").slideUp();
      $("#request_trial_slider").slideToggle();
    });

    $("#claim_your_profile_cancel").click(function() {
      $("#claim_your_profile_slider").slideUp();
    });

    $("#access_free_version_cancel").click(function() {
      $("#access_free_version_slider").slideUp();
    });

    $("#request_trial_cancel").click(function() {
      $("#request_trial_slider").slideUp();
    });
  });

  function validateOpenForm(type) {
    var password = document.getElementById(type + "-password");
    var confirm_password = document.getElementById(type + "-password-confirm");

    if(password.value != confirm_password.value) {
      alert("Passwords don't match");
      password.style.borderColor = "#ff5816";
      confirm_password.style.borderColor = "#ff5816";
      return false;
    }
    else {
      password.style.borderColor = "#DDD";
      confirm_password.style.borderColor = "#DDD";
      document.getElementById(type).submit();
      return true;
    }
  }

  function asyncValidateForm(type) {
    var url = $('#' + type).prop('action');

    $.ajax({
      url: url,
      type: "POST",
      data: $('#' + type).serialize(),
      dataType: "JSON",
      success: function(data) {
        $('.close-btn').trigger('click');
        $('#request_received').css('top', $(window).scrollTop() + 100);
        openPopup('#request_received');
      },
      error: function(data) {
        $('#' + type + '-message').html("<p>There was an error processing your request.</p>");
      }
    });

    return false;
  }
</script>

<div class="popup-window" id="request_received">
  <a href="#" class="close-btn close">Close</a>
  <div class="popup-window-content">
    <h1>Request Received!</h1>

    <div class="share-body">
      <p>We have received your request and will be in touch with you on the next steps.</p>
      <p>Please allow us 24 hours to review your request and confirm access to our trusted network.</p>
      <p>In the meantime, feel free to keep searching and check our company profile pages and sector pages for the latest news and trends.</p>
    </div>

    <div class="popup-window-actions">
      <a href="/">Go to front page</a>
      <a href="#" class="close">Continue browsing</a>
    </div>
  </div>
</div>


<script type="text/javascript">
  $(function() {
    $(".signup-button").on('click', function(event) {
      $('#signup-modal').css('top', $(window).scrollTop() + 50);
      openPopup("#signup-modal");
    });
  });
</script>

  <div class="popup-window" id="claim_open_profile_modal">
  <a href="#" class="close-btn close">Close</a>
  <form name="openProfileForm" novalidate>
  <div class="popup-window-content">
    <h3>Claim your profile</h3>

    <div class="share-body">
      <div class="share-top claim-open-profile-body">
      <input
        ng-model="openProfileUser.first_name"
        ng-class="{'has-error': openProfileForm.first_name.$invalid && submitted}"
        name="first_name"
        type="text"
        class="modal-text"
        placeholder="First name*"
        id="claim_first_name"
        style="width:100%;"
        required /><br/>
       <input
        ng-model="openProfileUser.last_name"
        ng-class="{'has-error': openProfileForm.last_name.$invalid && submitted}"
        name="last_name"
        type="text"
        class="modal-text"
        placeholder="Last name*"
        id="claim_last_name"
        style="width:100%;"
        required /><br/>
       <input
        ng-model="openProfileUser.title"
        ng-class="{'has-error': openProfileForm.title.$invalid && submitted}"
        name="title"
        type="text"
        class="modal-text"
        placeholder="Title*"
        id="claim_title"
        style="width:100%;"
        required /><br/>
       <input
        ng-model="openProfileUser.company"
        ng-class="{'has-error': openProfileForm.company.$invalid && submitted}"
        name="company"
        type="text"
        class="modal-text"
        placeholder="Company*"
        id="claim_company"
        style="width:100%;"
        required /><br/>
      <input
        ng-model="openProfileUser.email"
        ng-class="{'has-error': openProfileForm.email.$invalid && submitted}"
        name="email"
        type="text"
        class="modal-text"
        placeholder="Email*"
        id="claim_email"
        style="width:100%;"
        required /><br/>
       </div>
    </div>

    <div id="open-profile-error-message" class="error-message" style="font-size:14px;margin-bottom:10px;">{{messages.openProfileUser}}</div>
    <div class="popup-window-actions">
      <a href="#" ng-click="claimOpenProfile(openProfileForm.$valid)">
        <span ng-hide="isModalSaving['openProfileUser']" >Claim</span>
        <img ng-show="isModalSaving['openProfileUser']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>
  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $("#claim-open-profile").on('click', function(e) {
      e.preventDefault();
      $('#claim_open_profile_modal').css('top', $(window).scrollTop() + 100);
      var $scope = angular.element('#claim_open_profile_modal').scope();
      $scope.$apply(function() {
        $scope.submitted = false;
        $scope.messages.openProfileUser = "";
        $scope.openProfileUser = {};
      });

      openPopup("#claim_open_profile_modal");
    });
  });
</script>

  <div class="demo-div">
  <span class="demo-span">You are viewing a limited version of this profile.  To access i3's full capabilities.</span> <a href="#" class="signup-button">Sign up</a>
</div>

<div class="content-row">
  <div class="app-tile two-third-section float-left" data-tile-id="overview" id="left-tile">
  <form name="overviewForm" novalidate >
    <div class="tile-header">
      <span>{{profile.company.name}}</span>
      <div class="tile-header-icons">
        <div ng-show="showLoading['overview'] || globalLoading" class="tile-icons icon-loading"><img src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" /></div>
        <div ng-show="showPencil['overview']" ng-click="edit('overview')" class="tile-icons icon-pencil"><img src="/assets/newdesign/EditIcon_Blue_22x22px_2x-5a2502cf0290b6f4f819b13253bded5900b49bed9d896087ade8fc0523a6eb97.png" /></div>
        <div ng-show="showSave['overview']" class="tile-icons icon-remove"><div class="save-tile" ng-click="saveOverview(overviewForm.$valid)">Save</div><img ng-click="cancelEdit(&#39;overview&#39;)" src="/assets/newdesign/CancelIcon_Blue_22x22px_2x-d9f05c4961489fe0900a5fe345d6916b0d6317fb4d02e6f0b1e15f4400479530.png" /></div>
      </div>
      <div class="clear"></div>
    </div>
    <div class="tile-content overview-content">
      <div class="cp-profile-left">
      <div class="acquired-comp">
            </div>
        <div class="company-logo" style="width:200px;">
          <div ng-hide="isEditing['overview']">
            <div class="thumb-200x130 thumb">
              <img ng-src="{{profile.company.logo_url || '/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png'}}" />
            </div>
          </div>

          <div ng-show="isEditing['overview']">
            <div class="thumb-200x130 thumb">
              <img id="logo_image_preview" ng-src="{{company.logo_url || '/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png'}}" alt="Product" />
            </div>
          </div>
        </div>
        <div class="clear"></div>

        <div ng-hide="isEditing['overview']">
            
            
            
            
            
            <div class="nav-single-button">
  <a href="#" id="share_button">Share profile</a>
</div>

        </div>
        <div ng-show="isEditing['overview']">
          <div class="editable">Company logo <span style="font-weight:normal;">(jpg or png)</span></div>
          <input
            onchange="angular.element(this).scope().logoChanged(this)"
            file-input="files"
            class="company_logo"
            name="logo_image"
            type="file"
            multiple
            accept="image/*" />
          <!--button class="upload-btn" ng-click="uploadLogo()"></button-->
        </div>

        <div ng-show="isEditing['overview']" class="parent-edit">
          <div class="editable">Parent company </div>
          <input type="text" name="add_parent" id="add_parent_input" />
        </div>

        <div ng-show="isEditing['overview']" class="alt-name-edit">
          <a type="button" class="alternate-name-button weight600" href="#">Edit alternate names</a>
        </div>
      </div>

      <div class="cp-profile-right">
        <div class="cp-profile-details">
            <div class="short-description" id="left-tile">
  <p class="cp-description">
    <div ng-hide="isEditing['overview']">
      <span class="cp-description-span"><span class="cp-name">Short description </span><h1 id="elevator-pitch">{{profile.company.short_description}}</h1></span>
    </div>
  </p>
</div>
<div class="clear"></div>

<div class="year-founded">
  <p class="cp-year-founded">
    <div ng-hide="isEditing['overview']">
      <span>Founded in </span>
      <span>{{profile.company.year_founded}}</span>
    </div>
    <div ng-show="isEditing['overview']">
      <div class="editable">Founded in </div>
      <input
        ng-model="company.year_founded"
        ng-pattern="/^\d{4}$/"
        ng-class="{'has-error': overviewForm.year_founded.$invalid && submitted}"
        class="overview-row"
        type="text"
        name="year_founded"
        placeholder="Year"
        required
        />
     </div>
  </p>
</div>

<div class="company-type">
  <p class="cp-company-type">
    <div class="company-display" ng-hide="isEditing['overview']">
      <span>Company type </span>
      <span ng-show="profile.company.company_status_id != 3">{{profile.company.company_type}}</span>
      <span ng-hide="profile.company.company_status_id != 3">Public (<a ng-href="https://finance.yahoo.com/q?s={{profile.company.ticker_symbol}}" target="_blank">{{profile.company.ticker_symbol}}</a>)</span>
    </div>
    <div class="company-edit" ng-show="isEditing['overview']">
      <div class="editable">Company type </div>
      <select
         ng-model="company.company_status_id"
         ng-class="{'has-error': overviewForm.company_status_id.$invalid && submitted}"
         ng-options="obj.id as obj.name for obj in profile.edit_options.company_statuses"
         name="company_status_id"
         class="overview-row"
         required
         >
        <option value=""></option>
      </select>
    </div>
  </p>
</div>
<div class="clear"></div>


<div class="sector">
  <p class="cp-sector">
    <div ng-hide="isEditing['overview']">
      <span>Industry Group </span>
      <span id="ind_grp">{{profile.company.industry_group}}</span>
    </div>
    <div ng-show="isEditing['overview']">
    <div class="editable">Industry Group </div>
    <select
       ng-model="company.industry_group_id"
       ng-class="{'has-error': overviewForm.primary_tag.$invalid && submitted}"
       ng-options="obj.tag_id as obj.name for obj in profile.edit_options.industry_groups"
       class="overview-row"
       name="industry_group"
       >
      <option value=""></option>
    </select>
    </div>
  </p>
</div>

<div class="sector">
  <p class="cp-sector">
     <div ng-hide="isEditing['overview']">
      <span>Sector </span>
        <span id="prim_tag">{{profile.company.primary_tag}}</span>
    </div>
    <div ng-show="isEditing['overview']">
    <div class="editable">Sector </div>
    <select
       ng-model="company.primary_tag_id"
       ng-class="{'has-error': overviewForm.primary_tag.$invalid && submitted}"
       ng-options="obj.tag_id as obj.name for obj in profile.edit_options.tags"
       class="overview-row"
       name="primary_tag"
       >
      <option value=""></option>
    </select>
    </div>
  </p>
</div>

<div class="stage">
  <p class="cp-stage">
    <div ng-hide="isEditing['overview']">
      <span>Stage </span>
      <span>{{profile.company.stage}}</span>
    </div>
    <div ng-show="isEditing['overview']">
      <div class="editable">Stage </div>
      <select
         ng-model="company.development_stage_id"
         ng-class="{'has-error': overviewForm.development_stage_id.$invalid && submitted}"
         ng-options="obj.id as obj.name for obj in profile.edit_options.development_stages"
         class="overview-row edit-stage"
         name="development_stage_id"
         required
         >
        <option value=""></option>
      </select>
    </div>
  </p>
</div>

<div class="ticker">
  <div ng-show="isEditing['overview']">
    <div class="editable">Ticker </div>
      <input
        ng-model="company.ticker_symbol"
        class="overview-row"
        name="ticker_symbol"
        placeholder="Ticker"
      />
  </div>
</div>
<div class="clear"></div>

<script type="text/javascript">
   
    $(document).ready(function() {
    
    $("#prim_tag:empty").parent().hide();
    $("#ind_grp:empty").parent().hide();
        
}); 
    
</script>



          <div class="address ">
            <p class="cp-address">
              <div ng-hide="isEditing['overview']">
                <span>Headquarters </span>
                <span ng-show="(profile.company.city && profile.company.state) || (profile.company.city && profile.company.country_id) || (profile.company.country_id)">
                    <span style="font-weight:300;" ng-show="profile.company.country_id == 15026">{{profile.company.country}}</span>
                    <span style="font-weight:300;" ng-show="profile.company.country_id != 15026">{{[profile.company.city, profile.company.country].join(', ')}}</span>

                    <a ng-href="/map/company/{{profile.company.id}}" target="_blank"><img src='/assets/newdesign/MapIcon_18Hx13W_2x-40ff27c297e6c27c69d73f168b478b339665b8e4dbecb87befffadcc6353b56e.png' class="cp-map-icon" /></a>
                </span>
              </div>
              <div ng-show="isEditing['overview']">
              <div class="clear"></div>
                <div class="editable">Address </div>
                <input
                  ng-model="company.address"
                  ng-class="{'has-error': overviewForm.address.$invalid && submitted}"
                  class="overview-row"
                  type="text"
                  name="address"
                  placeholder="Address"
                  required
                  />
              <div class="clear"></div>
                <div class="editable">City </div>
                <input
                  ng-model="company.city"
                  ng-class="{'has-error': overviewForm.city.$invalid && submitted}"
                  class="overview-row"
                  type="text"
                  name="city"
                  placeholder="City"
                  required
                  />
              <div class="clear"></div>

              <div class="state-zip">
                <div class="state-block">
                  <div class="editable">State </div>
                  <select
                     ng-show="isEditing['overview']"
                     ng-model="company.state"
                     ng-class="{'has-error': overviewForm.state.$invalid && submitted}"
                     ng-options="obj.abbrev as obj.name for obj in profile.edit_options.states"
                     class="overview-row"
                     name="state"
                     >
                    <option value=""></option>
                  </select>
                </div>

                <div class="zip-block">
                  <div class="editable">Zip </div>
                  <input
                    ng-model="company.zip"
                    ng-class="{'has-error': overviewForm.zip.$invalid && submitted}"
                    class="overview-row"
                    type="text"
                    name="zip"
                    placeholder="Zip"
                    />
                </div>
              </div>
              <div class="clear"></div>
              <div class="editable">Country </div>
              <select
                 ng-show="isEditing['overview']"
                 ng-model="company.country_id"
                 ng-class="{'has-error': overviewForm.country_id.$invalid && submitted}"
                 ng-options="obj.id as obj.name for obj in profile.edit_options.countries"
                 class="overview-row country"
                 name="country_id"
                 required
                 >
              </select>
              </div>
            </p>
          </div>
          <div class="clear"></div>

          <div class="parent-company">
            <p class="cp-parent-company">
              <div ng-hide="isEditing['overview']">
                <span ng-show="profile.structure.parent != ''">
                  <span class="label overview-pc">Parent Companies </span><span ng-bind-html="htmlBindings['parentCompaniesHtml']"></span>
                </span>
              </div>
            </p>
          </div>

          <div class="website">
            <p class="cp-website">
              <div ng-hide="isEditing['overview']">
                <span ng-show="profile.company.website"><a href="{{profile.company.website}}" target="_blank">Website<a></span>
              </div>

              <div ng-show="isEditing['overview']">
                <div class="editable">Website </div>
                <input
                  ng-model="company.website"
                  ng-class="{'has-error': overviewForm.website.$invalid && submitted}"
                  class="overview-row"
                  type="url"
                  name="website"
                  placeholder="Website"
                  http-prefix
                  required
                  />
              </div>
            </p>
          </div>



          <div ng-hide="isEditing['overview']"
            class="last-updated float-right"
            ng-class="{'second-row-updater': profile.updated_by_info.second}"
            style="width:407px;"
          >
            <p ng-show="profile.updated_by_info.first">{{profile.updated_by_info.first}}</p>
            <p ng-show="profile.updated_by_info.second">{{profile.updated_by_info.second}}</p>
          </div>

          <div class="clear"></div>

        </div>
      </div>
    </div>
  </form>
  </div>

  <div class="app-tile one-third-section float-right" data-tile-id="git" id="right-tile">
  <div class="tile-header">
    <span>Get in touch</span>
    <div class="tile-header-icons"></div>
    <div class="clear"></div>
  </div>
  <div class="tile-content git-content git-open-profile">
    <div class="git-contact-details">
      <div ng-hide="profile.primary_contact.id" class="cp-no-contacts">
        <span>We don't have team members for this company yet!</span>
      </div>
      <div class="git-primary-contact-div" ng-show="profile.primary_contact.id" >
        <ul class="primary-contact-list">
          <li>
            <div class="thumb-85 thumb thumb-center">
              <img ng-src="{{profile.primary_contact.image_url || '/assets/newdesign/placeholders/user-a074efe4cf6988a192664c5503ac98634c2aa41173d5ce2f3debaede95212af3.png'}}" />
            </div>
          </li>
          <li class="font-size-12 weight600"><span>{{profile.primary_contact.name}}</span></li>
          <li ng-show="profile.primary_contact.title"><div class="font-size-13 git-title">{{profile.primary_contact.title}}</div></li>
          <li ng-show="profile.primary_contact.email">
            <div class="cp-social-icon">
              <a class="contact-profile-button link_email">
                <img src="/assets/newdesign/Envelop_Grey_18x18_2x-97c1b25fc74861b26f6db66f232c490f162c58202eced5e709a948f62b2724d4.png" class="cp-team-email-icon cursor-pointer social" /> Message {{profile.primary_contact.first_name}}
              </a>
            </div>
          </li>           
          <li>
            <div class="cp-team-size-info">
              <ng-pluralize count="profile.company_editor_users.length"
                  when="{'0': '0 team members on i3',
                         '1': '1 team member on i3',
                        'other': '{} team members on i3'}">
            </div>
          </li>
        </ul>
      </div>
      <div class="work-at-company">Work at this company?</div>
      <a href="#" class="claim-profile-btn" id="claim-open-profile">Claim this profile</a>
    </div>
  </div>
</div>
<script>
    $(document).ready(function() {
        var height = Math.max($("#left-tile").height(), $("#right-tile").height());
        $("#left-tile").height(height);
        $("#right-tile").height(height);
    });
</script>

</div>

  <div class="clear"></div>

      <div class="content-row">
  <div class="app-tile full-section">
    <div class="tile-header">
      <span>Traction</span>
    </div>
    <div class="tile-content traction-content">
      <div class="one-sixth-column">
        <ul>
          <li><a style="font-weight:600;font-size:15px;" href="#" ng-click="scrollTo('customer-full-tile');">{{profile.traction.customers.total}} customers</a></li>
          <li ng-show="profile.traction.customers.confirmed > 0">({{profile.traction.customers.confirmed}} confirmed)</li></ul>
      </div>
      <div class="one-sixth-column">
        <ul>
          <li><a href="#" ng-click="scrollTo('partnership-full-tile');">{{profile.traction.partnerships.total}} partnerships</a></li>
          <li ng-show="profile.traction.partnerships.confirmed > 0">({{profile.traction.partnerships.confirmed}} confirmed)</li>
        </ul>
      </div>
      <div class="one-sixth-column">
        <ul>
          <li><a href="#" ng-click="scrollTo('financing-full-tile');">{{profile.traction.financing.rounds}} financing events</a></li>
        </ul>
      </div>
      <div class="one-sixth-column">
        <ul><li><a href="#" ng-click="scrollTo('financing-full-tile');">{{profile.traction.financing.investors}} investors</a></li>
        </ul>
      </div>
      <div class="one-sixth-column">
        <ul>
          <li>
            <div><a href="#" ng-click="scrollTo('product-full-tile');">{{profile.products.length}} products</a></div>
          </li>
        </ul>
      </div>
      <div class="one-sixth-column">
        <ul>
          <li>
            <div>{{profile.ma.length}} M&amp;A items</div>
        </ul>
      </div>
    </div>
    <div class="clear"></div>
  </div>
</div>



<div class="clear"></div>

  <script src="/assets/jquery.caret.min-74b73fb965f93cd4922170b6051d996b8a0d87636b299ab67afc5f59ff268afc.js"></script>
<script src="/assets/jquery.tag-editor-c3b667469b7455fda399d09ea6d28b53c4bb04684cd886e2d55247699d3d274d.js"></script>
<link rel="stylesheet" media="screen" href="/assets/jquery.tag-editor-262d8e33cf24aba2d91a02690dc0b2b7da3072a94fcb91f19b202d0cec5b7f2c.css" />

<style>
	.tag_link {
		background: none repeat scroll 0 0 #959595;
	    color: #fff;
	    font-size: 15px;
	    font-weight: 600;
	    height: 50px;
    	text-align: center;
	    vertical-align: middle;
	    padding: 0px 20px;	
	}
	
	.tag_link:hover {
	  	background: none repeat scroll 0 0 #FF671B !important;
	}
</style>

<div class="content-row" >
  <div class="app-tile full-section" data-tile-id="tags" >
  <form name="tagForm" novalidate>
    <div class="tile-header">
      <span>tags</span>
      <div class="clear"></div>
    </div>
    <div class="tile-content tags-content">
      <div>
         <table ng-hide="isEditing['tags']" style="margin-bottom: 15px;">
         	<tr>
         		<td id="ig-label">Industry Group</td>
         		<td id="label-spacer"></td>
         		<td id="pt-label">Sector</td>
         	</tr>
         	<tr>
         		<td class="tag_link" id="ig"><a href="tag/resources-environment">{{profile.industry_group}}</a></td>
                
				<td id="tag-spacer" style="width: 20px;"></td>
                
         		<td class="tag_link"  id="pt"><a href="tag/resources-environment">{{profile.primary_tag}}</a></td>
         	</tr>
         </table>
         
		  <span ng-hide="isEditing['tags']">Tags</span>
	      <div class="taxonomy-lists" ng-hide="isEditing['tags']" style="padding-bottom:15px;">
    	    <ul>
        	  <li ng-repeat="tag in profile.company_tags">
	            <a ng-href="/tag/{{tag.slug}}" class="linkable">
    	          <span>{{tag.tag}} <span ng-show="tag.startup_count">({{tag.startup_count}})</span></span>
	            </a>
	          </li>
	        </ul>
	      </div>
	  </div>

      <div class="tags-edit">
        <div class="padding-bottom-20px" ng-show="isEditing['tags']">
        </div>
          
        <script type="text/javascript">

            $(document).ready(function() {

                if ( $('#ig').text() != '' ) {
                    $('#ig').show();
                    $('#ig-label').show();
                } else {      
                    $('#ig').hide();
                    $('#ig-label').hide();
                    $('#label-spacer').hide();
                    $('#tag-spacer').hide();
                } 

                if ( $('#pt').text() != '' ) {
                    $('#pt').show();
                    $('#pt-label').show();
                } else {      
                    $('#pt').hide();
                    $('#pt-label').hide();
                }

            });

        </script> 
        <div class="clear"></div>
      </div>

    </div>
    </form>
  </div>
</div>

  <div class="clear"></div>
  <div class="content-row" ng-show="profile.recommendations.length > 0">
  <div class="app-tile full-section" data-tile-id="recommended" >
    <div class="tile-header">
      <span>Similar companies (beta)</span>
      <div class="tile-header-icons">
      </div>
    </div>

    <div class="tile-content">
      <div id="company-recommendations" class="owl-carousel">
        <div class="" ng-repeat="rec in companyRecommendations" recommend-carousel>
          <div class="image-holder"><a ng-href="{{rec.url}}?refpro=profsimilar" class="recommended-company"><img class="recommend-image" ng-src="{{rec.logo_url}}" /></a></div>
          <!--p>
            <a ng-href="{{rec.url}}">{{rec.name}}</a><br/>
            <span>{{rec.primary_tag}}</span>
          </p-->
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="clear"></div>
    <div class="content-row" id="customer-full-tile" ng-show="profile.customers.length > 0 || isEditingMode">
    <div class="app-tile full-section" data-tile-id="customer" >
    <form name="customerForm" novalidate>
      <div class="tile-header">
        <span>Customers</span>
        <div class="tile-header-icons">
          <div ng-show="showLoading['customer'] || globalLoading" class="tile-icons icon-loading"><img src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" /></div>
          <div ng-show="showPencil['customer']" ng-click="edit('customer')" class="tile-icons icon-pencil"><img src="/assets/newdesign/EditIcon_Blue_22x22px_2x-5a2502cf0290b6f4f819b13253bded5900b49bed9d896087ade8fc0523a6eb97.png" /></div>
          <div ng-show="showSave['customer']" class="tile-icons icon-remove"><div class="save-tile" ng-click="save('customer', customerForm.$valid)">Save</div><img ng-click="cancelEdit(&#39;customer&#39;)" src="/assets/newdesign/CancelIcon_Blue_22x22px_2x-d9f05c4961489fe0900a5fe345d6916b0d6317fb4d02e6f0b1e15f4400479530.png" /></div>
        </div>
        <div class="clear"></div>
      </div>
      <div class="tile-content customer-content">
        <div class="tile-row-add" ng-hide="!isEditing['customer']"><a class="cursor-pointer edit-add" editcustomer>Add Customer</a></div>

        <table class="customers-table">
          <thead>
            <td class="first-td">Date</td>
            <td class="second-td"></td>
            <td class="third-td">Company</td>
            <td class="fourth-td"></td>
            <td class="fifth-td"></td>
          </thead>
          <tbody>
            <!-- edit row -->
            <tr class="edit-row" style="display:none;">
              <td class="vert-top">
                <input
                ng-model="customer.relationship_date"
                ng-class="{'has-error': customerForm.relationship_date.$invalid && submitted}"
                ng-pattern="/^[01]?[0-9]\/[0-3]?[0-9]\/[12][90][0-9][0-9]$/"
                type="text"
                class="edit-date"
                name="relationship_date"
                placeholder="Date" />
              </td>
              <td class="vert-top">
                <img class="company-img" ng-src="{{(customer.company1.id == profile.company.id ? customer.logo_url2 : customer.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png'}}" />
              </td>
              <td class="vert-top">
                <div class="edit-block">
                  <div>
                    <div class="add-block"><span>Can't find a company?</span> <a href="#" class="add-company-button">Add a company</a></div>
                    <input type="text" name="add_customer" class="add_customer_input" />
                  </div>
                  <p>
                    <div>
                      <span>Description </span>
                      <span class="float-right char-limiter" ng-class="{'error-message': customer.notes.length > 400}">{{400 - customer.notes.length}}/400
                        <span style="font-weight:normal;">characters left</span>
                      </span>
                    </div>
                    <textarea
                      ng-model="customer.notes"
                      type="text"
                      class="edit-width edit-notes"
                      name="notes"
                      maxlength="400"
                      ng-trim="false"
                      placeholder="Notes"></textarea>
                  </p>
                  <p>
                    <span>Related press release or article about this deal</span>
                    <input
                      ng-model="customer.source"
                      ng-class="{'has-error': customerForm.source.$invalid && submitted}"
                      class="edit-width edit-source"
                      type="url"
                      name="source"
                      placeholder="Source URL"
                      http-prefix />
                  </p>
                  <p>
                    <span>Confirm relationship* <span style="font-weight:normal;">(Enter the email address of your counterpart at this company so they can confirm your relationship!)</span></span>
                    <input
                      ng-model="customer.confirmation_email"
                      ng-class="{'has-error': customerForm.confirmation_email.$invalid && submitted}"
                      ng-pattern="/^(.(?!(@(gmail|hotmail|yahoo)\.)))*$/"
                      class="edit-width edit-email"
                      type="email"
                      name="confirmation_email"
                      placeholder="Confirmation Email" />
                  </p>
                  <div class="edit-buttons">
                    <a class="btn cancel-btn" cancelcustomer>Cancel</a>
                    <a class="btn save-btn" ng-click="save('customer', customerForm.$valid)">Save</a>
                  </div>
                </div>
              </td>
              <td></td>
              <td></td>
            </tr>
            <!-- end edit row -->
            <tr ng-repeat="customer in profile.customers" data-customer-id={{customer.id}}>
              <td class="vert-top">{{customer.relationship_date | date: 'MM/dd/yyyy'}}</td>
              <td>
                <a ng-hide="{{customer.company1.id == profile.company.id ? customer.company2.hidden : customer.company1.hidden}}"
                  ng-href="{{customer.company1.id == profile.company.id ? customer.company2.url : customer.company1.url}}"
                  target="_blank">
                  <div class="thumb-60 thumb">
                   <img ng-src="{{(customer.company1.id == profile.company.id ? customer.logo_url2 : customer.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png'}}" />
                  </div>
                </a>
                <div ng-show="{{customer.company1.id == profile.company.id ? customer.company2.hidden : customer.company1.hidden}}"
                  class="thumb-60 thumb">
                   <img ng-src="{{(customer.company1.id == profile.company.id ? customer.logo_url2 : customer.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png'}}" />
                </div>
              </td>
              <td>
                <p class="name">
                  <a
                    ng-hide="{{customer.company1.id == profile.company.id ? customer.company2.hidden : customer.company1.hidden}}"
                    ng-href="{{customer.company1.id == profile.company.id ? customer.company2.url : customer.company1.url}}"
                    target="_blank">{{customer.company1.id == profile.company.id? customer.company2.name : customer.company1.name}}</a>
                  <span ng-show="{{customer.company1.id == profile.company.id ? customer.company2.hidden : customer.company1.hidden}}">{{customer.company1.id == profile.company.id? customer.company2.name : customer.company1.name}}</span>
                </p>
                <p><span>{{customer.notes}}</span></p>
                <p>
                  <div ng-show="customer.company_relationship_confirmation.status=='confirmed'" class="cp-confirmed">Confirmed by {{customer.company1.id == profile.company.id? customer.company2.name : customer.company1.name}}</div>
                  <div ng-hide="customer.company_relationship_confirmation.status=='confirmed'" class="cp-not-confirmed"><!--Not confirmed by {{customer.company1.id == profile.company.id? customer.company2.name : customer.company1.name}} yet--></div>
                </p>
              </td>
              <td class="vert-top">
                <div ng-hide="isEditing['customer']"><a ng-show="customer.source" style="float:right;" ng-href="{{customer.source}}" target="_blank" rel="nofollow">Learn more</a></div>
              </td>
              <td ng-show="isEditing['customer']" class="edit-group">
                <div class="edit-icon-group">
                    <a id="customer_{{customer.id}}" editcustomer><img class="edit-icon" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-5a2502cf0290b6f4f819b13253bded5900b49bed9d896087ade8fc0523a6eb97.png" /></a>
                    <a onclick="$(this).parents('tr').addClass('customer-deleted').hide()" class="delete-text">Delete</a>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="clear"></div>
      </div>
    </form>
    <div class="sign-up-see-results">
<a href="#" class="signup-button">Sign up</a> to see the full results!
</div>
    </div>
  </div>

  <div class="clear"></div>
    <div class="content-row" id="partnership-full-tile" ng-show="profile.relationships.length > 0 || isEditingMode">
    <div class="app-tile full-section" data-tile-id="relationship" >
      <form name="relationshipForm" novalidate>
      <div class="tile-header">
        <span>Partnerships</span>
        <div class="tile-header-icons">
          <div ng-show="showLoading['relationship'] || globalLoading" class="tile-icons icon-loading"><img src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" /></div>
          <div ng-show="showPencil['relationship']" ng-click="edit('relationship')" class="tile-icons icon-pencil"><img src="/assets/newdesign/EditIcon_Blue_22x22px_2x-5a2502cf0290b6f4f819b13253bded5900b49bed9d896087ade8fc0523a6eb97.png" /></div>
          <div ng-show="showSave['relationship']" class="tile-icons icon-remove"><div class="save-tile" ng-click="save('relationship', relationshipForm.$valid)">Save</div><img ng-click="cancelEdit(&#39;relationship&#39;)" src="/assets/newdesign/CancelIcon_Blue_22x22px_2x-d9f05c4961489fe0900a5fe345d6916b0d6317fb4d02e6f0b1e15f4400479530.png" /></div>
        </div>
        <div class="clear"></div>
      </div>
      <div class="tile-content relationship-content" ng-click="relationshipEdit($event)">
        <div class="tile-row-add" ng-hide="!isEditing['relationship']"><a class="cursor-pointer edit-add" editrelationship>Add Partnership</a></div>

        <table class="relationships-table">
          <thead>
            <tr>
              <td class="first-td">Date</td>
              <td class="second-td"></td>
              <td class="third-td">Partner</td>
              <td class="fourth-td">Type</td>
              <td ng-show="isEditing['relationship']" class="fifth-td"></td>
            </tr>
          </thead>
          <tbody>
            <!-- edit row -->
            <tr class="edit-row" style="display:none;">
              <td class="vert-top">
                <input
                  ng-model="relationship.relationship_date"
                  ng-class="{'has-error': relationshipForm.relationship_date.$invalid && submitted}"
                  ng-pattern="/^[01]?[0-9]\/[0-3]?[0-9]\/[12][90][0-9][0-9]$/"
                  type="text"
                  class="edit-date"
                  name ="relationship_date"
                  placeholder="Date" />
              </td>
              <td class="vert-top">
                <div class="pictures">
                  <div ng-show="{{relationship.company1.id == profile.company.id ? relationship.company2.hidden : relationship.company1.hidden}}"
                    class="thumb-60 thumb">
                     <img ng-src="{{(relationship.company1.id == profile.company.id ? relationship.logo_url2 : relationship.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png'}}" />
                  </div>
                </div>
              </td>
              <td class="vert-top">
                <div class="edit-block">
                  <div class="edit-width">
                    <div class="add-block"><span>Can't find a partner?</span> <a href="#" class="add-company-button">Add one</a></div>
                    <input type="text" name="add_relationship" id="add_relationship_input" class="add_relationship_input"  />
                  </div>
                  <p>
                    <div>
                      <span>Description</span>
                      <span class="float-right char-limiter" ng-class="{'error-message': relationship.notes.length > 400}">{{400 - relationship.notes.length}}/400
                        <span style="font-weight:normal;">characters left</span>
                      </span>
                    </div>
                    <textarea
                      ng-model="relationship.notes"
                      class="edit-width edit-notes"
                      type="text"
                      name="notes"
                      maxlength="400"
                      ng-trim="false"
                      placeholder="Notes"></textarea>
                  </p>
                  <p>
                    <span>Related press release or article about this deal</span>
                    <input
                      ng-model="relationship.source"
                      ng-class="{'has-error': relationshipForm.source.$invalid && submitted}"
                      class="edit-width edit-source"
                      type="url"
                      name="source"
                      placeholder="Source URL"
                      http-prefix />
                  </p>
                  <p>
                    <span>Confirm relationship* <span style="font-weight:normal;">(Enter the email address of your counterpart at this company so they can confirm your relationship!)</span></span>
                    <input
                      ng-model="relationship.confirmation_email"
                      ng-class="{'has-error': relationshipForm.confirmation_email.$invalid && submitted}"
                      ng-pattern="/^(.(?!(@(gmail|hotmail|yahoo)\.)))*$/"
                      class="edit-width edit-email"
                      type="email"
                      name="confirmation_email"
                      placeholder="Confirmation Email" />
                  </p>
                  <div class="edit-buttons">
                    <a class="btn cancel-btn" cancelrelationship>Cancel</a>
                    <a class="btn save-btn" ng-click="save('relationship', relationshipForm.$valid)">Save</a>
                  </div>
                </div>
              </td>

              <td class="vert-top">
                <select
                  ng-model="relationship.relationship_type_id"
                  ng-class="{'has-error': relationshipForm.relationship_type_id.$invalid && submitted}"
                  ng-options="obj.id as obj.name for obj in profile.edit_options.partnership_relationship_types"
                  class="edit-relationship-type"
                  name="relationship_type_id" >
                </select>
              </td>
              <td></td>
            </tr>
            <!-- end edit row -->
            <tr ng-repeat="rel in profile.relationships" data-relationship-id="{{rel.id}}">
              <td class="vert-top">{{rel.relationship_date | date: 'MM/dd/yyyy'}}
              </td>
              <td class="vert-top">
                <div class="pictures">
                  <a ng-hide="{{rel.company1.id == profile.company.id ? rel.company2.hidden : rel.company1.hidden}}"
                    ng-href="{{rel.company1.id == profile.company.id ? rel.company2.url : rel.company1.url}}">
                    <div class="thumb-60 thumb">
                     <img ng-src="{{(rel.company1.id == profile.company.id ? rel.logo_url2 : rel.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png'}}" />
                    </div>
                  </a>
                  <div ng-show="{{rel.company1.id == profile.company.id ? rel.company2.hidden : rel.company1.hidden}}"
                    class="thumb-60 thumb">
                     <img ng-src="{{(rel.company1.id == profile.company.id ? rel.logo_url2 : rel.logo_url1) || '/assets/newdesign/Corporate_Icon_130x130Gray-c93817130f98a690f3dbe003c357d27be2513e2d7d6e878fd6bd79ff34a2cf2f.png'}}" />
                  </div>
                </div>
              </td>
              <td class="vert-top font14">
                <div class="company-content">
                  <a
                    class="ctg-orange"
                    target="_blank"
                    ng-href="{{rel.company1.id == profile.company.id ? rel.company2.url : rel.company1.url}}"
                    ng-hide="{{rel.company1.id == profile.company.id ? rel.company2.hidden : rel.company1.hidden}}">{{rel.company1.id == profile.company.id ? rel.company2.name : rel.company1.name}}
                  </a>
                  <span
                    ng-show="{{rel.company1.id == profile.company.id ? rel.company2.hidden : rel.company1.hidden}}" >{{rel.company1.id == profile.company.id ? rel.company2.name : rel.company1.name}}
                  </span>
                  <div class="notes weight300 font12">
                    <div ng-show="rel.notes" style="white-space:pre-line;">{{rel.notes | limitTo: 500}} {{rel.notes.length > 500 ? '...' : ''}}</div>
                    <span class="source">
                      <div>
                        <a ng-show={{URL_REGEXP.exec(rel.source)}} class="ctg-orange float-left" href="{{rel.source}}" target="_blank" rel="nofollow">View source&nbsp;&nbsp;&nbsp;&nbsp;</a>
                        <div ng-show="rel.company_relationship_confirmation.status=='confirmed'" class="cp-confirmed float-left">Confirmed by {{rel.company1.id == profile.company.id? rel.company2.name : rel.company1.name}}</div>
                        <div ng-hide="rel.company_relationship_confirmation.status=='confirmed'" class="cp-not-confirmed float-left"><!--Not confirmed by {{rel.company1.id == profile.company.id? rel.company2.name : rel.company1.name}} yet--></div>
                      </div>
                    </span>
                  </div>
                </div>
              </td>
              <td class="vert-top">{{rel.company1.id == profile.company.id ? rel.relationship_type.name : rel.relationship_type.reciprocal.name}}</td>
              <td ng-show="isEditing['relationship']" class="vert-top">
                <div class="edit-group">
                  <div class="edit-icon-group">
                      <a id="relationship_{{rel.id}}" editrelationship><img class="edit-icon" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-5a2502cf0290b6f4f819b13253bded5900b49bed9d896087ade8fc0523a6eb97.png" /></a>
                      <a onclick="$(this).parents('tr').addClass('relationship-deleted').hide()" class="delete-text">Delete</a>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </form>
    <div class="sign-up-see-results">
<a href="#" class="signup-button">Sign up</a> to see the full results!
</div>
  </div>
</div>

  <div class="clear"></div>
  <div class="content-row" id="financing-full-tile" ng-show="profile.investments.length > 0 || isEditingMode">
  <div class="app-tile full-section" data-tile-id="investment" >
  <form name="investmentForm" novalidate>
    <div class="tile-header">
      <span>Investment Rounds</span>
      <div class="tile-header-icons">
        <div ng-show="showLoading['investment'] || globalLoading" class="tile-icons icon-loading"><img src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" /></div>

			<!-- <div onclick="alert('Investments are not editable by Profile Owners. Please contact <a href=\"mailto:research@cleantech.com?Subject=Hello%20again\" target=\"_top\">research@cleantech.com</a> to make changes.');" class="tile-icons icon-pencil"><img src="/assets/newdesign/EditIcon_Blue_22x22px_2x-5a2502cf0290b6f4f819b13253bded5900b49bed9d896087ade8fc0523a6eb97.png" /></div> -->
			<div id="investment-no-edit-button" class="tile-icons icon-pencil"><img src="/assets/newdesign/EditIcon_Blue_22x22px_2x-5a2502cf0290b6f4f819b13253bded5900b49bed9d896087ade8fc0523a6eb97.png" /></div>
		
        <div ng-show="showSave['investment']" class="tile-icons icon-remove"><div class="save-tile" ng-click="save('investment', investmentForm.$valid)">Save</div><img ng-click="cancelEdit(&#39;investment&#39;)" src="/assets/newdesign/CancelIcon_Blue_22x22px_2x-d9f05c4961489fe0900a5fe345d6916b0d6317fb4d02e6f0b1e15f4400479530.png" /></div>
      </div>
      <div class="clear"></div>
    </div>

    <div class="tile-content investment-content">
      <div class="ipo-info" ng-show="ipoHistory">
        <p><h3>IPO INFORMATION</h3></p>
        <span class="cp-border"></span>
        <div>
          <table class="ipos-table">
            <tr>
              <td>
                <h3>Date</h3>
                <span ng-hide="isEditing['investment']">{{profile.ipo_history.as_of_date}}</span>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.as_of_date"
                  datepicker
                  ng-class="{'has-error': investmentForm.ipo_as_of_date.$invalid && submitted}"
                  ng-pattern="/^[01]?[0-9]\/[0-3]?[0-9]\/[12][90][0-9][0-9]$/"
                  type="text"
                  class=""
                  name ="ipo_as_of_date" />
              </td>
              <td>
                <h3>IPO status</h3>
                <span ng-hide="isEditing['investment']">{{profile.ipo_history.ipo_status.name}}</span>
                <select
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.ipo_status_id"
                  ng-options="obj.id as obj.name for obj in profile.edit_options.ipo_statuses"
                  name="ipo_status_name">
                </select>
              </td>
              <td>
                <h3>IPO Type</h3>
                <span ng-hide="isEditing['investment']">{{profile.ipo_history.ipo_type.name}}</span>
                <select
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.ipo_type_id"
                  ng-options="obj.id as obj.name for obj in profile.edit_options.ipo_types"
                  name="ipo_type_name">
                </select>
              </td>
              <td>
                <h3>Amount</h3>
                <span ng-hide="isEditing['investment']">{{profile.ipo_history.amount_formatted}}</span>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.amount"
                  ng-pattern="/^\d+$/"
                  type="text"
                  ng-class="{'has-error': investmentForm.ipo_amount.$invalid && submitted}"
                  name="ipo_amount" />
              </td>
            </tr>

            <tr>
              <td>
                <h3>Initial shares</h3>
                <span ng-hide="isEditing['investment']">{{profile.ipo_history.initial_share}}</span>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.initial_share"
                  ng-pattern="/^\d+$/"
                  type="text"
                  ng-class="{'has-error': investmentForm.ipo_initial_share.$invalid && submitted}"
                  name="ipo_initial_share" />
              </td>
              <td>
                <h3>Ticker symbol</h3>
                <span ng-hide="isEditing['investment']">{{profile.company.ticker_symbol}}</span>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.ticker_symbol"
                  type="text"
                  name="ipo_ticker_symbol" />
              </td>
              <td>
                <h3>Exchange listed</h3>
                <span ng-hide="isEditing['investment']">{{profile.ipo_history.exchange}}</span>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.exchange"
                  type="text"
                  name="ipo_exchange" />
              </td>
            </tr>

            <tr>
              <td>
                <h3 ng-show="isEditing['investment']">Prospectus URL</h3>
                <a ng-hide="isEditing['investment']" href="{{profile.ipo_history.prospectus}}" class="de-emph">Prospectus</a>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.prospectus"
                  type="url"
                  ng-class="{'has-error': investmentForm.ipo_prospectus.$invalid && submitted}"
                  name="ipo_prospectus"
                  http-prefix />
              </td>
              <td>
                <h3 ng-show="isEditing['investment']">Source URL</h3>
                <a ng-hide="isEditing['investment']" href="{{profile.ipo_history.source}}" target="_blank" rel="nofollow">Source</a>
                <input
                  ng-show="isEditing['investment']"
                  ng-model="ipoHistory.source"
                  type="url"
                  ng-class="{'has-error': investmentForm.ipo_source.$invalid && submitted}"
                  name="ipo_source"
                  http-prefix />
              </td>
              <td>
              </td>
            </tr>
          </table>
          <div class="ipo-notes">
            <h3>Description</h3>
            <p ng-hide="isEditing['investment']">{{profile.ipo_history.notes}}</p>
            <textarea
              ng-show="isEditing['investment']"
              ng-model="ipoHistory.notes"
              type="text"
              class="notes_textarea"
              ng-class="{'has-error': investmentForm.ipo_notes.$invalid && submitted}"
              name="ipo_notes"></textarea>
            <div class="edit-buttons" ng-show="isEditing['investment']">
              <a class="btn cancel-btn" ng-click="cancelEdit('ipo_history')">Cancel</a>
              <a class="btn save-btn" ng-click="save('investment', investmentForm.$valid)">Save</a>
            </div>
          </div>
        </div>
        <div class="clear"></div>
      </div>

      <div class="tile-row-add" ng-hide="!isEditing['investment']"><a class="cursor-pointer edit-add" editinvestment>Add Investment</a></div>

      <table class="investments-table">
        <thead>
          <td class="first-td">Date</td>
          <td class="third-td">Investors</td>
          <td class="fourth-td">Type</td>
          <td class="fifth-td">Amount</td>
          <td class="sixth-td"></td>
        </thead>
        <tbody>
          <!-- edit row -->
          <tr class="edit-row" style="display:none;">
            <td class="vert-top">
              <input
              ng-model="investment.investment_date"
              ng-class="{'has-error': investmentForm.investment_date.$invalid && submitted}"
              ng-pattern="/^[01]?[0-9]\/[0-3]?[0-9]\/[12][90][0-9][0-9]$/"
              type="text"
              class="edit-date"
              name="investment_date"
              placeholder="Date" />
            </td>
            <td class="vert-top">
              <div class="edit-block">
                <div>
                  <div class="add-block"><span>Can't find an investor?</span> <a href="#" class="add-investor-button">Add an investor</a></div>
						<input type="text" name="add_investment_input" class="add_investment_input" /> 
				  </div>
                <p>
                  <span>Valuation</span>
                  <input
                    ng-model="investment.valuation"
                    ng-pattern="/^\d+$/"
                    ng-class="{'has-error': investmentForm.valuation.$invalid && submitted}"
                    class="edit-width edit-valuation"
                    type="text"
                    name="valuation"
                    placeholder="Valuation" />
                </p>

                <p>
                  <span>Description</span>
                  <span class="float-right char-limiter" ng-class="{'error-message': investment.notes.length > 400}">{{400 - investment.notes.length}}/400
                    <span style="font-weight:normal;">characters left</span>
                  </span>
                  <textarea ng-model="investment.notes"
                    class="edit-width edit-notes"
                    type="text"
                    name="notes"
                    maxlength="400"
                    ng-trim="false"
                    ng-class="{'has-error': investment.notes.$invalid && submitted}"
                    placeholder="Notes"></textarea>
                </p>
                <p>
                  <span>Related press release or article about this deal</span>
                  <input
                    ng-model="investment.source"
                    ng-class="{'has-error': investmentForm.source.$invalid && submitted}"
                    class="edit-width edit-source"
                    type="url"
                    name="source"
                    placeholder="Source URL"
                    http-prefix />
                </p>
                <div class="edit-buttons">
                  <a class="btn cancel-btn" cancelinvestment>Cancel</a>
                  <a class="btn save-btn" ng-click="save('investment', investmentForm.$valid)">Save</a>
                </div>
              </div>
            </td>
            <td class="vert-top edit-investment-type-td">
              <select
                ng-model="investment.investment_type_id"
                ng-class="{'has-error': investmentForm.investment_type_id.$invalid && submitted}"
                ng-options="obj.id as obj.name for obj in profile.edit_options.investment_types"
                class="edit-investment-type"
                name="investment_type_id" >
              </select>
                
        <!--new -->
        <!--end new -->       
                
            </td>
              
 
              
            <td class="vert-top edit-valuation-td">
               <input
                    ng-model="investment.amount"
                    ng-pattern="/^\d+$/"
                    ng-class="{'has-error': investmentForm.amount.$invalid && submitted}"
                    class="edit-width-small edit-amount"
                    type="text"
                    name="amount"
                    placeholder="Amount" />
              
                
        <!--new --> 
        <!--end new --> 
                
                
              </td>
            <td></td>
          </tr>
          <!-- end edit row -->
          <tr ng-repeat="investment in profile.investments" class="investment-item" data-investment-id={{investment.id}} >
            <td class="vert-top">{{investment.investment_date | date: 'MM/dd/yyyy'}}
            
            </td>
            <td class="vert-top font14 weight600">
              <span ng-repeat="investor in investment.investors">
                <a target="_blank" class="ctg-orange" href="{{investor.url}}" ng-hide="{{investor.hidden}}">{{investor.name}}</a>
                <span ng-show="{{investor.hidden}}" >{{investor.name}}</span>
                {{$last ? '': ', '}}
              </span>
              <span ng-show="investment.investors.length > 0" class="weight300 font13"> ({{investment.investors.length}})</span>

              <div class="notes weight300 font13">
                <div ng-show="investment.valuation">Post-money valuation of {{investment.valuation | numShort}}</div>
                <div ng-show="investment.notes">{{investment.notes}}</div>
                <span class="source">
                  <div ng-show={{URL_REGEXP.exec(investment.source)}}>(<a class="ctg-orange" href="{{investment.source}}" target="_blank">source</a>)</div>
                </span>
              </div>
            </td>
            <td class="vert-top">{{investment.investment_type.name}}</td>
            <td class="vert-top" >{{investment.amount | nfcurrency}}</td>
            
            <td ng-show="isEditing['investment']" class="edit-group">
              <div class="edit-icon-group">
                  <a id="investment_{{investment.id}}" editinvestment><img class="edit-icon" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-5a2502cf0290b6f4f819b13253bded5900b49bed9d896087ade8fc0523a6eb97.png" /></a>
                  <a onclick="$(this).parents('tr').addClass('investment-deleted').hide()" class="delete-text">Delete</a>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
      <div class="add-ipo" ng-show="isEditing['investment']&&(ipoHistory==undefined||ipoHistory.id==null)"><a ng-click="addIpo()">Click</a> to add IPO information</div>
    </div>
    </form>
    <div class="sign-up-see-results">
<a href="#" class="signup-button">Sign up</a> to see the full results!
</div>
  </div>
</div>

  <div class="clear"></div>
  <div class="content-row" id="product-full-tile" ng-show="profile.products.length > 0 || isEditingMode">
  <div class="app-tile full-section" data-tile-id="product" >
    <form name="productForm" novalidate>
    <div class="tile-header">
      <span>Products</span>
      <div class="tile-header-icons">
        <div ng-show="showLoading['product'] || globalLoading" class="tile-icons icon-loading"><img src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" /></div>
        <div ng-show="showPencil['product']" ng-click="edit('product')" class="tile-icons icon-pencil"><img src="/assets/newdesign/EditIcon_Blue_22x22px_2x-5a2502cf0290b6f4f819b13253bded5900b49bed9d896087ade8fc0523a6eb97.png" /></div>
        <div ng-show="showSave['product']" class="tile-icons icon-remove"><div class="save-tile" ng-click="saveProduct('product', productForm.$valid)">Save</div><img ng-click="cancelEdit(&#39;product&#39;)" src="/assets/newdesign/CancelIcon_Blue_22x22px_2x-d9f05c4961489fe0900a5fe345d6916b0d6317fb4d02e6f0b1e15f4400479530.png" /></div>
      </div>
      <div class="clear"></div>
    </div>
    <div class="tile-content product-content">
      <div class="tile-row-add" ng-hide="!isEditing['product']"><a class="cursor-pointer edit-add" editproduct>Add Product</a></div>

      <table class="products-table">
        <thead>
          <td class="first-td">Product image</td>
          <td class="second-td">Name</td>
          <td class="third-td">Product status</td>
          <td class="fourth-td">Revenue model</td>
          <td class="fifth-td" ng-show="tagPresent('energy storage')">Cost metrics</td>
          <td></td>
        </thead>
        <tbody>
          <!-- edit row -->
          <tr class="edit-row" style="display:none;">
            <td class="vert-top">
              <div class="upload-image-holder">
                <div class="upload-cv-button">
                  <!--span class="upload-image-icon"></span-->
                  <img id="product_image_preview" src="/assets/newdesign/Product_Icon_130x130_gray-69dd87c3c4b3e6feaa1a054958ec5ab6e79b1f7980348e64af4b99a8ba2c06cd.png" />
                  <input
                    onchange="angular.element(this).scope().productPictureChanged(this)"
                    file-input="files"
                    class="product-picture"
                    name="product_image"
                    type="file"
                    multiple
                    accept="image/*" />
                </div>
                <a href="javascript:void(0);" class="select-image-button">Select Image</a>
              </div>
            </td>
            <td class="vert-top">
              <div class="edit-block">
                <input
                  ng-model="product.name"
                  ng-class="{'has-error': productForm.name.$invalid && submitted}"
                  class="edit-width edit-name"
                  type="text"
                  name="name"
                  placeholder="Name" />
                <p>
                  <div>
                    <span>Description</span>
                    <span class="float-right char-limiter" ng-class="{'error-message': product.description.length > 400}">{{400 - product.description.length}}/400
                      <span style="font-weight:normal;">characters left</span>
                    </span>
                  </div>
                  <textarea
                    ng-model="product.description"
                    type="text"
                    class="edit-width edit-description"
                    name="Description"
                    maxlength="400"
                    ng-trim="false"
                    placeholder="Brief description of the product"></textarea>
                </p>

                <div class="edit-buttons">
                  <a class="btn cancel-btn" cancelproduct>Cancel</a>
                  <a class="btn save-btn" ng-click="saveProduct('product', productForm.$valid)">Save</a>
                </div>
              </div>
            </td>
            <td>
              <select
                class="product-status edit-status"
                ng-model="product.product_status_id"
                ng-options="obj.id as obj.name for obj in profile.edit_options.product_statuses"
                name="product_status_id">
                <option value=""></option>
              </select>
            </td>
            <td class="product-revenue-td">
              <select
                class="product-revenue edit-revenue"
                ng-model="product.revenue_id"
                ng-options="obj.id as obj.name for obj in profile.edit_options.revenues"
                name="revenue_id">
                <option value=""></option>
              </select>
            </td>
            <td ng-show="tagPresent('energy storage')">
              <span>US$/kW (current)</span>
              <input
                type="number"
                class="edit-cost edit-usd_per_kw_current"
                ng-model="product.usd_per_kw_current" /><br/>
              <span>US$/kWh (current)</span>
              <input
                type="number"
                class="edit-cost edit-usd_per_kwh_current"
                ng-model="product.usd_per_kwh_current" /><br/>
              <span>US$/kW (projected)</span>
              <input
                type="number"
                class="edit-cost edit-usd_per_kw_prospected"
                ng-model="product.usd_per_kw_prospected" /><br/>
              <span>US$/kWh (projected)</span>
              <input
                type="number"
                class="edit-cost edit-usd_per_kwh_prospected"
                ng-model="product.usd_per_kwh_prospected" />
              <div class="clear"></div>
            </td>
          </tr>
          <!-- end edit row -->
          <tr ng-repeat="product in profile.products" data-product-id={{product.id}}>
            <td class="vert-top">
              <div class="pictures">
                <div class="thumb-60 thumb">
                  <img ng-src="{{product.product_image_url || '/assets/newdesign/Product_Icon_130x130_gray-69dd87c3c4b3e6feaa1a054958ec5ab6e79b1f7980348e64af4b99a8ba2c06cd.png'}}" />
                </div>
              </div>
            </td>
            <td class="vert-top">
              <p class="name"><a>{{product.name}}</a></p>
              <p>{{product.description}}</p>
            </td>
            <td>
              <span>{{product.product_status_name}}</span>
            </td>
            <td class="vert-top">
              <span>{{product.revenue_name}}</span>
            </td>
            <td ng-show="tagPresent('energy storage')">
              <div>
                <div ng-show="product.usd_per_kw_current || product.usd_per_kwh_current || product.usd_per_kw_prospected || product.usd_per_kwh_prospected">
                  <span ng-show="product.usd_per_kw_current"     class="data-content-overview"> ${{product.usd_per_kw_current}}/kW      (current)  </span><br/>
                  <span ng-show="product.usd_per_kw_prospected"  class="data-content-overview"> ${{product.usd_per_kw_prospected}}/kW   (projected)</span><br/>
                  <span ng-show="product.usd_per_kwh_current"    class="data-content-overview"> ${{product.usd_per_kwh_current}}/kWh    (current)  </span><br/>
                  <span ng-show="product.usd_per_kwh_prospected" class="data-content-overview"> ${{product.usd_per_kwh_prospected}}/kWh (projected)</span>
                </div>
              </div>
            </td>
            <td class="vert-top edit-group">
              <div ng-show="isEditing['product']" class="edit-icon-group">
                <a id="product_{{product.id}}" editproduct><img class="edit-icon" src="/assets/newdesign/EditIcon_Blue_22x22px_2x-5a2502cf0290b6f4f819b13253bded5900b49bed9d896087ade8fc0523a6eb97.png" /></a>
                <a onclick="$(this).parents('tr').addClass('product-deleted').hide()" class="delete-text">Delete</a>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    </form>

    <div class="sign-up-see-results">
<a href="#" class="signup-button">Sign up</a> to see the full results!
</div>
  </div>
</div>

  <div class="clear"></div>
  <div class="demo-div">
  <span class="demo-span">You are viewing a limited version of this profile.  To access i3's full capabilities.</span> <a href="#" class="signup-button">Sign up</a>
</div>

  <div class="clear"></div>
  <a id="back-to-top-btn" href="#">Back to top</a>
</div>

<!--
user_type                           
:owns_profile,                      false
:get_in_touch,                      false
:view_full_traction,                false
:view_profile,                      false
:view_product_and_deck,             false
:view_acquired_company_message,     false
:view_seeking_funding_msg,          false
:view_product_without_deck,         false
:view_notes,                        false
:view_academic_team_snapshot,       false
:view_team,                         false
-->


    </div> <!-- end .container -->
  </div> <!-- end #content -->

  <div class="clear"></div>
    <!-- Footer -->
  <div id="footer-wrapper">
    <footer id="footer" class="section">
      <ul id="footer-menu">
          <li><a id="contact_us_link" href="#">Contact Us</a> </li>
      </ul>
      <a target="_blank" class="tw-follow" href="https://twitter.com/i3Connect">Follow i3</a>

      <div class="clear-desktop"></div>
      <a target="_blank" id="cleantech-logo" rel="nofollow" href="http://www.cleantech.com"></a>

      <ul id="tos-menu">

        <li>&copy; 2021 Cleantech Group</li>
        <li><a href="/sitemap.html">Site Map</a></li>
        <li><a target="_blank" rel="nofollow" href="http://www.cleantech.com/terms-of-use/">Terms Of Use</a></li>
        <li><a target="_blank" rel="nofollow" href="http://www.cleantech.com/privacy-policy/">Privacy Policy</a></li>
      </ul>
      <div class='clear'></div>
    </footer>
  </div><!-- END Footer -->


<p style="font-weight: 100; visibility: hidden;height: 0px;font-size: 0px;">Preload svg text font</p>
<div class="popup-window" id="contact-us-modal" style="position: fixed; top: 60px">
  <a href="#" class="close-btn close">Close</a>
  <form name="contactUsForm" novalidate>
  <div class="popup-window-content" ng-controller="contactUsController">
    <h1>Contact Us</h1>

    <div ng-init="contact_us.first_name = ''"></div>
    <div ng-init="contact_us.last_name  = ''"></div>
    <div ng-init="contact_us.email      = ''"></div>
    <div ng-init="contact_us.title      = ''"></div>
    <div ng-init="contact_us.company    = ''"></div>

    <p><label for="first_name" class="contact-us-input-label">First Name:</label><input name="first_name" class="contact-us-input" type="text"  id="contact_us_first_name" ng-model="contact_us.first_name" required></p>
    <p><label for="last_name"  class="contact-us-input-label">Last Name: </label><input name="last_name"  class="contact-us-input" type="text"  id="contact_us_last_name"  ng-model="contact_us.last_name"  required></p>
    <p><label for="email"      class="contact-us-input-label">Email:     </label><input name="email"      class="contact-us-input" type="email" id="contact_us_email"      ng-model="contact_us.email"      required></p>
    <p><label for="title"      class="contact-us-input-label">Title:     </label><input name="title"      class="contact-us-input" type="text"  id="contact_us_title"      ng-model="contact_us.title"      required></p>
    <p><label for="company"    class="contact-us-input-label">Company:   </label><input name="company"    class="contact-us-input" type="text"  id="contact_us_company"    ng-model="contact_us.company"    required></p>

    <p>
      Your message:<br>
       <textarea
        style="padding-left: 10px;width:97%;"
        name="body"
        ng-model="contact_us.body"
        id="contact_us_comment"
        placeholder=""
        required
        class="width-100-percent height-180px modal-text contact-us-modal-text"></textarea>
    </p>

    <div class="contact-us-popup-window-actions popup-window-actions">
      <a href="#" ng-click="contact_us.first_name && contact_us.last_name && contact_us.email && contact_us.title && contact_us.body && contact_us.company && sendContactUs(true)" ng-disabled="!contact_us.first_name">
        <span ng-hide="isModalSaving['sendContactUs']" >Send</span>
        <img ng-show="isModalSaving['sendContactUs']" src="/assets/45-b84750cc5a395288fcfd0cf42e3a60d6135e2f14db83fce05e97e5abacc2f9b4.gif" class="contact-us-loading23 loading23" />
      </a>
      <a href="#" class="close">Close</a>
    </div>

  </div>
  </form>
</div>

<script type="text/javascript">
  $(function() {
    $("#contact_us_link").on('click', function(event) {
      openPopup("#contact-us-modal");
    });
  });
</script>

<script>
  angular.bootstrap($('#contact-us-modal'), ['contactUsApp']);
</script>


</div>

  <div id="overlay"></div>
  <script src="/assets/site_search_includes-3cf8ca2d0bbc19f69e3f15d84e9a3a08eb17506fb706b17d77381f1aed70845b.js"></script>

</body>
</html>
